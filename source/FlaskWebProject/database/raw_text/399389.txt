Reinforcement learning iii gaines, 
D, )vld S. 1, (", Ilc 
DISSERTATION SUBMITTED TO THE UNIVERSITY OF BRISTOL IN 
ACCORDANCE WITH 1J. 1-, QUIREMENTS OF THE DECREE 
()I" Dou'roli ()I., IN TIIE F, ACULTY OF SCIENCE 
Febrimi-Y 200-4 
Sclmol of Milt 
henlat I'Cs 
NUMBERING 
AS ORIGINAL 
Abstract 
This thesis investigates the properties of learning in games, where the information 
available to each player does not include a specification of the game or observations 
of opponent play. Each player responds only to the rewards they received for 
playing particular actions on previous plays of the game. 
We relate two modifications of 136rgers and Sarin's stimulus-response learning 
(B6rgcrs and Sarin 1997) to the replicator dynamics. In these algorithms, observed 
rewards are used to directly modify the strategies of the players. 
Then an example of actor-critic learning, in which a value function is used to adapt 
the strategies, is studied using two-timescaics stochastic approximation to show 
that the strategies track the smooth best response dynamics. An extension, in 
which players learn at different rates, is analysed using a newly-developed theory 
of multi ple-timescales stochastic approximation (Leslie and Collins 2003). 
Q-1carning in games, where the strategies are simply functions of value estimates, is 
then studied using similar methods, employing smooth best responses and player- 
dependent learning rates. 
A modified actor-critic algorithm is introduced, in which strategies adapt towards 
a best response (instead of a smooth best response). This is analysed, by gcner- 
alising some results on fictitious play, and shown to converge in several classes of 
games. 
Initial investigations into extending these algorithms to stochastic games study 
the contraction properties of classes of smooth best responses. 
Acknowledgement s 
This thesis is dedicated to my parents, who taught me how to think. 
Many thanks are due to my principal adviser, Scan Collins, for his hard work, 
assistance, and general support throughout my studies, and to Andy Wright, for 
identical reasons. Thanks also to the entire Department of Mathematics at the 
University of Bristol, for providing an inspiring and supportive place to study. 
My research has been supported by CASE Research Studentship 00317214 from 
the UK Engineering and Physical Sciences Research Council in cooperation with 
BAE SYSTEMS. 
Declaration 
I, the author, declare that the work in this dissertation was carried 
out in accordance with the Regulations of the University of Bristol. 
The work is original except where indicated by special reference in 
the text and no part of the dissertation has been submitted for any 
other degree. 
The views expressed in the dissertation are those of the author and 
in no way represent those of the University of Bristol. 
The dissertation has not been presented to any other University 
for examination either in the United Kingdom or overseas. 
bavid S. Leslie 
Is I of, 
Contents 
Abstract i 
Acknowledgements iii 
Declaration v 
Contents vii 
List of Figures xi 
I Introduction and literature review 1 
1.1.3 Fictitious Play 
1.1.4 Consistent learning 
1.2 Reinforcement learning 
2A model for simple learning 42 
2.1 Stimulus-rcsponse learning 
2.2 Replicator dynamics 
3 Smooth actor-critic algorithins 56 
3.1 Introduction 
3.6 Conclusion 
4 Multiple thilescales 73 
4.6 Conclusion 
Q-1earning in normal form games 92 
5.1 Individual Q-1carning 
5.3 Multipic-timescales Q-learning 
5.5 Conclusions 
6 Weakened fictitious pbay and an actor-critic algorithm 106 
6.1 Discussion 
7 Smooth best responses in stochastic games 122 
7.3 Conclusion 
8 Dirther work 129 
8.2 Q-1carning 
8.3 MultipIc-timescales learning 
Bibliography 133 
List of Figures 
2.1 Final positions of the simple learning model in 2-player matching 
2.2 Learning trajectory of the simple learning model in 2-player match- 
2.3 Learning trajectory of the normalised learning model in 2-player 
3.1 Cycling of strategies in rock-scissors-paper for the single-timescale 
3.2 Convergence of strategies in rock-scissors-paper for the two- 
4.1 Non-convergence of singlc-timescale actor-critic learning in the 3- 
4.2 Convergence of multiple-timescales actor-critic learning in the 3- 
5.1 Non-convergencc of individual Q-1carning, and convergence of 
6.1 Learning trajectory of the discontinuous actor-critic algorithm in 
Chapter I 
Introduction and literature review 
Our areas of study are games and Markov decision process. These fields were 
initiated by Von Neumann, Morgenstern, Nash, Bellman, Shapley and others in 
the 1940s and 50s, and have been studied extensively since. The basic premises 
of these areas are that a player chooses actions and gains rewards in return, with 
each player attempting to maximise their own reward. 
1.1 Normal form games 
Game theory arose from the study of conflict, where a player's rewards depend not 
only on their own actions but also on the actions of others. The initial inspira- 
tion was the Cold War, but applications arc to be found in economics, evolution, 
machine learning and many other areas. The formal definition of a normal form 
game is: 
9A finite set of players N), 
*A finite set of actions Ai for each player i=1,..., N, resulting in a finite 
set of joint actions A A' x ... x AN, 
9A reward function r' A -+ R for each player i N, where r'(a) is 
the reward given to player i if joint action a EA is played. 
Chapter 1. Introduction and literature review 
This is a modern formulation of the framework first proposed by Von Neumann 
and Morgenstern (1953), which in turn brings together previous work, largely by 
Von Neumann. 
There are several special classes of games, for which the theory is more developed 
in some areas. Two of these are detailed here. 
Zero (or constant) sum games: Ei r( a) =0 (or more generally a constant) 
for any aEA. These games can be considered as entirely competitive, since 
one player's gain is another's loss. 
Partnership games: ri(a) = rj( a) for all iJ and joint actions aEA. This is 
the opposite end of the spectrum to zero sum games, since all players get 
identical rewards, and so face a joint maximisation problem. 
Occasionally we will use the term "n xm game" for a game where player 1 (resp. 
2) has n (rcsp. m) actions. 
1.1.1 Classical gaine theory 
A player adopts a strategy to play the game, which is a rule telling them which 
action to pick. Nash (1950) defines a (Nash) equilibrium of a game to be a strategy 
for each player such that no player can increase their reward by unilaterally devi- 
ating from their strategy. If we restrict these strategies to choosing single actions 
then not all games will admit such an equilibrium. 
Let Ai denote the set of probability distributions over the action space A' of 
player i. A mixed strategy for player i is an element 7r' E A'; henceforth we will 
call a strategy that chooses a single action with probability 1a pure strategy. 
Defining A= A' x ... X AN, we say that a joint strategy is an element 7r = 
7rN) E A. Note that it is implicitly assumed that players implement their 
strategies independently. There arc unique multilinear extensions of the reward 
functions to this mixed strategy space, and in standard abuse of notation we will 
I. I. Normal form games 
denote by ri(7r) the expected reward to player i when the players use joint mixed 
strategy 7r. Similarly we define r'(a', r-') to be the expected reward to player 
i when they play action a' and all players other than i play according to the 
opponent strategy 7r- 
i= (71, 
..., 7r'-', 7r'+', ..., 7rJV). 
Given an opponent strategy7r-i, player i has a set of best responses 
BR'(7r-') = jb' E A' : r'(b, 7r-) = max r'(7r', 7r-')}; , feAi 
BR'(7r-') is the set of mixed strategies which maximisc player i's expected reward, 
given that opponents play strategy ir-i. The best response correspondence is 
defined as 
BR(7r) = f(b',..., bN) EA: b' E BW(7r-') for each i}, 
where 7r- 
are the opponent strategies arising from joint strategy 7r. 
A Nash equilibrium Fr EA is therefore a fixed point of the best response corre- 
spondence BR: 
fr E BR(fr). 
Theorem 1 (Nash 1950) Every game has at least one equilibrium. 
Since Fr' E BR'(fr-i) for all i at a Nash equilibrium *, we see that 
for all ir' E A', 
and so at a Nash equilibrium, no player can improve their expected reward by 
a unilateral deviation away from fr'. If, for each i, the inequality (1.4) is strict 
for all 7r' 96 ft', * is called a strict Nash equilibrium. Note that in this case, 
7ri must be a pure strategy for each i; supposing fr is a mixed strategy Nash 
equilibrium, with fr'(a) >0 and fr'(b) >0 for a, bE A', then we must have 
r'(a, fr-') = r'(b, Fri) or (1.4) would not hold, and so constructing the strategy 
7ri by taking 7ri(a) = fri(a) + fr(b), 7ri(b) = 0, and 7r'(a') = *'(a') otherwise gives 
ri(7ri, fr-') = r'(Fr), so fr is not a strict Nash equilibrium. 
ChaPter 1. Introduction and literature review 
For two player zero sum games there is a particular solution concept, known 
as the maximin solution. Here players play to maximise the minimum possible 
reward they might get. 
Theorem 2 (Von Neumann 1928) For a 2-player zero-sum game let 
El a' E A' : min r'(a', a') = max min rl(b', a') 
a2EA2 b1EA1 a2EA2 
and similarly for E2. If player i plays a (possibly mixed) strategy consisting only 
of actions in Ei, then an equilibrium will result. 
However in general games, where players are not in direct competition, it does not 
make sense for a player to take this conservative approach of maximising the worst 
possible reward they might receive, since it may be the case that the other players 
will not gain by minimising the reward available to the player. 
Another concept of classical game theory is that of dominance (Nash 1951): we 
say a pure strategy a' is strictly dominated by pure strategy b' if r'(a', 7r-i) < 
ri(b', 7r-i) for all opponent mixed strategies 7r-'. A rational player will clearly 
never play a strictly dominated strategy, no matter what the other players are 
doing. It therefore makes sense to consider the game with a dominated strategy 
removed. In this new game there may well be further strategies that are strictly 
dominated which can now be removed. This process of iterative elimination of 
strictly dominated strategies does not alter the Nash equilibria of the game-no 
Nash equilibrium will contain a strategy that can be eliminated by iterative strict 
dominance. 
Although this classical theory shows that at least one equilibrium must exist in 
all games, and may help to calculate these equilibria, there are many philosophical 
problems remaining: 
e We have observed that all actions played with positive probability at a Nash 
equilibrium will receive the same expected reward. There is therefore no 
immediate incentive for any particular player to play the Nash equilibrium 
strategy instead of a different strategy using the same set of actions. 
Normal form games 
* Most games have more than one equilibria. Therefore players must coordi- 
nate to play a particular equilibrium. 
In applications of game theory in economics and biology, it is often observed 
that Nash equilibrium strategies arc played, even though the 'players' do not 
know that they are playing a game, let alone know the reward functions and 
calculate the Nash equilibrium. 
While the first two points have been addressed, at least in theory, by the work of 
Harsanyi and Selten (Harsanyi 1973; Harsanyi and Selten 1988) the last remains 
an open problem, being considered at length in recent textbooks on learning the- 
ory (Fudenberg and Levine 1998) and evolutionary game theory (11ofbauer and 
Sigmund 1998). 
1.1.2 Smooth best responses and Nas i istri utions 
Harsanyi (1973) showed that approximately correct equilibrium strategies arise 
naturally if players are unsure about the payoff functions defining the game. For 
this thesis, we note from Ilofbauer and Sandholm (2002) that, under a simplifying 
assumption, this is equivalent to players choosing a smooth best response 
argmax 
Ir'(7r', 7r-) + Tv'(7r') 
W4 EW 
to opponent strategies 7r-i, where r>0 is a temperature parameter and vi : 
A' -+ R is player i's smoothing function, which is a smooth, strictly 
differcntiably 
concave function such that as 7ri approaches the boundary of A' the slope of vi 
becomes infinite (Fudenberg and Levine 1998, Chapter 4). The conditions on vi 
imply that #'is a well-defined, continuous function (in contrast with Ble defined in 
(1.1) which is a discontinuous, possibly multiplc-valued correspondence). Further, 
since the slope of v' becomes infinite as 7r' approaches the boundary of A, the 
strategy fl'(7r-i) is a completely mixed strategy, i. e. 3'(7r-i)(a') >0 for each ai. 
Chapter 1. Introduction and literature review 
If players choose smooth best responses (1.5) instead of best responses (1.1), 
equilibrium play will deviate from Nash equilibrium. An easy illustration of this 
is if a game has only pure strategy equilibria: since all actions are played with 
positive probability under a smooth best response, no player will ever play a Nash 
equilibrium strategy. Instead we define a Nash distribution in an analogous way 
to Nash equilibria, but using smooth best responses instead of best responses. 
Writing P= (P',. a Nash distribution Fr satisfies 
Fr = 000. 
It is clear, from the Brouwer fixed point theorem, that at least one Nash distri- 
bution exists for any game. However, the Nash distributions of a game are not 
properties only of the game, but also of the smooth best response functions 0' 
(which depend on the choices of r and v'). 
Although Ilarsany? s original purification theorem does not quite apply in the 
situation we describe here (it relies on the fact that each player's prior distribu- 
tions over the rewards has finite support) Govindan et al. (2003) show that for 
sufficiently small temperatures r there is a Nash distribution close to any Nash 
equilibrium. 
1.1.3 Fictitious Play 
The first attempt to explain how Nash equilibrium might be achieved other than 
by an introspective study of the game was by Brown (1951). Although origi- 
nally proposed as a computational method to calculate the equilibrium of a game, 
Brown's process can also be considered as a learning procedure (Fudenberg and 
Levine 1998). This process, known as fictitious play, assumes that a game is played 
repeatedly. Each player stores the frequency with which opponents have played 
each of their actions in the past. When the game is played, each player plays a 
best response to these empirical frequency vectors. 
Let the game be played at time steps n=1,2, .. 
Just before the nth game is 
1.1. Normal form games 
played, the empirical frequency vector of player i's past play is given by ai, (with ao' 
Player i then chooses an action 
bin E BW(an-'). Writing bn = (bl,... g) we see n 
O'n+l `-- 1-Ia, +1b,, where bn E BR(an)- 
n+1)n+1 
At each time step n, the players will (generically) choose a pure strategy best 
response, and the strategies used by tile players cannot converge to a mixed equi- 
librium. However the vector of empirical frequencies a,, can converge to such an 
equilibrium. Indeed we have the following: 
Theorem 3 (Ridenberg and Kreps 1993) Suppose that in a fictitious play 
process the empirical frequencies a. converge to a point aEA as n -+ oo. Then 
a is a Nash equilibrium. 
We say a game has the fictitious play property if the empirical frequencies a,, 
of any fictitious play process in that game will converge to a Nash equilibrium for 
any initial conditions ao. 
Theorem 4 Games in the following classes have the fictitious play property: 
1.2-player zero-sum games (Robinson 1951), 
2. N-player partnership games (Afonderer and Shapley 1996), 
3. games solvable by iterated strict dominance (Afilgrom and Roberts 1991), and 
non-degenerate 2xm games (Berger 2003). 
However not all games have the fictitious play property: Shapley (1964) con- 
structed an example of a 2-player game for which the empirical frequencies of a 
fictitious play process need not converge. Further, Fudenberg and Kreps (1993) 
demonstrate a2x2 game which has the fictitious play property, but for which 
average payoffs do not converge to the payoffs of the Nash equilibrium. 
Chapter 1. Introduction and literature review 
To combat some of these problems, stochastic fictitious play was introduced by 
Fudenberg and Kreps (1993), and studied further by Bena1m and Hirsch (1999). 
Here it is (essentially) assumed that players play a smooth best response (1.5) to 
the empirical frequency vector Cni for some choice of temperature parameter r and 
smoothing functions v' that is fixed throughout the learning process. This allows 
convergence of players' actual strategies (as opposed to the empirical frequencies) 
and lience removes many of the subtle problems related to convergence of (tradi- 
tional) fictitious play. The analysis of stochastic fictitious play requires the use of 
stochastic approximation theory, and will be addressed in Chapter 3. 
A version of best-response adaptation for fully rational Bayesian learners is given 
by Kalai and Lehrer (1993a, 1993b). In their framework, a strategy determines play 
for the entire repeated game, and players attempt to maximise their discounted 
future rewards. Players initialise by choosing prior distributions for opponent 
strategies, and these are updated in a Bayesian fashion as actions are observed. 
Players utilise a best response to their beliefs about future opponent play (as 
with fictitious play), though in the context of an infinitely repeated game with 
discounted rewards the calculation of this best response is far from trivial. They 
show that for general games players will eventually choose actions as if they were 
following a Nash equilibrium of the discounted repeated game (under continuity 
conditions on the priors). 
Consistent learning 
Returning to the context of repeated normal form games, a learning algorithm 
is defined to be consistent if, asymptotically, the average reward received is as 
large as the reward that is obtained by the best response to the empirical distri- 
bution of opponent play (Hannan 1957). Hart and Alas-Colell (2000) show that 
the empirical frequency distributions arising if all players follow a consistent learn- 
ing procedure will converge to the set of correlated Nash equilibria of a game (a 
I. I. Normal form games 
correlated Nash equilibrium is a Nash equilibrium under the influence of some 
correlating device-we will not study these in this thesis and so simply refer to 
Fudenberg and Tirole (1991) for the definition). 
Fudenberg and Levine (1999) show that stochastic fictitious play is C-consistent 
(i. e. the average reward received is within c of the reward obtained by the best 
response to the empirical distribution of opponent play) for suitable choice of 
temperature parameters, but Hart and Mas-Colell (2001 a) show that any algorithm 
where the strategy updates do not depend on the total reward received so far 
cannot be consistent. Instead, Hart and Nfas-Colell (2001a) present a full class 
of consistent regret-based strategies, extending previous work (roster and Vohra 
1997,1998,1999; Hart and Mas-Colell 2000). 
However, the convergence of these consistent algorithms is in the same sense 
as fictitious play-the empirical distributions of play converge, as opposed to the 
strategies of the players. Moreover the set of correlated equilibria of a game con- 
tains at least the convex hull of the Nash equilibria, and in general it is difficult to 
know how big the set of correlated equilibria will be (Fudenberg and Tirole 1991). 
These consistent algorithms require full information about rewards, i. e. the play- 
ers need to know what reward each of their actions would have received at each time 
step, and so are generally not applicable if the game is unknown or if players can- 
not observe opponent actions. To counter this problem, consistent reinforcement 
learning algorithms have been developed that can be used in the case of incom- 
plete information. Bafios (1968) and Megiddo (1980) construct explicit sequences 
of exploration and exploitation (see Section 1.2.3) allowing players to learn about 
the game being played while still playing sufficiently optimally to receive high av- 
erage reward. These algorithms are shown to asymptotically achieve the minimax 
payoff in zero-sum games. Auer et al. (1995) and Hart and Mas-Colell (2001b) 
present algorithms where the strategies evolve in a Markovian nature, and still 
result in consistent behaviour. Thus tile empirical frequencies of play converge to 
the set of correlated equilibria under these reinforcement learning algorithms. We 
Chapter 1. Introduction and literature review 
will attempt to improve on these results in this thesis. 
1.1.5 Evolutionary gaine theory 
Maynard Smith (1982) introduced the study of evolutionary processes using game 
theory; recent developments are summarised by Ilofbauer and Sigmund (1998). 
In this model the role of a player in a game is taken by a very large (infinite) 
population of individuals, each of which plays a pure strategy aEA. Thus a mixed 
strategy corresponds to a particular population state 7r E A, where A is the set 
of probability distributions over A. Usually in this setting we consider symmetric 
games, where the population is essentially playing against itself; a player who uses 
action a in a population in state 7r EA will receive reward 
r(a, 7r) = (U7r),, 
where U is an JAI x JAI payoff matrix. A Nash equilibrium in this context is a 
population state fr such that 
Fr TUft > 7r T UFr for all 7r E A. 
A central concept of symmetric games is that of the evolutionarily stable strategy 
(ESS). This is a strategy such that if a small population of mutants try to invade 
then they will not be able to gain a foothold by evolutionary means (i. e. they 
will receive a smaller reward than the individuals of the resident population). A 
strategy Fr is an ESS if 
r(fr, (1 - c)fr + e7r) > r(7r, (1 - c)fr + c7r) for any 7r and 
for sufficiently small c. 
By the linearity of r in the second argument, we see that this is equivalent to 
r(fr, fl : r(7r, fr) for any 7r, and in addition 
if 7r 0 Fr and r(fr, fr) = r(7r, Fr) then r(fr, 7r) > r(7r, 7r). 
Thus an ESS is a Nash equilibrium, but with an additional constraint. Not all 
games have an ESS, but if an evolutionary game has an ESS then this is a natural 
fixed point for any evolutionary dynamic. 
Normal form games 
A fictitious play procedure for symmetric games is given by 11ofbauer (1995). 
Here we start with a population consisting of a single player, then at each stage a 
new player is added; the new player uses a pure strategy which is a best response 
to the current population state. Thus 
7rn+l : -- 
--L- 7rn +I 
wherc 
bn E BR(7rn). 
n+l) n+I 
Hofbauer (1995) shows that this process will converge to the set of "segregation 
equilibria" of the game (a concept used only within that paper). For zero-sum 
games with an interior equilibrium, and games with an interior evolutionarily stable 
strategy, Ilofbauer (1995) then shows that this set coincides with the set of Nash 
equilibria. A stochastic version of this process, analogous to the stochastic fictitious 
play of Fudenberg and Kreps (1993), is introduced and studied by Hofbauer and 
Sandholm (2002). 
1.1.6 Dynamical systems in gaine theory 
Many previous studies of adaptation in games have considered 'small time-step 
limits' and/or 'infinite population limits', and investigate the resultant dynami- 
cal systems. We present three differential equations arising from game-theoretical 
ideas; convergence results for these systems will be given in the relevant chap- 
ters. More general dynamics have been studied, for example by Hopkins (1999). 
Although we don't need to study these here, it is interesting to note (Gaunersdor. 
fer and Ilofbauer 1995; Hopkins 1999) that there are relations between the three 
dynamics we present, even though the founding principles of the (smooth) best 
response dynamics and the replicator dynamics arc very different. 
Best response (BR) dynan-iics 
These dynamics can be considered as a continuous version of fictitious play (1.6) 
(Brown 1951; Ilofbauer 1995), and have been studied recently by Gilboa and Mat- 
sui (1991) and Gaunersdorfer and Ilofbauer (1995). Ilofbauer (1995) concentrates 
Chapter 1. Introduction and literature review 
on the symmetric game case, which (due to our choices of notation) can be speci- 
fied in exactly the same way. The idea is that strategies (or population states) will 
adjust towards a best response to the current strategy (population state). This 
results in the dynamics 
ir E BR(7r) - 7r, 
which actually defines a differential inclusion (Aubin and Cellina 1984), since 
BR(7r) is not single-valued for all 7r. Fixed points of this dynamical system are 
clearly Nash equilibria, so if a trajectory converges to a point * then Fr must be a 
Nash equilibrium. On the other hand, Cowan (1992) shows that chaotic behaviour 
can arise from the BR dynamics. 
Smooth BR dynamics 
This is a simple modification of the BR dynamics, where instead of adapting 
towards a (possibly not completely specified) best response, players use a smooth 
best response function 8' instead, resulting in the dynamics 
ir = P(7r) - 7r. (1.8) 
This has been considered in the N-player case by Hofbaucr and Hopkins (2000), 
and in the symmetric games case by Hofbauer and Sandholm (2002). Fixed points 
of this dynamic are not Nash equilibria, but instead are Nash distributions. How- 
ever, as noted previously, for small temperature parameters 7 in the definition 
(1.5) of the smooth best response, these Nash distributions will be close to the 
equilibria of the game. 
Replicator dynamics 
These dynamics are central to evolutionary game theory, but are also of interest 
wlicn studying learning (136rgers and Sarin 1997). In the evolutionary setting they 
arise from the population view of mixed strategies, where the number of players 
playing a pure strategy will grow at a rate proportional to the reward received by 
1.1. Normal form games 
that pure strategy against the mixed strategies of the opponent populations. Con- 
sider a population in player role i: if we let n(ai) be the number of players playing 
pure strategy ai and ni = E. iEAi ni(a') be the number of players in population i 
then ? i'(a') = r'(a', 7r-i)ni(ai). Letting 7ri(a) we see that n 
ir'(a') = 
iz'(a') n'(a')iz' 
ni (ni) 
r'(a', 7r -') 7r(a) - 7r'(a') 
E r'(b', 7r 
b'EA' 
7ri(a') (r'(a, r-') - r'(7r)) 
This is the asymmetric replicator dynamics (the symmetric replicator dynamics, 
used in evolutionary biology, is given by the same equation but with all superscripts 
removed). There is also a version of the asymmetric replicator dynamics known 
as the payoff-normalised replicator dynamics. These are only well-defined if the 
payoffs are positive, since otherwise division by zero could occur, and have the 
ir a 7r (a s) 
rl (as. 7r -r 7r 
r'(7r) 
Maynard Smith (1982) states that there is "room for doubt as to which form is 
more appropriate". Fixed points for all versions of the replicator dynamics are 
Nash equilibria for the game. 
Non-convergence of dynamical systems 
In a forthcoming paper, Hart and Nf as-Colell (2003) use a simple example to show 
that no "uncoupled" dynamics can lead to Nash equilibrium in general normal- 
form games. An uncoupled dynamic is any dynamic where the evolution of strategy 
7ri depends only on ri and 7r, and therefore includes all three dynamics considered 
above (although clearly the smooth BR dynamics (1.8) cannot converge to Nash 
equilibrium in general, since fixed points of the system arc Nash distributions). 
The property of being uncoupled also holds for virtually all dynamical systems 
studied in game theory. This result shows that any system in which players act 
Chapter 1. Introduction and literature review 
naively and ignore the payoffs of the others cannot converge to equilibrium in 
general games. 
1.2 Reinforcement learning 
Many of the learning processes previously studied in game theory require the play- 
ers to observe opponent play and make calculations, possibly based on knowledge 
of the reward functions. In an attempt to consider systems where players do not 
know the structure of the game, or even that they are playing a game, we would 
like players to learn the value of their actions simply from experience of play- 
ing those actions. Reinforcement learning (Bertsekas and Tsitsiklis 1996; Sutton 
and Barto 1998) provides a method for doing this. Most reinforcement learning 
ideas were originally developed in the field of discounted Markov decision processes 
(Ross 1982). We describe these, and give a summary of recent results in reinforce- 
ment learning. Although similar results are available for the field of average reward 
Markov decision processes (MDPs), all the algorithms are simply modifications of 
those used for the discounted case, but with additional complications, and are not 
instructive for the purposes of this thesis. See Puterman (1994) for a description 
of these. 
Discounted Markov decision processes 
The study of Markov decision processes was initiated by Bellman (1952). This 
area involves strategic planning, with the need to balance out short and long term 
gains. A single agent makes an action choice at a series of discrete time steps, and 
moves through a series of states. The movement and the reward at each step are 
dependent on the action chosen. In the simplest (finite) case we have: 
a single agent, 
a finite set of states X, 
1.2. Reinforcement learning 
*a finite set of actions A(x) available at each state xEX, 
*a (possibly random) bounded reward R(x, a) for each action at each state, 
* given states x, y and an action a, a probability Py(a) of being in state y at 
the next step. 
A policy is a rule which the player uses to choose an action at each time step, and 
in general may depend on the time, the current state and the history of actions 
and states previously visited; an optimal policy maximises the expected discounted 
future reward. A stationary policy is a policy for which the current choice of action 
depends only on the current state: actions are selected according to a distribution 
7r(x) E A(x) when the agent is in state x (where A(x) denotes the set of probability 
distributions over the action set A(x)). A stationary policy is deterministic if 7r(x) 
corresponds to a single action for each xEX. 
Theorem 5 (Bellman 1952) The maximal expected discounted future reward 
starting from state x is given by the solution to the equations 
V(x) = max E(R(x, a)) +S1: Py(a) V(y) for each xEX. (1.11) 
aEA(x) 
where 8E (0,1) is the discount factor. This solution exists and is unique, and 
an optimal deterministic stationary policy exists and is given by the maximising 
action a in this equation. 
Although the optimal policy is not necessarily unique (there may be more than one 
optimising action a), it should be noted that a deterministic stationary optimal 
policy does exist, and so we can restrict our attention to this class of policies. 
It will be convenient, here and in the sequel, to define r(x, a) = E[R(x, a)] to 
be the expected immediate reward if action a is chosen in state x. Fixing a policy 
7r, it is clear that the expected discounted future reward starting from state x and 
using policy 7r is given by the solution of the equations 
V"(x)=r(x, 7r(x))+SEP, y(7r(x))V'(y) foreach xEX, (1.12) 
Chapter 1. Introduction and literature review 
where r(x, 7r(x)) and P,, (7r(x)) are defined in the obvious manner. This is just 
a set of IXI linear equations in IXI unknowns. A naive solution method would 
therefore be to find the solution to this equation for every possible deterministic 
policy 7r and choose the policy giving maximal expected reward. However this 
would be computationally intractable and more subtle methods need to be used. 
1.2.2 Dynamic programming 
The traditional approaches to solving discounted MDPs are collectively termed 
dynamic programming. Ross (1982) and Puterman (1994) provide introductions 
to these areas. There are essentially two different types of algorithm-value cal- 
culation algorithms, and policy improvement algorithms. 
Value iteration 
Define an operator T: Rill -+ Rill by 
(TV)(x) = max r(x, a) +81: Py(a)V(y) for each xEX. 
aEA(x) 
It is a simple calculation to show that T is a contraction mapping with respect to 
the supremurn norm (i. e. JI(TV) - (TV')jj. < JIV - V'11o,, for two value functions 
V, V', with equality if and only if V= V'). The following theorem follows directly 
from this. 
Theorein 6 The iterates T(Vo) converge uniformly to the unique solution to Bell- 
man's equations (1.11), for any bounded initial conditions Vo E RIXI 
This therefore provides a method of finding the optimal policy: find the solution 
to lIcIlman's equations (1.11) by finding the limit of the iterates of an arbitrary 
bounded Vo under T, then choose a policy by using a maximising action at each 
state. This is known as value iteration, and generally requires an infinite number of 
iterations to find the optimal value function exactly. Stopping rules determining 
1.2. Reinforcement learning 
when the estimated value function is close enough to use to choose an optimal 
policy are discussed by Puterman (1994). 
Policy iteration 
A different method is policy iteration, which follows the following algorithm. 
1. Choose an initial policy 7ro. 
2. Evaluate Vn from equation (1.12). 
3. For each xEX, choose deterministic 
7rn+l(x)Eargmax r(x, 7r)+SEPxy(7r)V`(y) 
lrEA(x) 
changing from 7r,, (x) only if necessary. 
4. If 7r,, +, = 7r,, then this is an optimal policy, otherwise 
increment n and go to 
step 2. 
Theorem 7 For the policy iteration algorithm, V"-+' (x) : Vr- (x) for all xEX, 
with equality at all xEX if and only if 7r,, is optimal. Thus the algorithm will 
converge in a finite number of steps (since X is finite and 
A(x) is finite for each 
xE X). 
Asynchronous dynamic programming 
There is however a major computational issue for both value iteration and policy 
iteration if there are many states in the MDP (i. e. IXI is large). An entire sweep 
of the whole state space is executed at each step, and the value function or policy 
is updated at every single state. This is true even if the 
inputs to that state are 
not modified (for example in an NIDP where reward is only given out at a single 
state and there is strong structure in the transition matrices P(a), the value will 
change at only a small number of stages on each iteration). This point 
has been 
addressed by asynchronous (or incremental) dynamic programming. 
Chapter 1. Introduction and literature review 
In this it is assumed that instead of updating the entire vector V at each stage 
of value iteration, or the entire policy 7r at each stage of policy iteration, only one 
component at a time will be updated. Thus for each iterate of value iteration we 
V+, (x) = (TV)(x) for some x 
V+, (x) = V (x) for x 96 x 
and for each iterate of policy iteration we choose deterministic 
+p 7rn+l(xn) E argmax r(Xn, 7r) ., 
(7r)V7rn(y) 
7rEA(. rvl) 
for a single state xn EX for which 7rn(x) is not maximising. 
Theorem 8 (Williams and Baird 1993) Asynchronous value iteration con- 
verges to the unique solution of Bellman's equations (1.11) so long as the value at 
each state is updated infinitely often. Asynchronous policy iteration will terminate 
in finite time at an optimal policy. 
Furthermore, the repeated solution of the linear equations (1.12) during policy 
iteration is costly in terms of computational time, and so hybrid schemes are con- 
sidered where the value functions are updated using asynchronous value updates, 
and the policies arc improved using asynchronous policy improvements. Here, at 
each stage, the pair (V,,, 7r,, ) is transformed to (V,, +,, 7r,, +, ) by either updating the 
value of a single state x,,: 
V+i (x)= r(x, 7r(x +JE Pxy(7rn(XnVn(Y) 
or by updating the policy at a single state: 
7rn+I(Xn) E argmax r(Xni7r) + 8E PxnY(7r)vn(Y) 
7rE&(--n) 
for some x,, at which 7r,, (x) does not already maximise this quantity. Again, 
convergence is shown: 
1.2. Reinforcement learning 
Theorem 9 (Williams and Baird 1993) Provided that 
r(x, 7ro(x +SZ P. (. )(x, y)Vo(y) 2: Vo(x) 
for each xEX, the (V,,, 7r,, ) will converge to the optimal value function and pol- 
icy if asynchronous value function updates and policy improvements are executed 
infinitely often for all states. 
It should be noted that the initial condition is satisfied if the starting value func- 
tion Vo = V"O, so by picking an arbitrary initial policy 7ro and solving the linear 
equations (1.12) once to determine Vo = V"O we can guarantee convergence of this 
asynchronous hybrid scheme. 
It clearly becomes an interesting problem to determine the best order in which 
to apply these asynchronous operators. Previous work in this area is usefully 
summarised in Chapter 9 of Sutton and Barto (1998). The two major ideas are 
those of prioritised sweeping, for which the policy or value is updated first at 
states x where there is most chance of there being a significant change (measured 
by the amount of change at states affecting the value of x since the last time an 
update was made at x). The other is to simulate the model, and to update states 
reached while playing the current policy. This will mean that actions and values 
affecting the current policy will be updated most frequently. Of course, with these 
approaches one needs to be careful to ensure that the all states arc considered 
infinitely often. 
1.2.3 Reinforcement learning algorithins 
Reinforcement learning is a method for solving NIDPs which is very closely related 
to asynchronous dynamic programming; Sutton and Barto (1998) and Bertsekas 
and Tsitsiklis (1996) provide a useful introduction to the area. However the con- 
cept was originally proposed as a model of animal learning (Thorndike 1898). The 
basic idea is that an agent experiments with actions and then uses the reward 
Chapter 1. Introduction and literature review 
received (and other information available) as reinforcement, either positive or neg- 
ative, for the action played. A positively reinforced action will be more likely to 
be played again, whereas a negatively reinforced action will be less likely to be 
chosen. 
Q-1earning 
Due to the close relationship with dynamic programming, the discounted reward 
case is again simpler and we restrict attention to this case. Consider Bellman's 
equations for discounted dynamic programming (1.11), and define 
Q(x, a)=r(x, a)+SEP, y(a)V(y) 
foreach xEX, aEA(x), 
so that 
V(x) = max Q(x, a). aEA(x) 
We can then rewrite (1.11) in terms of the Q values as 
Q(xj a) = r(x, a) +J1: PV(a) max Q(y, b) for each xEX, aE A(x). (1.13) 
bEA(Y) 
It is clear that these equations are exactly equivalent to (1.11), and so every- 
thing that has been said about dynamic programming can be applied to these 
equations-in particular asynchronous backups can be performed, and the Q value 
at a single state-action pair can be updated at each step. 
Suppose however that the transition matrices P(a) and expected immediate 
rewards r are not known. By simply experimenting with different actions the 
agent can sample from the transition and reward distributions associated with 
those actions. Consider now the following algorithm, proposed by Watkins (1989), 
where at step n the agent is in state x,,, plays action a,,, receives reward R", and 
transitions to state x,, +,. 
Q,, +I(x, a) = Q,, (x, a) + An+1'1(Xn, an)=(z, a)) 
Rn +8 max Qn(Xn+l, b) - Qn(x, a 
bEA(x. +I) 
for each xEX, aEA (x), (1.14) 
1.2. Reinforcement learning 
where A,, +l E (0,1) is the learning parameter at step n. It is assumed throughout 
this section that the sequence of learning parameters satisfies 
A, (0,1)e Z An = 00, 
Z An2 < 00. (1.15) 
n>l n>l 
This condition is standard throughout reinforcement learning, arising from the 
stochastic approximation theory used to prove the convergence theorems. Essen- 
tially it means that the process can move as far as necessary A,, = oo) yet 
the variance will be bounded < oo). 
This can be seen as a stochastically sampled version of asynchronous value 
iteration. 
Theorem 10 (Watkins and Dayan 1992) The Q-1carning algorithm (1-14) 
converges almost surely to the unique solution of the cquations (1.13), provided 
that the Q value at each state-action pair is updated infinitely often. 
The theorem says that an agent in the environment may play any policy at all, 
and so long as all actions are played infinitely often at all states the learned Q 
values will solve the Bellman equations; an optimal policy will clearly be given by 
choosing a to maximise Q(x, a) at each state x. 
On-line learning 
This raises the prospect of learning in real-time, in which an agent learns how to 
act optimally while continuing to move around and experiment in the environment. 
Clearly there is now a trade-off to be made between acting optimally according to 
current estimates of values, and experimenting to find potentially more rewarding 
actions-this is known as the exploration-exploitation trade-off. Tile two main 
ways of doing this are an c-greedy scheme, and the smoother softmax scheme. For 
c-greedy action choice, the action with greatest current value Q. (x,,, a) at state 
x, will be played with probability 1-c, but with probability ca random action is 
chosen uniformly from A(x,, ). The softmax scheme is directly analogous to smooth 
Chapter 1. Introduction and literature review 
best responses (see Sections 1.1.2 and 3.2); the most common scheme is Boltzmann 
action selection, in which action a is played with probability 
eQ- (x,,, a)lr 
EbEA(x,, 
) eQ. 
(x,,, b)17- 
whcrc, r is some positive temperature parameter-a low temperature will result in 
a distribution where the maximising action is played with probability close to 1, 
whereas a high temperature will result in a near uniform distribution over actions. 
With online learning, the notion of asymptotic optimality is therefore important: 
a learning scheme is asymptotically optimal if, in the limit as n -+ 00, only optimal 
actions are played. If an exploration scheme is asymptotically optimal with respect 
to its Q value estimates (i. e. it plays the action a that maximises Qn(x,,, a)), yet 
also guarantees infinitely many updates at each state action pair, then it is called 
"greedy in the limit with infinite exploration (GLIE)" (Singh et al. 2000). For 
this we need the probability of experimenting to decrease to zero in the limit, but 
to decrease slowly enough that all state-action pairs are visited infinitely often. 
Define a communicating MDP to be an MDP such that for each pair of states x, y 
there is a stationary policy 7r such that the probability of getting to y under 7r, 
starting at x, is greater than 0, and let N,, (x) be the number of visits to state x 
up till step n of the learning process. 
Theorem 11 (Singh et al. 2000) The following exploration schemes are GLIE 
in a communicating AfDP: 
1. e-grccdy learning with the probability of playing an exploratory action given 
by c,, = cIN,, (x,, ) for some cE (0,1). 
2. Softmax learning with Boltzmann action choice where the temperature at step 
n is given byr,, = (may, Q,, (x,,, a) - min. Q,, (x,,, a)) / log N,, (x,, ). 
Indeed if we assume the rewards, and hence all Q,,, are bounded then soft- 
max exploration with Boltzmann action choice and temperatures given by r, = 
Reinforcement learning 
Cl log N,, (x,, ) for Ca positive constant is GLIE in a communicating NIDP. By 
following a GLIE scheme in a communicating MDP it is clear that the Q-1carning 
algorithm will almost surely converge to the solution of (1.13) and the agent will 
play asymptotically optimally. 
SARSA 
Q-learning can be considered an off-policy algorithm, in that the updates made to 
Q values at each step depend not on the current policy, but on hypothetical actions 
which are optimal with respect to the current estimates Q,, (the update is made 
using the maximal Q value at the next state). This is the reason why the actual 
scheme used to choose actions is not important for the asymptotical convergence 
properties. On the other hand there is a variation of Q-learning under which the 
updates to the Q values are made according to the actual action chosen at the 
next state using the current policy. This is known as an on-policy algorithm, and 
the actual scheme used to choose actions is therefore crucial to the convergence 
properties of the algorithm. 
The definition of the algorithm, known as SARSA since it updates according to 
the quintuple of State, Action, Reward, State, Action, is given by 
Qn+I (x, a) = Q (x, a)+ 
\n+11{(xn, 
an)=(-"ta{R + &Qn (Xn+ 1, an+ 1) - Qn (x, a)} 
for each xEX, aEA (x), (1.17) 
This is identical to the Q-1carning algorithm, except for the fact that the Q value 
from state x,, +, used to update Q,, (x,,, a,, ) is the Q value corresponding to the 
action chosen in the next state, as opposed to the maximal Q value for that state. 
Theorem 12 (Singh et al. 2000) Suppose a GLIE exploration scheme is used. 
Then almost surely the SARSA algorithm (1,17) will converge to the solution of 
the equations (1.13) and the agent will play asymptotically optimally. 
Although the convergence of Q-1carning was originally proved using an esoteric 
argument (Watkins and Dayan 1992), the convergence of both these algoritlims 
Chapter 1. Introduction and literature review 
has now been shown to arise directly from the traditional style of stochastic ap- 
proximation result given in section 1.3.1. From that section, it will be clear that 
it is important that the discount factor 8 is less than 1, which is what will give the 
stochastic contraction. A different way to get the stochastic contraction, without 
requiring a discount factor, is by assuming the task is episodic, i. e. will reach a ter- 
minal zero-reward state in finite time and then is restarted. This gives a stochastic 
contraction with respect to a weighted maximum norm. However we don't review 
these episodic tasks here. 
TD(A) 
The algorithms presented thus far "bootstrap", in that they use an arbitrary initial 
value function and make estimates based upon this arbitrary function (this is a 
feature of dynamic programming generally). However only one step of backup is 
performed at each stage (i. e. in SARSA only the Q value arising from the next 
state-action pair is used in an update). The natural question to ask is whether we 
could use the Q values at many subsequent states to provide information to the 
state-action pair currently being updated. This is achieved using the algorithm 
TD(A) (Sutton 1988). This algorithm is merely a value estimating algorithm, 
calculating the state values for a fixed policy 7r. 
Since advance knowledge of the future behaviour of the algorithm is not avail- 
able, we use the following rule to feed back modifications to the value of the current 
state to update the value of previously visited states that have (possibly indirectly) 
used the value of the current state to bootstrap. 
n(Xn)) 
E(SA) n-mjIIx. 
=YI} (1-18) V, n+l 
(Y) = K(Y) + An+I Uin + SVn(xn+l) -V 
So the temporal difference An+I(Rjj + SVn(Xn+l) - Vn(xn)) which would 
be added 
to the value Of Vn(xn) under an asynchronous stochastically sampled value itera- 
tion algorithm is instead fed back to all previous"states visited, using a weighting 
parameter AE (0,1] to determine how far back the difference is passed. 
1.2. Reinforcement learning 
Theorem 13 (Jaakkola et al. 1994) The TD(A) algorithm (1.18) for AE 
[0,1] will converge almost surely to the correct value for the current policy provided 
that S<1 and -- 
(AnI. I lln') 
-+ 1 almost surely as n -+ oo, where (An+I JXn = X) ---y (An+ 1 I-"n=T) 
is the value Of An+I which would be used if the state at step n is xn = x. 
In practise, instead of maintaining a history of the states visited in the past, 
eligibility traces are used. Define an eligibility trace recursively by 
eo(x) 0 for all xEX 
e,, (x) SAe,, -I(x) + 
Then in vector notation we set 
V. + A. +, (R. 
This is identical to the algorithm (1.18) but provides an online method where 
only the eligibility vector e,, and the value vector V,, need to be stored. Singh 
and Sutton (1996) modify this approach by instead setting e,, (x,, ) = 1, and claim 
to improve the robustness of the algorithm. They call this "replacing eligibility 
traces" (as opposed to the "accumulating eligibility traces" described above). The 
algorithm will converge under the same conditions as for accumulating illegibility 
traces. 
Note however that this is merely a value calculation method which will return 
V' for a particular 7r. It is therefore not a solution method for AIDPs, and should 
be regarded as a temporal difference method to calculate the value of a policy. 
However it has proved useful to Tesauro (1994), who has created a backgammon 
player that learns to play at master-level based on the TD(A) algorithm. 
Several true control algorithms have been suggested using eligibility traces, in- 
cluding SARSA(A) (Rummery 1995) and two proposed extensions of off-policy 
Q-learning to this domain (Sutton and Barto 1998, Chapter 7). None of these 
algorithms have been proven to converge. 
Chapter 1. Introduction and literature review 
44 criticism" 
Figure 1.1: Schematic diagram of actor-critic algorithms. 
Actor-critic algorithms 
Another class of reinforcement learning algorithms is actor-critic methods. In 
these the algorithm maintains a separate policy (the actor) and value function 
(the critic). The critic then provides information about the value of actions, and 
this is used by the actor to improve the policy. A schematic diagram is given in 
Fig. 1.1. This is related to the policy iteration algorithm, where the value func- 
tion V' acts as a critic to the actor 7r. Although closely related to the hybrid 
asynchronous value/policy iteration schemes described above, the general proper- 
tics of these algorithms arc not known. However Crites and Barto (1995) have 
described an actor-critic algorithm which is equivalent to Q-learning, and Konda 
and Borkar (2000) have proved the convergence an actor-critic algorithm which is 
an approximated version of policy iteration (in the same manner as Q-learning is 
an approximation of value iteration). 
1.3. Stochastic approximation 
Function approximation 
An aspect of reinforcement learning which has not been examined here, but is 
covered by Bertsekas and Tsitsiklis (1996), is that of function approximation. In 
many problems the size of the state space is huge, and too big for a table of all V or 
Q values to be stored, so a functional representation is used as an approximation. 
1.3 Stochastic approximation 
The subject of stochastic approximation was introduced as an iterative method to 
find the zeroes of a function when only a perturbed value of the function at the 
current estimate of the zero is known (Robbins and Monro 1951). However it has 
found application in various modern disciplines: in neural networks it is used to 
prove convergence of stochastic backpropagation methods, while in reinforcement 
learning it is the tool used to provide most of the convergence results in the liter- 
ature. Stochastic approximation will be used to prove many of the results of this 
thesis. 
In general we examine an algorithm of the form 
o', A+ , F+ , (0), (1.19) 
is a sequence of random functions and is a sequence of where IF,, },, - 
learning parameters. Throughout this section, we will assume that 17"}"? o is an 
increasing sequence of a-fields such that F, contains the stochastic approximation 
process up till time n. 
There are two approaches in the current literature. The first is the Robbins- 
Monro style, in which conditions placed on jr,,, }. >i and JA. j. >j ensure directly 
that 0,, --+ 0 almost surely. The second approach, known as the ODE approach 
(standing for ordinary differential equation), was suggested by Ljung (1977) and 
developed into a fruitful theory by Kushner and Clark (1978). For this approach 
the iterates of (1.19) are shown to approximate the solution of a related differen- 
Chapter 1. Introduction and literature review 
tial equation, and convergence properties of the stochastic approximation can be 
inferred from the behaviour of solutions of the differential equation. 
1.3.1 Robbins-Monro style algoritlinis 
There have been several generalisations of the original algorithm, many of which 
have been made by researchers in reinforcement learning. All of the results using 
this approach assume that the F,, satisfy contraction properties of some sort. In 
reinforcement learning the usual contraction property is with respect to a weighted 
maximum norm. The weighted maximum norm of a vector xG R' is defined by 
llxllw = max 
Lx(-i)', 
i=l ..., d 
where the weight vector W has positive components. The reason this norm is 
introduced is because for episodic tasks the value iteration function is a contraction 
for a weighted maximum norm even when the discount factor 8=1. 
The following theorem provides a recent result using this method, in which the 
learning parameters can depend on the component of 0,,. This allows for the study 
of asynchronous algorithms, where only some components of 0 are updated for 
each n. 
Theorem 14 (Singh et al. 2000) A random iterative process 
A', +i(zo', (z) \+1(Z)G+1(0)(z) 
conver9cs to zero with probability 1 if the following properties hold: 
1. The set of possible states z is finite, 
2.0: 5 An(z) : , 1, E,, , j An(z) = 
oo, En>l An 
< oo a. s., 
3. JjE(Gn+1(On)jFn)jjW KjjOnjjIV + Cn where ic E [0,1) and cn -+ 0 a. s., 
4- Var(Gn+I(On)(z)I-Fn) K(l + jjOnjjW)2' where K is a constant. 
1.3. Stochastic approximation 
Here W is a weight vector and. 7 is an increasing sequence of a-fields including 
the past of the process; in particular we assume that A., 0, Gn E rn - 
The asynchronicity is apparent in the Q-1earning process, for which An+, (x, a) = 
An+1'((xn, 
an)(. rta)) is non-zero only if (x, a) = (xn, an)- In this case the condition 
En An (Z) = oo is effectively a condition saying that the updates must be performed 
infinitely often at all states. 
Singh et al. (2000) use this theorem to prove the convergence of SARSA, whereas 
Jaakkola, et al. (1994) use a slight variation to prove the convergence of TD(A). 
This is also essentially the same theorem used by Littman and Szepesviri (1996) 
to prove that joint action maximin Q-learning will converge in 2-player zero- 
sum stochastic games (see Section 1.4)-various other generalised Q-1earning al- 
gorithms for discounted reward AIDPs are also proved to converge in the same 
paper. 
1.3.2 The ODE Approach 
Although the result of the previous section proves useful in certain instances of 
reinforcement learning, there are many situations under which such a contraction 
property does not hold. For these, a more general method must be employed. The 
ODE (ordinary differential equation) method of stochastic approximation is based 
on the observation that if F,, (O) = F(O) + U,, where F is a Lipschitz continuous 
function and is a sequence of random variables with bounded variation 
and mean 0, then (1.19) is a noisy discretisation of the ODE 
= F(O). (1.20) 
The limiting behaviour of the stochastic approximation process is therefore related 
to the asymptotic behaviour of trajectories of (1.20). This approach was first ex- 
plored by Ljung (1977), but is generally attributed to Kushner and Clark (1978). 
Recent developments are in Kushner and Yin (1997), with a more readily appli- 
cable set of results in BenaIm (1999). Beniim and Hirsch (1999) have used this 
UNIVERSn% 
OF BRISTN' 
Chapter 1. Introduction and literature review 
approach to study the behaviour of stochastic fictitious play, relating it to the 
smooth best response dynamics (1.8). We will extend their approach in several 
directions in this thesis. We follow the approach of BenaYrn (1999), starting with 
some standard definitions about trajectories of dynamical systems; we assume that 
a dynamical system is defined on a metric space (M, d), with induced norm 11 - 11. 
Definition 15 
1. A semiflow W on a metric space (M, d) is a continuous map p : R+ xM -* M, 
x) - vt (x), such that Vo = Identity and Vt+. = Vt o V, An ODE on M 
induces a semiflow V. 
2. An invariant set for the semiflow V is a set SCM such that ot(S) =S for 
all t>0. 
3. SC Af is an attractor for o if S is non-empty, compact, invariant, and has 
a neighbourhood U C: Af such that d(Vt (x), S) -+ 0 as t -+ oo uniformly in 
4. The basin of attraction B(S) of an attractor S is the set of points x such 
that d(Wj(x), S) -+ 0 as t -* oo. S is globally attracting if B(S) = M. 
5. Let S be a compact invariant set of the semiflow V. A continuous function 
Al -+ R is a Lyapunov function for S under W if V(Vt(x)) is constant 
for xES and strictly decreasing in t whenever x 
6. Given a trajectory X: R+ -4 M, the (omega) limit set of the trajectory is 
the set Ix E Af : X(tk) -+ x for some sequence 
tk -+ 00}- 
The central concept of BenaTm's approach to stochastic approximation is the 
asymptotic pscudotrajectory. This is a trajectory in M which asymptotically 
tracks tlic solutions of (1.20). 
1.3. Stochastic approximation 
Definition 16 A continuous function X: R+ -4 Af is an asymptotic pseudotra- 
jectory for a semiflow W if, for any T>0, 
lim sup d(X(t + h), oh(X(t))) = 0. t +10<h<T 
Proposition 17 (Bena-im 1999) Consider a general stochastic approximation 
process (1.19) in the metric space (Af, d). Let F,, +i(O,, ) = F(O,, ) + U,, +,, where F 
is a globally integrable vector field, the U,, are perturbations, and satisfies 
E An 00i A,, -+ 0 as n -+ oo. 
Let rn n = Ek=l Ak and m(t) = supin >0: t rn}, and assume that 
1. For all T>0, 
lim sup 1: AI+, UI+, :k=n+ m(T + T) 0. n-+c-o 
sup,, 110,, 11 < oo. 
Then an interpolation of the 0,, is an asymptotic pseudotrajectory of the semiflow 
induced by (1.20). 
Define the limit set of a stochastic approximation process {0. ),, 2: o to be the set 
L(10,, }) = {O E Af : Onk -+ 0 for some subsequence nk} 
Since Lff 0,, }) is contained in the limit set of any interpolation, it follows that the 
limit set of the (random) stochastic approximation process is contained the limit set 
of an asymptotic pseudotrajectory of the (deterministic) ODE (1.20). It therefore 
suffices to consider the conditions of Proposition 17, and then to characterise the 
limit set of asymptotic pseudotrajectories. We present a useful proposition giving 
conditions under which Condition 1 of Proposition 17 holds. 
Chapter 1. Introduction and literature review 
Proposition 18 (Benalm 1999) Suppose that is a deterministic se- 
quence, that U,, +, = X+1 + b,, +, where JAQ,, >1 is adapted with respect to Y and 
bn -+ 0 as n -+ oo, and that E(Af, +, I=0. Suppose also that for some q>2 
sup E(JJJVI+1119) < oo, and 
EA"I+q/1 
< 00. 
Then assumption 1 of Proposition 17 holds with probability 1. 
Note that if q=2 in this theorem, then the conditions on the learning parameters 
are identical to the conditions (1.15) stated in the section on reinforcement learn- 
ing, and the resulting conditions on the M,, are for them to have bounded second 
moments. 
Assumption 2 of Proposition 17 (on boundedness of the iterates) causes problems 
for many applications of stochastic approximation theory. Solutions are to be found 
in the projections of Kushner and Clark (1978), or in the random truncations of 
Chen and Zhu (1986). However, in most of our applications the iterates will be 
bounded automatically by the nature of the problem. 
In order to characterise the limit set of asymptotic pseudotrajectories, we intro- 
duce the following: 
Definition 19 Given a semiflow V, define an (c, T)-pseudotrajectory from xE 
toy E Af to be a sequence of points (Yo, ---, Yk) and 
times (tl, 
-. -, 
tk) with each 
ti >T such that 
d(yo, x) < c, d(Vtj (yj), yj+ 1) < c, and Yk " Y- 
Call xa chain-recurrent point of V if there is an (c, T) -pseudo trajectory from x 
to x for all positive T and c. A compact invariant set LCM of the semiflow V 
is called internally chain-recurrent if every point pEL is chain-recurrent for VIL 
(the semiflow restricted to the set L). 
Note the similarity between this concept of chain-recurrence and the cyclically 
stable sets of Gilboa and Matsui (1991). 
1.3. Stochastic approximation 
Theorem 20 (Benalm 1999) Let X: R+ -+ Af be an asymptotic pseudotrajec- 
tory of the semiflow V. Then the limit set of X is a connected, compact, internally 
chain-recurrent, invariant set of the semiflow v. 
Combining Proposition 17 with Theorem 20 shows that the limit set of a stochas- 
tic approximation process is an internally chain recurrent set for the semiflow 
induced by the ODE (1.20). 
Corollary 5.4 and Proposition 6.4 of BenaIm (1999) provide easily verifiable 
conditions which can be used to characterise the chain-recurrent sets of a flow, 
and hence the limit sets of the asymptotic pseudotrajectories: 
Proposition 21 (BenaTm 1999) Let L be the limit set of an asymptotic pseu- 
dotrajectory of the semiflow V, and let A be a compact invariant set of V. 
1. If A is a global attractor of V, then LCA. 
2. Let V be a Lyapunov function for A under V. If V(A) CR has empty interior 
then LCA and V(L) is constant. 
Bena1m, (1999) shows that all attractors will contain the limit set with positive 
probability, provided that the stochastic approximation process can enter their 
basin of attraction with positive probability. In contrast to this result, we wish 
to rule out certain parts of the chain recurrent set; this set is a superset of the 
recurrent set, and therefore contains all equilibria and periodic orbits. Since the 
perturbations allowed in the definition of chain recurrence arc enforced by the 
stochasticity of the approximation algorithm, it would seem reasonable to expect 
that linearly unstable equilibrium points and periodic orbits will have zero proba- 
bility of containing the limit set of the approximation process. This is indeed the 
case under conditions placed on the noise at these points. The basic result is 
to Pernantle (1990), but has been studied further by Beneim (1999) and Brandirc 
(1998a, 1998b). 
Chapter 1. Introduction and literature review 
Theorem 22 (Pemantle 1990) Let 0 be an equilibrium point of the semiflow 0, 
and let U be a neighbourhood of 0. Assume there are constants p C- (1,1] and 2 
CI 9 C2) C3i C4 >0 such that the following conditions are met whenever 0" EU and n 
is sufficiently large: 
0 is a linearly unstable critical point of the semiflow, 
'CL < 
An < c2 
nP -- nP) 
E((Un+l - v)+ I. Fn) : c3 for each unit vector v in the codomain of F, 
IjUnIl 
:5 C4i 
where (Un+l - v)+ is the positive part of U,, +, - v. Assume also that F is smooth 
enough to apply the stable manifold theorem (at least C'). Then P(O,, -+ 0) = 0. 
The asynchronous case considered in Theorem 14, where A,, (z) is state-depend- 
ent, is more difficult to deal with using the ODE approach, since when different 
components arc updated at different rates the differential equation (1.20) will need 
to be inodified to take this into account. Kushner and Yin (1997) have analysed 
the algorithm using a weak convergence criteria and the theory of differential 
inclusions. Almost sure convergence is studied by Borkar (1998). 
1.3.3 Two-tiniescales stochastic approximation 
Borkar (1997) studies concurrent approximation processes with learning param- 
eters that approach zero at different rates. Essentially what this means is that 
there is a 'fast' process, which can be considered to be always fully calibrated to 
the 'slow' process. However, both processes evolve concurrently, and it is only the 
magnitude of the learning parameters that differs. We here present a slight refor- 
mulation of the result of Borkar (1997) which places the result in the framework 
of BenaYm (1999). This is a special case of Theorem 40, and the proof is reserved 
till Chapter 4. 
1.3. Stochastic approximation 
Theorem 23 (Borkar 1997) Consider two coupled stochastic approximation 
processes 
0(i) 0(2))+ o(i) + A(i) n n+j F(')(O('), U, 
(, ')Il, for 
where, for each i, the following conditions hold: 
Bl 0(') E M('), where (M('), d(')) is a compact metric space, 
B2 F': M(l) X M(2) _+ M(i) is Lipschitz, 
B3 E,, >l An(i) = oo and An(i) -+ 0 as n -+ oo, and 
B4 for all T>0, 
lim sup 1: A(') U(') k=n+ m'(-r, ( ') + T) Op n-+oo 
1+1 1+1 
, rn(i) = En 
and m()(t) = sup{n 0: t where we define "I 
Ak k= k 
Further, the An(i) satisfy 
An(l)/An(2) -+ 0 as n -+ oo. 
Suppose that for each 0(') the ODE 
1 = F(2)(O(I), y) 
has a unique globally asymptotically stable equilibrium point C(O(Q) such that C is 
Lipschitz. Then, almost surely, 
110(2) 
_ C(0(1))II _+ 
nn as n -+ oo 
and a suitable continuous time interpolation of the process f 0n(')},, >o is an asymp- 
totic pseudotrajectory of the semiflow induced by the ODE 
(1.22) 
As observed by Borkar (1997), the condition B4 is satisfied whenever the 
are deterministic sequences with Ei>I(A(ni))2 < oo and the Afn() arc martingale 
differences with bounded second moment (this -is closely related to Proposition 
ChaPter 1. Introduction and literature review 
1.4 Stochastic games 
Stochastic (or Markov) games were initially introduced by Shapley (1953), in 
the context of zero sum games; a comprehensive survey is given by Filar and 
Vrieze (1997). They are a generalisation of both normal form games and Markov 
decision processes; players must act strategically, balancing out their immediate 
and long term rewards, but these rewards also depend on the actions of the other 
players. The technical framework is: 
eA finite set of players N}, 
*A finite set of states X, 
A finite set of actions A'(x) available to each player i=1..., n at each state 
xEX, resulting in a finite set of joint actions -A(x) = 
AI(x) x ... x 
AN(X) 
at each state. 
9A (possibly random) bounded reward R'(x, q) awarded to player i when joint 
action aE A(x) is played in state xEX; as for MDPs, define r'(x, a) 
E[R'(x, a)], 
Given states x, y and joint action a, a probability Pa(x, y) of being in state 
y at tile next step. 
We see that this is a direct combination of both normal form games and Markov 
decision processes, including both as a special case (reducing the player set to 
a singleton gives an MDP, while reducing the state set to a singleton plus an 
absorbing zcro-reward state gives normal form games). Writing A'(x) for the set 
of mixed strategies of player i at state x, and letting 
V'(x) = max mi() 7r 
i (a') Q'(x, (a', a-)) 
iriEA4(x) a-iEA, xE 
aiek(x) 
Q(x, a) = r'(x, a) + SEP, (X, Y)V'(y), foreachxEX, aEA(x). 
1.4. Stochastic games 
Shapley (1953) shows that for 2-player zero-sum stochastic games, taking max- 
imin strategies in place of the max used in dynamic programming (Section 1.2) 
again gives a contraction mapping if the rewards are discounted. Then the same 
arguments as used in dynamic programming imply that a stationary strategy will 
suffice, and that a solution exists. Filar and Vrieze (1997) generalise this result to 
show that for general games, if rewards are discounted, a Nash equilibrium must 
exist in stationary strategies. However calculating the equilibrium strategies may 
not be easy. 
1.4.1 Reinforcement learning in stochastic games 
Littman (1996) extends Shapley's idea to reinforcement learning, thus generalising 
Q-1earning to the area of discounted 2-player zero-sum stochastic games. Let 
V,, '(x) = max min 7r'(a')Ql (x, (a', a 
lr'EAl(x) a2EA2(X) 
IIEAI(r) 
Ql f Rn' + SVnl(x,, +i) - Qnl(x n+l(X, 
) =Qn(X, -a) 
+ An+llf(. In, ln)=('19)) 
for each xEX, aE A(x), 
with V,, 2 and Q2 defined analogously. This algorithm (called minimax-Q) converges n 
to the Nash equilibrium of discounted 2-player zero-sum stochastic games under 
similar conditions to those imposed on single-agent Q-1carning (Littman 1996). 
However, it requires that both players can observe their opponent's action 
choices, and also that they can solve a matrix game each time they play. The 
first requirement may or may not be satisfied, depending on the situation the 
players find themselves in; the second requires that players solve a matrix game 
(which is a linear programming problem) every time an action must be played. 
This is against the spirit of reinforcement learning, where agents should not make 
any complex calculations based upon knowledge of the environment. 
Hu and Wellman (1998) have attempted to extend this result to general-reward 
2-player games. However they place restrictive assumptions on the Q values ob- 
Chapter 1. Introduction and literature review 
tained at every step of the learning process-something which would be very dif- 
ficult to guarantee in practise (Bowling 2000). 
Claus and Boutilier (1998) formally observe the difference between "joint action 
learners", who observe the actions and rewards of all players, and "individual learn- 
ers", where players only respond to the rewards they receive. Littman's minimax-Q 
is an example of joint action learners, while the algorithms of most interest in this 
thesis are individual learners. 
Bowling and Veloso (2002) introduce WoLF learning, an individual learning 
algorithm for general games. Here, players record the average reward they have 
received, and modify their learning rates depending on whether they perceive their 
current strategy as performing better or worse than the historical average. They 
show that a version for 2-player normal form games where each player has only 
two actions will converge to Nash equilibrium. Further theoretical results are not 
available, but the empirical behaviour of the algorithm is impressive, even for 
complex stochastic games. 
Borkar (2001) provides the most advanced theoretical analysis of individual 
learners in stochastic games, with a generalisation of the actor-critic algorithm 
of Konda and Borkar (2000) to the multi-agent setting. He shows that appro- 
priate empirical mixed strategies arising from the process (though not the usual 
Cesaro sums of actions played) converge to a generalised Nash equilibrium, a con- 
cept developed in the paper and related to correlated Nash equilibrium. 
1.5 Motivating remarks 
As already observed, there is much interest in whether Nash equilibrium play 
can be explained by some process other than introspective analysis by the players. 
Many previous attempts have either used a population view of mixed strategies (in 
the evolutionary literature) or have assumed a knowledge of the reward structure of 
the game. In this thesis we will study reinforcement learning algorithms for games, 
1.5. Motivating remarks 
in which agents require no prior knowledge of the game; these are analogous to, 
and mainlY inspired by, reinforcement learning algorithms for Markov decision 
processes. 
Part of the motivation for the study of such processes is the observation that 
in many biological and economic applications of game theory the participants do 
not know that they are playing a game, let alone know the structure of the game, 
yet equilibrium play can still be observed. Examples of this approach are given by 
Hofbauer and Sigmund (1998) and Fudenberg and Levine (1998). 
A separate inspiration is the need for multi-agent learning in complex control 
environments (Crites and Barto 1998; Boyan and Littman 1994; Singh and Bert- 
sekas 1997), as well as agents that learn to play games (in the lay sense of the 
word) through self play (Tesauro 1994; Schraudolph ct al. 1994; Stone 2000). 
Many of these applications are actually in the field of stochastic games. How- 
ever, the theory of reinforcement learning in normal form games is still far from 
complete-previous analytical work in this area is largely restricted to the con- 
sistent reinforcement learning algorithms described in Section 1.1.4, for which the 
empirical distributions of play will converge to a correlated Nash equilibrium, and 
some results on 2x2 games (Bowling and Veloso 2002; Singh et al. 2000). This 
thesis will concentrate largely on normal form games, since these provide a (rela- 
tively) simple setting where ideas can be developed and studied theoretically. It is 
anticipated that these ideas and theoretical results will be extended to stochastic 
games in the future. 
Reinforcement learning is interesting because players must discover how to act 
in an unknown environment. On the other hand, the environment faced by any 
particular player of a game is not stationary, because opponents are also learn- 
ing. By using sophisticated tools from the theory of stochastic approximation and 
dynamical systems we can analyse the asymptotic behaviour of these processes, 
determining whether (or not) convergence will occur in the long term. 
Chapter 1. Introduction and literature review 
1.6 Outline of the thesis 
We start, in Chapter 2, by considering B6rgers and Sarin's (1997) version of a 
'mathematical model for simple learning' (Bush and Mosteller 1951). This results 
in a stochastic approximation of the replicator dynamics (1.9). We describe some 
of the problems inherent to learning in games, and introduce a new algorithm 
which uses two-timescales stochastic approximation to approximate the payoff- 
normalised replicator dynamics (1.10). 
In Chapter 3 we introduce an actor-critic learning algorithm in which players 
update their estimates of the value of actions on a faster timescale than they adapt 
their strategies towards a smooth best response to these estimates. This means 
that the value estimates can be considered to be accurate, and the strategies are 
a stochastic approximation of the smooth best response dynamics (1.8). A related 
population process is also considered. 
The actor-critic algorithm is extended in Chapter 4, and players now all 
adapt their strategies on different timescales. This necessitates an extension of 
Borkar's two-timescales stochastic approximation result (Theorem 23) to multiple 
timescales. The algorithm is shown to converge to Nash distributions for several 
classes of game, and in particular for two games which have caused difficulty for 
most (if not all) previous learning processes. 
The fundamental algorithm of reinforcement learning in MDPs is Q-learning 
(Watkins 1989). We study a version of this for normal form games in Chapter 5. 
It is shown that the Q values evolve in a manner closely related to the smooth 
best response dynamics, and thus will converge in 2-player zero-sum games. A 
modification of this algorithm where the players learn at different rates is also 
considered. 
Chapter 6 introduces a version of the actor-critic algorithm of Chapter 3 where 
players adapt towards a best response (instead of a smooth best response). This 
algorithm is studied by analysing a generalisation of weakened fictitious play pro- 
1.6. Outline of the thesis 
cesses (Van der Genugten 2000), relating the behaviour to that of the best response 
dynamics (1.7). Our discontinuous actor-critic algorithm is the first reinforcement 
learning algorithm proven to converge to Nash equilibrium in general 2-player zero- 
sum games, and N-player partnership games, as well as other classes of games. 
Attempts to extend these algorithms into stochastic games have demonstrated 
that it will be useful to consider carefully the nature of smooth best response 
functions. In Chapter 7a method is developed for which there is a unique smooth 
best response to opponent strategies in a stochastic game. 
Further work is suggested in Chapter 8. 
Chapter 2 
A model for simple learning 
In this chapter we modify a reinforcement learning algorithm for repeated normal 
form games, known as "stimulus-response learning" (136rgers and Sarin 1997). 
This algorithm is a special case of Bush and Mosteller's (1951) "mathematical 
model for siniple learning", and has also been studied in the context of automata 
games (Narendra and Thathachar 1989). 136rgers and Sarin (1997) show that each 
player will converge to a pure strategy with probability 1. This is an obvious failure 
of the algorithm, since then for certain games (those with only mixed equilibria) 
convergence to the Nash equilibrium has zero probability. 
In this chapter we argue that B6rgcrs and Sarin's use of a fixed learning pa- 
rameter is partly to blame for this behaviour, and that by introducing a variable 
learning parameter satisfying the standard conditions (1.15) an improvement is 
gained. We show that an interpolation of our algorithm is an asymptotic pseudo- 
trajectory of the replicator dynamics (1.9), and that if the process converges to a 
mixed strategy then it must be a Nash equilibrium of the game. 
Section 2.1 presents our model and the basic stochastic approximation result, 
then Section 2.2 provides a brief summary of the known results about the replicator 
dynamics. In Section 2.3 we apply the algorithm to some simple games, while 
in Section 2.4 a modification of the algorithm which relates to the normalised 
replicator dynamics (1.10) is examined. 
2.1. Stimulus-response learning 
2.1 Stimulus-response learning 
We model learning in a repeated normal form game using a very simple algo- 
rithm under which players observe a stimulus (the reward received) and produce 
a response (a direct modification of their strategy). Although this mixes rewards 
directly with policies, when in reality these quantities exist in different spaces, it 
results in a model which can be analysed easily. Suppose that at the rith play of 
the game, player i uses mixed strategy 7ri, to select action ni. and receives reward 
R' E [0,1). This is clearly a restricted class of games, but rewards of any garlic n 
with bounded rewards can be rescaled to fit in this framework. 
After game n, player i updates their strategy according to 
7r i +, 
(ai)"": (l-An+, R')7r'(a')+An+, Rnl(c, 4=a') forall a'E/V, (2.1) nnnn 
where f An}n>l is a deterministic sequencc satisfying the standard reinforcement 
learning conditions (1.15), and also satisfying An E (0,1). This is identical to 
the algorithm proposed by B6rgcrs and Sarin (1997), except for the fact that the 
learning parameters A,, vary with it. 
Writing a,, for the joint action played at game n, 7r. 
for the joint mixed strat- 
egy used at game n, and 7r-i for the opponent mixed strategy at game it 
(1; (-v 
Section 1.1), and assuming that the 11, i, arise from payoffs in a game, we see that 
E[Rn' I 9n) = ri(an), E[Ri I a', 7r-'] = r'(a', 7r-i), and 
E[M 17r,, ] = ri(v. ). Note 
nnnnn ft 
that the R' could be independent random variables with appropriate means with. n 
out enforcing any change to our analysis. Thus we see that 
E[7rn'+ I 
- 7r' 
(a') I 7rn n+ 1 
7rI, (b' ) ... 7rN(blv)r() 7r,, (a')) nn 
An+l ir, 4, (b')r4(b4,7r; ') ir'(a')) nn 
bleAs 
An+17rni(a') fri(ai, 7r; ) - r'(ir. 
Defining F(7r)'(ai) = ri(a') {r'(ai, 7r-) - r'(7r)} it is clear that 
i= 7ri + Ai 7rn+ In+, 
(F(7r,, ) + Uno) 
Clinpter 2. A model for simple leaming 
where U,, +, has zero inean and is bounded (since R' E [0,11). Therefore Proposi- n 
tion 18 holds, the conditions of Proposition 17 arc satisfied, and Theorem 20 shows 
the following: 
Tlicoreiii 24 IVA probability I the limit set L of the learning process defined 
in (2J) i$ 4 connected, COMp4d, internally chain-recurrent, invariant set for the 
serniflow (p defined by the asymmetric replicator dynamics (1.9). 
2.2 Replicator dynamics 
Thus we wish to use the results of Section 1.3 to characterise the limit set of 
otir learning algorithm, by determining the internally chain-recurrent sets for the 
seiniflow induced by the replicator dynamics. These dynamics have been studied 
by, aniong others, Schuster and Sigmund (1981), Ritzbcrger and Weibull (1995), 
Caunersdorfer and Ilorbauer (1995) and Plank (1997). We summarise the results 
here. 
Theorem 25 (Ititzberger and Weibull 1095) The semiflow induced by the 
replicalor dynamics (1.9) is volume preserving in the interior of the strategy space 
for all games. Corisequcnlly, a fixed point r is asymptotically stable if and only if 
it is a strict Nash equilibrium. 
This result shows that for any game without strict Nash equilibria there will be 
no asymptotically Stable points. Iforbauer (1996) has examined the Hamiltonian 
nature of this dynamic in two player games, although we do not look at this here. 
Theorem 20 (Ilofbauer nnd NVeibull 1990) Actions which are eliminated by 
the procedure of ilcratcd strict dominance will have zero probability in the limit as 
-+ oo for the repticator dynarnics (1.9). 
For 2x2 gaines, the situation is fully analysed by Schuster and Sigmund (1981). 
In essence, cither the game is sol", ble by iterated strict dominance, in which case 
2.2. Replicator dynninics 
the previous result shows that the Nash equilibrium is asymptotically stable, or 
there are two pure strategy strict Nash equilibria which are asymptotically stable 
and an internal equilibrium which is unstable, or there is a unique equilibrium 
in the interior of the strategy space. For this latter case the replicator admits a 
constant of motion, and the strategies follow contours of this constant of motion 
as they cycle around the equilibrium. 
For general 2 player games we have the following: 
Theorem 27 (11ofbauer and Sigmund 1008) If the limit sct of ars orbit of 
the replicator dynamics (1.9) for 2 player games is contained in the interior of lite 
strategy space then the time average exists and corresponds to a Aash cquilibrium. 
On the other hand Plank (1997) gives an example of a three player binary game 
(where each player has only two actions) for which interior orbits exist with time 
average not equal to a Nash equilibrium. Little else is known about general N- 
player games. 
We would like to apply Thcorem 22 to show that there is zero probability of 
convergence to a pure strategy which is not a Nash equilibrium. We start by 
showing that these strategy combinations arc linearly unstable. 
Proposition 28 Let 7r be a fixed point of the replicalor dynamics (1.9) which is 
not a Nash equilibrium. Then ir is linearly unstable. 
PROOF Since 7r is a fixed point, for each i we inust havc ri(ai, ir-i) = ri(7r) 
whenever 7r'(a') > 0. If 7r is not a Nash equilibrium then, by definition, there 
exists i, b' such that ri(b', 7r-i) > r'(7r). So we see that ni(bi) = 0. Consider the 
slightly perturbed joint strategy * in which player i plays bi with probability c 
and chooses from distribution 7r' with probability I-c, for small c, and all other 
Clinpter 2. A model for simple learning 
players play with strategy 7r-4. Then 
r(V) { r(b r4 (fr) 
=cI r'(b', 7r -') -c r'(b', 7r -') -(1- c) r'(7r) 
=e(I- c) { r'(b', 7r -') - r'(7r) 
and so v is linearly unstable. 
However if ir is a boundary point then the noise is no longer "sufficiently diffuse" 
to apply Theorem 22. This is apparent from experimental results in Section 2.3, 
where convergence to non-Nash pure strategy combinations occurs. However, it is 
still true that therc is probability 0 of converging to a completely mixed strategy 
(i. e. one in the interior of A) which is linearly unstable. 
Partnership gnines 
Despite the inconclusive nature of the results so far, partnership games arc a special 
c. i-%(. * which are more amenable to study. We gcneralisc a result from Hofbauer and 
signmild (1998). 
Theoreni 20 In a partnership game the replicator dynamics admit a Lyapunov 
function for the act of stationary points. 
PRoor We drop superscript i on the (expected) reward, since it is identical 
for all players. Now consider 
; i-, r(7r) =E1: UWr(7) 
i aiek 
E r(a 
7r-') 7r(a') 
(r(a', ir-') - r(ir)) 
afiEk 
But since EjeA, 7r4(ai) =I we see that Eaiek r(ir)iri(a') (r(a', 7r-') - r(7r)) =0 
and so Rubtracting froin the expression for Zdf r(7r) we see that di 
i )) 2 
r0r) 7r (a') 
(r(a', 7r-') - r(7r di 
2.3. Some exnniples 
Equality will hold here only at stationary points of the replicator dynamics, and 
-r is clearly a Lyapunov function. 
Corollary 30 In partnership games, the learning algorithm (21) will converge 
with probability I to the set of fixed points of the replicator dynamics. 
PROOr From Theorems 24 and 29, and Proposition 21, it follows that the 
limit set of the learning process will consist only of fixed points of tile replicator 
dynamics if the set of possible rewards at these points lias empty interior. This 
fact follows from the Alorsc-Sard theorem applied to each face of the space of 
strategies A. 
2.3 Some examples 
In this section we consider our algorithm more carefully in two simple games. For 
each experiment we use learning parameters A,, = (n + 100)-l' where tile learning 
rate satisfies 0.5 <p :51. For these 2x2 games, we denote by p the probability 
that player 1 plays a "head" (i. e. action 1), and by q the probability that player 2 
plays a "head". The state of the algorithm is then fully encoded by tile pair (1), 9). 
2.3.1 Simple coordination 
We start with a very simple game, which has payoff matrix 
(111) (010) ( 
(0,0) (0.5,0.5) 
The fixed points of the replicator dynamics (1.9) for this game are the four pure- 
strategy combinations, of which only two (P =q=I and 1) =q= 0) are Nash 
equilibria, and the interior Nash equilibrium where p=q= 1/3. Since the interior 
equilibrium is linearly unstable, we know from Theorem 22 and Corollary 30 that 
the learning algorithm will converge to one of the pure-strategy combinations. 
47 -1 UNivERsnN 
GFDRISTOk 
enr% a n%i 
Chapter 2. A model for simple learning 
It would seem reasonable to expect that our learning algorithm will converge to 
a random pure strategy equilibria, and will be more likely to converge to the 
Pareto dominant equilibrium where both players receive reward 1. We ran 1000 
simulations, each for 10' iterations with p=0.8 and a random start point. On 
713 of these trials the algorithm "converged" to the Pareto dominant equilibrium, 
where 1) =q=1, and on the further 287 trials the algorithm "converged" to the 
other pure-strategy equilibrium. I have placed the word "converged" in quotation 
marks here, because obviously the algorithm does not properly converge in a finite 
number of iterations. Ilowcvcr in this situation if the probabilities are within 10-3 
of either 0 or 1 after 10" iterations then we assume the convergence to the relevant 
point is sufficiently likely. 
We can compare the ratios or the number of times to converge to each equilibrium 
with the size or the basin of the attraction of that equilibrium under the replicator 
dynamics. rroin Schuster and Sigmund (1981) we know that these basins have 
common boundary defined by p(I - p)l = q(1 - q). This clearly has a solution 
q, but this is not the relevant line. It is simple algebraic manipulation to see 
2 -p- -V/, (4 -3P) that the boundary line is actually given by q=2. We integrate this 
from 0 to I in to calculate the size of the basin of attraction of the point (0,0). 
Vl-)(4 --3, p) dig (3p _ 1)1 dv 
-2 4 V3- 
cos' 0 dO 43 -v/-3 
22 V3- 
; -., 0.2636 
So we s(v that the proportion of learning episodes that converge to (0,0) compares 
with the size of the basin of attraction. 
2.3. Sonle examples 
2.3.2 2-player matching pennies 
This game is the canonical example of a2x2 game with diametrically opposing 
objectives for the two players; player 1 scores a point if both players play the same 
action and player 2 scores a point if the players play opposing actions. Tbe payoff 
matrix is therefore: 
(1,0) (0,1) ( 
(0,1) (1,0) 
In this game there is a constant of motion for the replicator dynamics, given by 
h(p, q) = p(l - p)q(l - q). This constant of motion takes values between 0 (on the 
boundary of the unit square) and 0.0625 (at the unique equilibrium point where 
each player plays "head" with probability D. 2 
Defining h,, = h(p, q,, ), some simple algebra shows that 
E[hn+1 I Pnqqn An+ 11 =(I -A'+ I)h.. (2.2) 
So Ih,, } is a bounded supermartingale, and thus converges to a randorn %-ariable 
- This explains why our algorithm can converge to an 
internal cycle instead of a 
pure strategy equilibrium in this game: for h. -+ h,, we must have E(h,, +, -h,, ) -+ 
0. If A,, is bounded away from zero (which of course includes the case of constant A 
used by B6rgcrs and Sarin (1997)) then h... =- 0. On the other hand if. \,, -+ 0 then 
h,. can take values other than 0. This idea is a stochastic analogue of tile reasoning 
used by Akin and Loscrt (1984) to show that using a simple discretisation of thc 
replicator dynamics in this game will necessarily lead to the boundary. 
In fact we can learn more from this analysis: observe that 
E[h. I hol = ho 
- (2.3) 
If A,, ' oo then it follows that Fj. >j(1 + An2) 00. 
But for A>0 it is 
clear that 1 A2 < (1 + \2)-l and so 
2) 5 fl(1 An2)-1 = 
n>I nX 
Chapter 2. A model for simple learning 
LLLLL[L 
0.00 0.02 0.04 0.06 
Final value of h (p = 1.0) 
0.02 0.04 0.06 
Final value of h (p = 0.8) 
0.00 0.02 0. 
Final valuc of h (p = 0.6) 
Figtire 2.1: Final values of h after 105 iterations. 
Thus the standard stochastic learning condition of En>1 An 2< oo is necessary to 
avoid the situation of h. =- 0. 
For this ganic three sets of 100 learning episodes with random start points were 
run, cach with 10' iterations for each learning episode. The learning rate p was 
chosen differently for each set. The final value of h was recorded in each case, and 
histograms of the results arc in Figure 2.1. It can be seen that h will tend to finish 
lower whenever A decreases more slowly. This is to be expected from equation 
(2.2), since when A decreases more slowly the overall drift of h will be larger than 
2.4. An extension 
0.0 0.2 0.4 0.6 0.8 1.0 
Figure 2.2: Learning trajectory of the simple learning model In 2-player 
matching pennies. 
when A decreases quickly. 
To give a greater appreciation of what happens in this gaine Fig. 2.2 shows thc 
trajectories through (p, q)-space for a typical learning procedure with p=0.8 and 
5x 10' iterations. It can be seen that after initial fluctuations the algorithin settles 
on to a contour of h, although convergencc to a point never occurs. 
2.4 An extension 
In this section, we restrict our attention to games with positive payoffs. Under 
this assumption, Ilofl)aucr and Sigmund (1998) show that the payofr-normalised 
replicator dynamics (1.10) arc volume-contracting for 2 player games, and that for 
generic 2x2 games the set of Nash equilibria is globally attracting for tile set of 
completely mixed strategies. 
Clinpter 2. A model for simple learning 
We could clearly achieve this dynamic via our learning algorithm by simply 
dividing the obtained reward with a calculated value of r'(7r). This however con- 
tradicts our basic assumptions that players do not know the structure of the game, 
nor even that they are playing a game. Instead we learn the value of r'(7r) us- 
ing two-tinicscales stochastic approximation (Section 1.3.3). Thus our learning 
algorithin becomes: 
iI (a') = 
_ A(, 
R,, ) 
7r' (a) + 
P), R,, I (., =ail n+ n+ S. i n n+ Sin n 
(2) )Si + A(2) 
n n+, 
with satisfying the standard conditions (1.15), and also 
An(l)/An() 
-+ 0 as 
H- 00. 
We see that S,, is our estimate of ri(7r). Note that 
) r'(a', 
7r-') - r'(7r,, 
E[ir' +, 
(a') - 7r' 
(a') 17r,, S,, ] =A('), 7r' (a' n nn n+ nS in 
E[S, i, 
S. i l7r, S,, ) = \(2)1 
r'(7r,, ) - 
Thus defining FI(7r, S)'(a') = 7r'(ai)fr'(a', 7T-')-r'(7r)}/S' and F 2(7r, S)i = 
r4(7r) - Si we can use Theorem 23 (condition B4 is satisfied since the implicitly 
defined U, (, ') are martingale differences). The fast ODE (1.21) is simply 
= r'(7r) - si 
which, for fixed 7r, clearly has the globally asymptotically stable fixed point r, 7 
This is Lipschitz in 7r, and so we see that ISi, - ri(r,, )l -+ 0 as n -+ oo and that 
an interpolation of the 7r,, is an asymptotic pseudotrajectory of the dynamics 
*=F1 Or, r'(7r)). 
But by the derinition of Fl this is just the payoff-normalised replicator dynamics 
(1.10). 
There is an additional complication with this algorithm: the stated update to 7r, 
d(ws not necessarily place 7r,, +, into the simplex. In practise this can 
be resolved 
2.4. An extension 
0.0 0.2 0.4 0.6 0.8 1.0 
Figure 2.3: Learning trajectory of the normalised learning model In 2- 
player matching pennies. 
Clinptcr 2. A model for simple learning 
by starting A sufficiently small so that it is not an issue. A further option would be 
simply to ignore updates that would move 7r,, +, out of the simplex, on the grounds 
that asymptotically all updates would be included due to the decreasing A,,. 
Convergence of this algorithm is slow. This is partly because as the algorithm 
nears the equilibrium point the dynamical system (1.10) approximates the un- 
normalised replicator dynarnics (1.9), which does not converge as we have seen. 
2) However using A(nl) = (n + 100)-0-9, 
= (n + 100)-o-6, and examining 100 
episodes of 5x 10' iterations, each episode ended in "convergence" to the Nash 
equilibrium on the matching pennies game which foiled our original algorithm 
(here "convergence" is even looser than before with convergence being assumed 
if h>0.06 at the end of the episode). A sample learning episode with 5x 101 
iterations is plotted in Figure 2.3, as was done for the un-normalised learning 
algorithm in Figure 2.2. It is clear that this algorithm does spiral clockwise towards 
the centre point, but converges very slowly indeed. 
RUAIARK It will be noted that this is related to the "Win or Learn Fast" 
(or W61, F) principle (Bowling and Veloso 2002). When a player is doing badly 
(Sin P4 ri(7r,, ) is sinall) the adjustments made to 7ri arc greater than if the player n 
is doing well (Sin is large). 
2.5 Conclusion 
We have presented a modification of 136rgers and Sarin's learning model, then used 
standard results of stochastic approximation theory to examine the asymptotic 
behaviour of our algorithin. Wc find that the limit set of the learning algorithm 
is a connected, compact, internally chain-recurrcnt, invariant set of the serniflow 
induced by the asymmetric replicator dynamics (1.9). 
I lowever we have shown that convergence to a Nash equilibrium is not the only 
Iiiniting behaviour. Indeed for 2x2 games with a unique internal equilibrium 
persistent cycling is the norm, and generally it is difficult to rule out convergence 
2.5. Conclusion 
to pure strategy combinations that are not Nash equilibria. 
We have also provided a further modification of the algorithm which results 
in an asymptotic pseudotrajectory of the payoff-norl-nalised rcplicator dynamics. 
Although convergence to the boundary of the space of mixed strategies can still 
not be ruled out, at least limit cycle behaviour is not possible, due to the volume. 
contracting properties of the scmiflow. 
This simple model uses observed rewards to directly modify the strategies, when 
in reality these quantities exist in different spaces. This is addressed in the next 
chapter where a separate value function is maintained alongside the policy. 
Chapter 3 
Smooth actor-critic algorithms 
The replicator dynamics do not provide a particularly useful framework on which to 
build a rehirorcement learning algorithm, since Nash equilibria are not generally 
attracting under these dynamics, and there arc fixed points that are not Nash 
equilibria. A more promising dynamical system is based upon best responses. 
Such a reinforcement learning algorithm will then relate closely to fictitious play 
and its variants. 
Several parts of this chapter will appear in Leslie and Collins (2003), and were 
presented at the 13th International Conference on Game Theory at Stonybrook. 
3.1 Introduction 
As observed in Section 1.1.3, the beliefs under fictitious play will converge to Nash 
equilibrium in several classes of games. Suppose that, instead of maintaining beliefs 
al about opponent strategies, players are told the current opponent strategy 7r-' 
and adjust their own strategy towards a best response to this. This results in a 
best-response adaptation procedure 
n+l = 
- A,, +1)7r,, + 
A. +, BR(7r, -, 
3.1. Introduction 
for some learning parameters It is immediately obvious that if An = n-1 
then the 7r,, evolve exactly as the beliefs a,, of a fictitious play process (1.6). 
However, if this scheme were realisable it would be the strategies of the players 
that converges to equilibrium, as opposed to empirical averages. 
At first, it seems that we have taken a step backwards here, in that now players 
need to observe the full mixed strategy of the opponents, where, " for fictitious 
play all that is required is the action played at each step. However, note from tile 
definition (1.1) of best responses that all that is required to select a best response is 
a knowledge of the expected rewards ri(a', 7r-'). In this chapter we will show how 
to use two-timescales stochastic approximation to learn these expected rewards, 
without any observation of opponent play being required at all. 
However, in order to use the ODE method of stochastic approximation it is 
necessary for the expected adjustment to be a Lipschitz function of the current 
strategy; best responses are not continuous in opponent strategy. Also, as we have 
seen in Chapter 2, if players approach a pure strategy (or a mixed strategy where 
any action is played with zero probability) then the player inay never realise that 
unplayed actions are better responses to opponent strategies. A similar problem 
arises here. Therefore, following Fudenberg and Nrcps (1993), we consider not 
best responses (1.1) but smooth best responses (1.5). In Chapter 6 we will see 
how to adapt this algorithm to use best responses. 
The chapter is arranged as follows. In the next section we discuss stochastic fic- 
titious play (Fudenberg and Kreps 1993; BenaYin anti Hirsch 1999) and tile smooth 
best response dynamics (Ilofbauer and Hopkins 2000). We present and analyse our 
algorithm in Section 3.3, then demonstrate a version for symmetric games (similar 
to the symmetric stochastic fictitious play of Ilofbauer and Sandliolin (2002)) in 
Section 3.4. A numerical example is presented in Section 3.5. 
Clinpter 3. Smooth nctor-critic algoritlin-is 
3.2 Stochastic fictitious play 
Fudenberg and Kreps (1993) observe that convergence of beliefs in a fictitious play 
process does not mean that strategies, or even average payoffs, converge to Nash 
equilibritun. To counter this they introduced stochastic fictitious play. Here, at 
tinic n, player i plays the mixed strategy corresponding to a smooth best response 
to the beliefs an-i about opponent strategy. The beliefs at time n are the average 
of the previously observed actions. Thus 
all I all] = nTi 
W(an) - an) 
Since 13 is Lipschitz, the strategies are bounded (they remain in A), and O'n+l  
a, + A. + I 10(a, ) - a. + U. + I} wherc the U,, arc bounded martingale differences, 
the rollowing is immediate: 
Theorem 31 (Benn"mi mid Ifirscli 1099) A suitable interpolation of the se- 
quence {a. ),, >, of bclitfs arising from a stochastic fictilious play process is an 
asymptotic pseudotrajectory of the semiflow induced by the smooth best response 
dynamics (1.8). 
Thus we are interested in the chain-recurrcnt sets of the smooth best response 
dynamics. ne- relevant results arc given by Hofbauer and Sandholm (2002). 
Theorein 32 The smooth best response dynamics (1.8) admit a Lyapunov junc- 
tion for the -set of Nash distributions in the cases of . 
2. player zero-sum games and 
of N-player partnership games. For -2-player zero-sum games there is a unique 
Nash distribution (for any given smooth best response functions). 
P110or Consider first partnership games, and the function 
U(ir) = r(7r) +, r v 
i(7ri), 
where r(. ) denotes the (common) reward function, r denotes the temperature pa- 
rameter, and vi is the smoothing function used by player i to calculate the smooth 
3.2. Stochastic flctitious plny 
best response fl- Note that, by the definition (1.5) of smooth best responses, 
f ri(., 7r-i) + 7Vv'(P'(7r-'))} -=0 for any C in the tangent spacc to A, and in 
particular for = *i. So 
d U(7r) V, 
iU(7r) * 7i Tt 
(r(., 
7r-') + rVv'(7r')) - 
(#'(7r-i) 
(-VV(pi(7r-')) + VVi(Iri)) - 
(, 8i(lr-i) 
By the strict concavity of the v' AU(7r) : 0 with equality only when 7ri = 
0'(7r-) 
for all i, i. e. when 7r is a Nash distribution. Thus -U is a Lyapunov function. 
For 2-player zero-sum games, define functions 
V'(7r) = r'(, 3'(7r-'), 7r-) + 7-v(, 
3'(7r-')) - r'(7r) - rv(7r) 
for i=1,2. Then 
d Vi(7r) =f r'(-, 7r-') + Tt di 
+ rVv(7r') 
r'(#'(7r-'), -) - r'(7r, 
By the definition of fl, f r'(-, 7r-') + TVV'(#'(7r-'))} - j"-tfli(7r-i) = 0, and as before dt 
r'(*, 7r-') - -, rVv'(P'(7r-i)) - iri. Therefore 
d Vi(7r) = 7. VVi(pi(7r-i)) _ 
VVi(7ri)) 7ri) ut 
7r-') -+ r(7r)) 
Thus taking V= Vl + V2 gives 
d 7ri), U-tV(7r) = 7' 
VVi(7ri)) 
since the game is zero-sum. Again, by the strict concavity of the V', ; 
4r,, V(7r) :50 
with equality only when 7r is a Nash distribution. 
Chapter 3. Smooth actor-critic algorithms 
We show that there is a unique Nash distribution for 2-player zero-sum games 
by sliowing that V is strictly convex, and so has a unique minimum. Since Nash 
distributions are necessarily minima of V the result will follow. Write 
V(7r) =V(7r) + V(7r) 
=rl (fll (72), 7r2) + 7'V'(, 31(7r2)) _ TV2 
(7r2) 
r 2(#2(7rl), 7rl) + 7. V2(#2(7rl)) - Tv'(7r') 
and defitic lVi(7r-i) = ri(fli(r-% 7r-i) +, r{v'(p'(7r-i)) - v-(7r-')}, so that V(7r) = 
IV' (ir 2) + IV2(jr 1). Now ri(, Oi(7r-i), 7r-i) + rvi(, 6'(7r-')) is convex, since it is the 
inaxinium over linear functions of ir-i, and v-(7r-') is strictly concave, so IVi(7r-i) 
is strictly convex in 7r-'. Therefore V(7r) is strictly convex in 7r, being the sum of 
two strictly convex functions of independent components of 7r. 
REMARK Although 11ofbauer and Hopkins (2000) claim that V is convex, their 
proof is incoinplete and does not take into the account the zcro-sum character of 
the gaine. Thus, if correct, their proof would show that all games have a unique 
Nitsh distribution (which is not truc-consider a simple 2x2 coordination game 
where each player gets a point when they play the same action and scores nothing 
otherwise). 
Corollnry 33 Under a stochastic fictitious play process in a 2-player zero-sum 
game, the strategies of the players will converge to the unique Nash distribution. 
In an N-player partnership game with finite or countably many Nash distributions, 
the strategies will converge to one of these Nash distributions. 
PROOF 1, " or a 2-player zero-surn game, the beliefs will converge with probability 
I to the unique Nintsh distribution. This follows immediately from Theorem 31, 
Proposition 21, and Theorem 32. Similarly, for an N-playcr partnership game the 
beliefs will converge with probability 1 to a connected set of Nash distributions 
on w1dch the Lyapunov function is constant. But in both cascs the strategies 
3.2. Stochastic rictitious play 
employed by the players are continuous functions of the beliefs, and the result 
follows by the definition of Nash distributions. 
REMARK Note that the strategies played, i. e. fli(ir-% do not necessarily follow 
the best response dynamics at all: Sato and Crutchfield (2002) give evidence to 
suggest that the strategies can follow a modified rcplicator dynamics. 
There are two classical examples of games for which classical fictitious play 
(1.6) fails to converge to equilibrium. Shapley (1964) proposed a modification of 
a rock-scissors-paper game, equivalent to the following: 
(010) (110) (011) 
(0,1) (0,0) (1,0) (3.2) 
(1,0) (0,1) (0,0) 
Jordan (1993) proposed a 3-player matching pennies game where each player can 
choose either heads or tails. Player 1 scores a point if they match player 2, player 
2 scores a point if they match player 3, and player 3 scores a point if they choose 
the opposite to player 1. The payoff 'matrix' is given by 
Player 3's choice: HEAD TAIL 
Player 2's choice: HEAD TAIL HEAD TAIL (3.3) 
Player 1's choice 
(1,1,0) (09090) (1,0,1) (09 1,1) 
T (0,1,1) (l 101 1) 
(0,0,0) (1,1,0) 
where an entry (rI, rl, r 3) gives the rewards to players 1,2 and 3 respectively. 
both of these games it has been shown that the unique Nash 
distribution is linearly 
unstable for the smooth best response dynamics with sufficiently small tempera- 
ture 7- > O-Cowan (1992) showed this for Shapley's game, while 
BcnaTm and 
Hirsch (1999) give the result for Jordan's game. Using 
Pernantle's result (Theo- 
rem 22) shows that convergence to the Nash distribution 
happens with probability 
zero for these games, and in fact an attracting limit cycle 
is present in both cases. 
Chapter 3. Smooth actor-critic algorithms 
3.3 A two-th-nescales learning algorithm 
We now present an algorithm that also results in an asymptotic pseudotrajectory to 
the smooth best response dynamics, but which does not require players to observe 
the actions of others, or to know the structure of the game. As already noted, the 
only reason players need this information is so that they can estimate the expected 
value of each of their actions in order to calculate the smooth best response. 
Heinrorcement learning is a model-free alternative for estimating expected values 
of a set of actions, although it relies on the fact that these expected values do not 
change with time. 
Assunic we have a stationary randorn environment where at each stage player 
i must choose an action ai from a finite set A, and associated with each action 
a' E& there is a random reward R(a') which has a fixed distribution and bounded 
variation. Consider the learning scheme 
Q,, (a') + Q,, (a')), for a'E A', 
where a,, is thcaction chosen at stage n, R. i is the subsequent reward, and 
is a deterministic sequence satisfying the standard conditions (1.15). It is well- 
known in the reinforcement learning literature (Sutton and Barto 1998; Bertsekas 
and Tsitsiklis 1996) that, provided each action is chosen infinitely often, the Q 
values in this algorithin will converge almost surely to the expected action values, 
i. e. 
as it -+ oo a. s. 
However in our multi-agent setting the players' strategies arc all changing si- 
inultaneouily as each player learns, and consequently the sampled rewards, Ring 
do not come from a stationary distribution. So when learning r'(ai, 7r-i) the stan- 
dard restilts no longer apply. A solution is to be found in Borkar's two-timcscales 
stochastic approximation (Bork-ar 1997), inspired by similar techniques used by 
Nonda and Bork-ar (2000) and Borkir (2001). Intuitively, if players update their 
3.3. A two-timescales learning algorithin 
Q values on a fast timescale, while adjusting strategies on a slow titnescale, then 
the Q values will give asymptotically accurate estimates of r(ai, 7r-i). Players use 
these asymptotically accurate estimates to adjust their strategies according to a 
smoothed version of the best-response adaptation procedure (3.1). 
Because players no longer play smooth best responses to strategies, but instead 
to perceived values, we will write 
argmax 1: 7r'(a')Q'(a) +, rv'(7r') (3.4) 
" 'EA' a'EAi 
Then 0'(ri(., 7r-i)) gives what would be expected (i. e. P'(7r-') in the previous 
notation). 
Actor-critic algorithm 
Each player i selects an action a' using the strategy 7r', then updates 7ri and nnn 
Q' according to n 
ii 7r +1 tin+1)7rn + /in+10i(Qi nn (3.5) 
Qn'+, (a') Q(a)+ An+11(ai , i)(R' - Q'(a')), 
for a'Eet', n n' nn 
where and are deterministic sequences satisfying the stan- 
dard conditions (1.15), and -+ 0 as n -+ oo. 
We consider the Q' process to be a critic process, assessing the value of the n 
current strategy, while the 7ri is an actor process, adjusting based upon information n 
provided by critic. The conditions placed on 
JAn}n2: 1 and 
(1Qn2: 
1 mean that Qf ' 
places greater emphasis on recent observations of r'(a, 7r-i) than on observations n 
from the distant past (as opposed to if An - I/n, in which cL-, c all observations 
would have equal weighting in the calculation of Q,, 
). This is a sensible thing to 
do, given that 7r-i is evolving. n 
Theorem 34 An interpolation of the strategies 7rn played during the actor-critic 
algorithm (3.5) is an asymptotic pseudoirajectorY of the smooth 
best response dy- 
namics (1.8). 
Chapter 3. Smooth actor-critic algorithms 
P110or Note that the Q values of any player will remain bounded, and so the 
strategies will stay in a region where 7ri (ai) is bounded away from 0 and 1. Take n 
these regions as our metric spaces for Theorem 23, and define 
F0)(7r, Q)' = 0'(Q') - 7r, for each i, 
F(')(7r, Q)(a') =7ri(ai) f r(a', 7r-') - Q'(a')} , for each i and a'. 
The conditions B1-B4 of Thcorem 23 arc met, and we must analyse the slow and 
fast ODEs (corresponding to (1.22) and (1.21)). The fast ODE is simply 
i(a')=7r'(a')fr'(a', 
7r-')-Q'(a')I, foreachianda', 
which, for fixed 7r has a unique globally asymptotically stable fixed point where 
Q(a') = ri(ai, 7r-') (since our metric space of definition excludes points where 
7ri(ai) = 0). Derining 
r-(7r) = (r' (-, 7r -'), ..., r 
7r-i)), (3.6) 
the conclusions of Theorem 23 statc that, with probability 1, IIQ,, - L(7r,, 
)110,, 
as n -+ oo, and an interpolation of the 7r,, is an asymptotic pseudotrajectory of the 
sciniflow induced by 
ir = F(1)(7r, r(7r)), or equivalently 
ir i= 7r' for each i. 
But this is simply the smooth best response dynamics (1.8). 
Thus we see that the actor-critic algoritlirn. (3.5) is asymptotically equivalent to 
the stochastic fictitious play algoritlim, in that both result in asymptotic pseudo- 
trajectories of the smooth bcst responsc dynamics. 
Corollary 35 Under the actor-critic algorithm (3.5) in a 2-player zero-sum 
94111C, the sirairgics of the players will converge to the unique Nash distribution. 
In an N-player partnership game with finite or countably many Nash distributions, 
the strategies will converge to one of these Nash distributions. 
3.3. A two-timescales learning n1gorithm 
PROOF This proof is exactly the same as that of Corollary 33. 
However, the instability of the Nash distribution of Shaplcy's game (3.2) and 
of Jordan's game (3.3) under the smooth best response dynamics still presents 
difficulties. While it seems reasonable that an analogous non-convergencc result 
to Theorem 22 should hold in this case, this noise is only present on the fast 
timescale; given (7r', Q' ) the update to 7r' is deterministic, and so the probabilistic nnn 
estimates used by Pernantle are not valid in this case. However the presence of 
an attracting orbit in each case means that, by a simple extension of the results 
of BenaYrn (1999) discussed in Section 1.3, the probability of convergence to the 
equilibrium is less then 1. 
REMARK We could modify our algorithm so that at time n player i selects a 
random action to reinforce, using #'(Q') to select this action. Thell tile update n 
to 7rni will be random, as in stochastic fictitious play, and Theorem 22 will hold. 
However, it is not clear that introducing this extra level of randomness will improve 
the convergence properties of the algorithm, and indeed it seems likely that a 
slightly more sophisticated approach to the problem of non-convergence to unstable 
fixed points will provide the required result. 
Despite these non-convergcnce results, the following is true: 
Theorem 36 If the actor-critic algorithm (3.5) converges to a furd point 
9 7rn) -+ 
(0, fr) as n -+ oo 
then '(ai) = r'(a', fr-') and Fr is a Nash distribution. 
PROOF It is a basic result of stochastic approximation theory, and essentially 
a law of large numbers, that if convergence occurs then the limit point must be I 
zero of the associated ODE. it follows immediately that 
'(a') = r'(a', ir-i), and 
= Fri. Thereforc fr' = 
Chapter 3. Smooth nctor-critic algoritlims 
3.4 Symmetric games 
We can study a very similar process in symmetric games. Essentially we assume 
that a population maintains a set of Q values, while adapting more slowly than 
the Q values are updated. There are (at least) two possible motivations for this 
model: 
Model 1: Each individual of an infinite population plays a pure strategy. The 
population state at time n is r,,. A random individual, who uses action a,,, 
is selected to play the game, and receives reward r(a,,, 7r,, ). Each member of 
the population observes this, and adjusts Q(a,, ) towards the newly observed 
value using 
Qn+i(an) -- (I - An+I)Qn(an) + An+, 
r(a, 7rn)- 
Also, a fraction it,, of the population will switch their strategy, selecting a new 
strategy using a smooth best response to the current estimates Q,,. This is 
similar to a stochastic fictitious play interpretation used by Hopkins (1999). 
Model 2: Players join a game at distinct time points, choosing an action as they 
join and using that action for all time. As a player enters the game, they 
receive a reward depending on their choice of action and the state of the 
population already playing the game. Players not yet participating in the 
gaine observe the rewards of players as they enter, and maintain Q values 
in the usual fashion. When a player enters the game, they select an action 
using a smooth best response to the current Q values. This is similar to the 
symmetric stochastic fictitious play model of 11ofbaucr and Sandholm (2002). 
In cach case, the Q values and population states evolve according to 
7r, +1 22 7rn + /In+1 
(fl(Qn) 
- 7r, + Unj 
Q,, +I (a)= Q,, (a) +A,, +, {r(a, 7r. ) - Q,, (a) + U, 
2, I for each aEA. 
3.4. Symmetric gnines 
In Model 1, the U, 1, are identically 0, since the infinite population size renders 
the population adjustment deterministic. In Model 2, /i,, +l = Iffii + 1), since 
the population state is simply the average of the actions previously selected. A 
second difference is the (effective) mixed strategy actually played at any particular 
step. Under Model 1, the player is selected from the population, and so the mixed 
strategy is cffectivcly 7r,,. On the other hand, under Model 2 the player joining 
selects an action according to P(Q. ). Ilowcvcr, since the reward to the player 
depends on the population state 7r,, in both cases, the analysis is identical. 
As with our actor-critic learning algorithm (3.5), we take and (14. }. >, 
to be sequences satisfying the standard conditions (1.15), but also with -+ 0 
as n -+ oo. Again, this means that recent observations of r(a, 7r. 
) have more 
influence on Q,, (a) than distant observations. 
Proposition 37 An interpolation of the population states under cither. 1fodel I or 
Afodel 2 is an asymptotic pseudotrajectory of the symmetric smooth best response 
dynamics (1.8). 
PROOF The proof of this proposition is directly analogous to that of 
Theorem 
11ofbauer and Sandholm (2002) study the symmetric smooth best response dy- 
namic, motivated by a study of symmetric stochastic fictitious play. Since stochas- 
tic fictitious play also results in asymptotic pseudotrajectories or the smooth 
response dynamic, they investigate the chain-recurrent sets, As well as the classes 
of games we specified in Section 1.1, they consider supermodular games, for 
which there is an ordering on the actions such that 
for a' > a, V>b we have 
r(a', Y) - r(a, bl) > r(a', b) - r(a, 
b). That is, when one player moves to a 'higher' 
action the incentive for the other to also switch to a higher action increases. 
Theorem 38 (Ilofbauer and Sandholin 2002) Consider the smooth bcst re- 
sponse dynamics (1.8). The following is truc: 
Clinpter 3. Smooth -actor-critic algorithms 
1. for zero sum games there is a unique Nash distribution Fr, and Jr} is the 
unique chain-recurrent set, 
for gamcs with an interior ESS there is a unique Nash distribution i, and 11 
fi} is the unique chain-recurrent set, 
S. for partnership games with isolated Nash distributions, any connected, inter- 
nally chain recurrent set is a Nash distribution. 
In fact it is shown by Ilofbauer (2000) that the first two classes are special cases 
of the class of ganics for which the rewards are given by a matrix U= (Uab)) with 
r(a, b) = u. b and 
: CTUC: 5 0 V ER0 {C ER Eci = 0}, 
and that the conclusion for those two classes continues to hold for this wider class. 
Theorem 39 Under Afodcl I or Model 2, the population state will converge to a 
Nash distribution in any of the following classes of games: 
1. zcy-o-. gum gaincs, 
. 0. gamus with an inicrnal ESS, 
S. partnership games with isolated Nash distributions, 
Pitoor For all of these classes, any cliain-recurrcnt set is a Nash distribution, 
and so by Proposition 37 and Theorem 20 the rcsult follows. 
3.5 A numerical example 
In t1lis section we illustrate Model 1 using a simple rock-scissors-paper game, with 
payofr inatrix 
0 1 -1 
-1 0 1 
1 -1 0 
3.5. A numerical example 
o+OO 1 045 2 045 3 o+OS 4 @+OS 5 @+OS 
0 o+OO 1 045 2 045 3 @+OS 4 @+OS 5 #+OS 
U-0 0.2 0.4 0.6 0.8 1.0 
7r(R) 
0 0+00 1 9+05 2 io+05 3 *+05 4 *+05 5 *+OS 
Figure 3.1: Continuous clockwise cycling of strategies (left) and non- 
convergence of Q values to r(., ir) (right), using A. = p,, = n-0-8. 
We use this model because the dimensions arc smaller than with the actor-critic 
algorithm of Section 3.3 (since there is cffcctivcly only one playcr) and so visu- 
alisation is simpler. The experiments will demonstrate the need to use separate 
learning parameters for Q and 7r for this game. 
Boltzmann smooth best responses (1-16) were used, with temperature parameter 
= 0.2. In each case the experiment was run for 5x 10' iterations, starting at a 
random start point. Points were plotted every 50 iterations. 
In the first experiment A,, = it,, for all n, resulting in a single-titnescalestochastic 
approximation. The results are shown in Fig. 3.1. It is clear front tile left hand 
diagram that the strategies persistently cycle clockwise in this case. Of more 
interest arc the diagrams on the right, comparing the current estimates of the 
values, Q, with the calculated current value of the actions, r(-, 7r). In each diagram 
the Q value is plotted in black while the calculated value is in grey. It is clear that 
the Q values cannot 'keep up' with the calculated values, which adjust at the sanic 
Chnpter 3. Smooth actor-critic algorithms 
0 o+OO 1 945 2 e+05 3 e+05 4 e+05 5 e+05 
(A c 
0 e+OO 1 e+05 2 e+05 3 e+05 4 945 5 e+05 
0 e+DO 1 e+05 2 e+05 3 e+05 4 e+05 5 e+05 
0.0 0,2 0.4 0.6 0.8 1.0 
W(I? ) 
Figure 3.2: Convergence of strategies in a clockwise spiral (left) and con- 
vergence of Q values to r(., 7r) (right), using A,, =n -0.7, it" = n-1. 
rate as the population state 7r. Tile 'stretching' of the process as n increases in 
these plots is due to the fact that as n increases the learning parameters decrease, 
and so the processes adjust more slowly. 
For the second experiment we introduce our second timescale, so that the Q 
values update on a faster timescale than the population state. There is a significant 
change in the diagrams. The left ]land diagram in Fig. 3.2 shows a convergent 
trajectory (although after 5x 101 iterations it has not yet fully converged). Again, 
of inuch greater interest is the right ]land set of diagrams. In each case it is clear 
that the Q value tracks the calculated value r(-, 7r) very closely indeed (again the Q 
value is plotted in black whereas the calculated value is in grey). This corresponds 
to the result saying that IIQ,, - Ar,, 11 -+ 0 as n -+ oo. 
These two experiments suggest that for this particular game the use of two 
tiluescales is necessary to allow the Q values to successfully estimate r(-, 7r). For 
3.0. Conclusion 
simpler games, such as the Hawk-Dove game (11ofbauer and Sigmund 1998), with- 
out an inherent cycling of the strategies under the smooth best response dynamics, 
the use of two timescales proves to be unnecessary. 
3.6 Conclusion 
In contrast with the model of the previous chapter, we explicitly addressed tile 
relationship between rewards and actions, by using separate value functions and 
policies in an actor-critic algorithm. Wc used two-timescales stochastic approx- 
imation to let players learn the values of actions, and then mapped these value 
estimates to policy space using the smooth best response function (3.4). Tile poli- 
cies adapt towards this smooth best response on the slow timescale, and it follows 
that the value estimates are asymptotically accurate. This in turn means that 
our process results in asymptotic pscudotrajectories of the smooth best response 
dynamics (1.8), and should it converge to a fixed point then that fixed point will 
be a Nash distribution, as opposed to a Nash equilibrium. 
Therefore our process has similar properties to stochastic fictitious play 
(Puden- 
berg and Kreps 1993; BenaYm and Hirsch 1999; Ilofbaucr and Sandliolm 2002). 
By combining results from the literature (BenaYm and Hirsch 1999; llofl)auer and 
Hopkins 2000; Leslie and Collins 2003) we showed that stochastic fictitious play 
converges in a larger class of games than has been previously stated (Corollary 
33). The same result shows that our actor-critic algorithm must converge to Nash 
distribution in all the same games that stochastic fictitious play will converge, 
despite each player using less information-undcr stochastic fictitious play each 
player must be able to observe the actions played by the others, and to calculate 
the value of their actions using this information, while under tile actor-critic al- 
gorithm each player need only observe their own reward each time they play an 
action. 
Two models of evolution of a population in a symmetric game were also con- 
Clinpter 3. Smooth actor-critic algorithms 
sidered, and again the convergence results are the same as those obtained for 
symmetric stochastic fictitious play (11ofbauer and Sandholm 2002). 
A numerical example was given to show that the separation of learning param- 
eters between the learning of the Q values and the adaptation of the strategies 7r 
is necessary to allow Q,, to be an accurate assessment of r(-, 7r,, ), and therefore for 
the strategies to converge. 
However, the two classical examples for which fictitious play does not converge 
(Shapley's game (3.2) and Jordan's game (3.3)) still present problems. It has been 
shown (Cowan 1992; Ilcndim and Hirsch 1999) that a limit cycle is attracting for 
these games, and so convergence to equilibrium cannot be guaranteed (indeed it 
seems likely that the probability of the actor-critic algorithm (3.5) converging to 
equilibrium is zero, but this has not been shown). In order to break the symmetry 
between the players that causes this cycling behaviour, we will extend the actor- 
critic learning algorithm in the next chapter. 
Chapter 4 
Multiple timescales 
The non-convergence of the actor-critic algorithm (3.5) in certain games Motivates 
a further extension. Littman and Storie's work (2001) suggests the consideration 
of 'leaders' and 'followers'; this can be achieved by studying players that leun at 
different rates. To analyse these players requires an extension of BorLar's result 
(Theorem 23) beyond two timcscales. 
Much of this chapter will appear in Leslie and Collins (2003). 
4.1 Stochastic approximation With multiple 
timescales 
Consider N interdependent stochastic approximation processes 0n('),..., 0, 
(, N), each 
lying in a metric space (AP), d(')), which are updated according to the rules 
n(N) n+j n n+j .) 
where, for each i, the conditions BI-B4 of Theorem 23 hold. In addition we 
assume that 
AW n- -+ 0 as n -+ oo whenever i<j. AU) n 
This final assumption is what makes the algorithm inultiple-tiniescale. Write 0. 
O(N)); 
nn in the sequcl it will also be convenient to write OV') for the vector 
Clinpter 4. Multiple tiniescales 
(0(1), 
... $0($, -'. 
We follow Bork-ar (1997) in establishing a different timescale corresponding to 
cach process. ror i, iE1, ..., N 
k sup{n 
and let O(i, j)(t) be the interpolation of the process On(i) on the jth timescale, i. e. 
+ a) =0 () +9 (0(') 1- 0(')) for 0<s< 
n n+ n n+I* 
7. n('+ I 
We start by considering the Nth timescale, and the interpolations on this 
tirnescale O(idv)(J). Rewritc the stochastic approximation processes (4.1) in the 
o(i) - o(i) + A(N) 
i, N) i<N, 
n+I " n n+ 1 
O(N) = O(N) + A(N) 
(N) (on) + Un(N) 
n+I n n+I 
wherc for i<N wc have implicitly defincd 
AW (i, N) +1 U., 
+I A(N) 
(F()(0,, ) + b,, + I). 
For i<N, and any ri, 
1: A (N) 
k=n+ M(N)(, r(N) + T) (4.2) Sul) 
E, \(N) 
(N) + T) 
A'(+' (F(') (01) + Un(') 1 k=n+l, ..., M(N)(, r, Sul) I+ I T(-N) +n 
I=n 1+1 
M(N)('r'('N)+T) 
'\(N) sup 
I k-+' 
11 F(')(OA: ) 1+1 
k>n+l A(N) Inn k+I 
,,..., M(N)( 
(N) + T) + sup A0, Uj')j :kn+ rn 
As n -+ oo the second term converges to zero, by assumption B4 and the 
fact that 
m(N)(j) :5 00(t) for sufficiently large t (since rn(') < rA for sufficiently large n). 
A(i)IA(N) 
kk -+ 0 while F(i)(0k) is bounded and, from the 
definitions Of tn and 
1+1 - T. 
4.1. Stochastic approximation with multiple timescales 
Therefore the limit of the quantity (4-2) as n -+ oo must be zero. Taking 
A('V'N) 
n we see that 
A(N)[j(i, N) (N)(T, (N) lim sup k=n+l,..., m +T) =0 n-oo E 11 I=n 
for all i. Thus Proposition 17 shows that the interpolations 0(*-J)(i) are asymptotic 
pseudotrajectories of the serniflow induced by the differential equations 
k(')=O for i<N 
(N)(X) 
At this point we need to make the following assumption: 
(4.3) 
A(N) There exists a Lipschitz continuous function (N)(O("-N)) such that, for 
any initial conditions (0(<N), O(N)), trajectories of the differential equations (1.3) 
converge to the point (0(<N), C(N)(O(<N))). 
It therefore follows from Proposition 21 that tile possible limit points of an asyrnp- 
totic pseudotrajectory to the serniflow induced by (4-3) arc the set of all points 
(0(<N), (N)(O(<N))), 
where 0(<N) can take any value. In terms of our stochastic approximation pro- 
cesses, 
l_ (0(<N), (N) (0(<N))) 11 ion 
nn -+ 
0 as n -+ oo a. s. 
Now consider the timescale corresponding to r, 
(, N-'), and the interpolations 
0(i. N-1)(t) for i<N. Rewrite the stochastic approximation processes (4.1) in 
the form 
0(') =0(i)+A(N-')-('IN-1) for i<X-I n+l n n+l 
Un'+l 
O(N-I) = 0(N-1) + A(N-1) (0, 
(, <N), (N) (0( <N))) + &"(N- I. N- 1) 
n+l n n+l 
, (i. N-1) and The implicit definition of Un'+l for i<N-I is equivalent to ti, at or u. t, 
so we can proceed as before. On the other hand we have implicitly defined 
U Cj, (N -1) - 
(N-1)(O") (N-1)(O, (, <NQ(N)(O(<N))) + Un(N-') 
, +TI, 
n n' +FF +1 
Clinpter 4. Multiple tiniescales 
However, we have already shown that as n -+ oo 
(0(<N), (N)(O(<N))) 0, lion 
and wc havc assumed that F(N-1) is Lipschitz continuous, so 
(N- (N-1)(O(<N), C(N)(O(<N)))jj _+ 0. 
JIF 1)(0n) 
Thereforc 
(N-1) -i, N-i) 
&1(+N 
k=n + rn(N n+ T) 
m(N-1)(, r, 
(, N-')+T) 
< A(N-1) SUP 
JIF (N-)(on) F (N-1)(O(<N), C(N)(O(<N))) 1: 
k>n+l I=n 
A (N - 1) Ul(+N - 1) 
I rn(N- 
1) (7, ( N- 1) 
sup J k=n+ + T) 
(N-1)(7(N-')+T) 
A(N-1) 
and again (since Elm=n n 1+1 ;  T) we see that 
lim sup A(N-1) 
N-1) k=n+1,..., m 
(N-1)(r(N-1) + T) 
n-+oo 
1+1 n 
for i=N-1, and so the interpolations E)(<NN-1) (t) are an asymptotic 
pseudotrajectory of the flow defined by the differential equations 
(')=O for i<N-1 
(4.4) 
F (N-1) (X(<N), (N)(X(<N))) 
We, need to inakc an assumption analogous to A(N) above: 
There exists a Lipschitz continuous function 
C(N-1)(O(<N-1)) 
that, for any initial conditions (0(<N-I)'O(N-1))' trajectories of the differential 
equations (4.4) converge to the point 
(0(<N-1Q(N-1)(O(<N-1))). 
Derilling 
E(N_1)(O(<N_1)) = (e(N_1)(o(<N_1)), 
(N) (o(<N1), (N_1)(o(<N_1)))) 
4.1. Stochastic approximation with multiple timescales 
it follows that 
(0(<N-1) =(? N-1)(O(<N-1)))Il -+ 0 as n -+ oo a. s. n I- n 
We proceed recursively for each j>2, rioting that the interpolated processes 
E)("'j+', j) are asymptotic pseudotrajectories of the scmiflow induced by 
k(')=O for i<j 
(4.5) 
For each j>2 we need to make the assumption 
A(j) There exists a Lipschitz continuous function M(0(0) such that, for 
any initial conditions (0('j), O(j)), trajectories of the differential equations (4.5) 
converge to the point (0(<j), (j)(O(<j)))- 
Then defining 
, =(?: i)(O(<j)) = 
(o(<j)Xj)(O(<j))) )v 
it follows that, for 2<j<N, 
as n -+ oo a. s. 
Finally, it follows that on the slowest timcscale the interpolated process 00-1)(i) 
is an asymptotic pseudotrajectory of the scmiflow induced by 
V') = F(') 
(X(I), =(2: 2)(X(l) 
We have therefore proved the following theorem: 
Theorem 40 Consider a multiple-timescales stochastic approximation proccSs 
(4.1). If assumptions A(2)-A(N) hold then, almost surely, 
=(22) 0 as 11 -+ 00 
and a suitable continuous titne interpolation of the process 
{0, 1)}, qo is an asymp. 
totic pseudotrajectory of the semiflow induced by the ODE 
.k= F(l)(X, -: 
(42)(X)) 
Chapter 4. Multiple timescales 
4.2 A multiple-timescales actor-critic algorithm 
Theorem 40 allows us to consider a learning algorithm where the players adapt 
at different rates. We will modify the actor-critic algorithm (3.5) to assume 
that all players update their strategies on strictly different timescales, and all of 
these timescales are slower than the rate at which the Q values are learned. The 
algorithm is as follows: 
Mul tip] c-timescales actor-critic algorithm 
Each player i selects an action a' using the strategy 7ri, then updates 7r' and nnn 
n according to 
7rn+l /in+1)7rn + lln+lfli(Qin) 
(4.6) 
n+t(a')=Qin(ai)+An+ll(etil=ail(R'n-Q'n(a')), 
fora'EA', 
where and Ilif arc deterministic sequences satisfying the stan- n 
(lard conditions (1.15), and pi /A,, -4 0 as n -+ oo. Furthermore, /in/Pjn n 
whenever i 
As before, It,, is the reward obtained by player i at step n, and 3'(Q') is player n 
i's smooth best response given the value estimates Q'. The last condition sa s ny 
that each player is adapting their strategy on a different timescale (although all 
players still learn the Q values at the same fast timescale). 
The first thing to note about this algorithm is that the same argument as for 
the simple actor-critic algorithm (3.5) will suffice to show the following. 
Theoreni 41 If the multiple-timescales actor-critic algorithm (4.6) converges to 
a fixt-d point 
9 7rn) -+ 
(, fr) as n -+ oo 
then ('(ai) = r(ai, fr-) and fr is a Nash distribution. 
However to use Theorem 40 we need to check that assumptions A(2)-A(N) 
4.2. A multiple-tiniescn)es actor-critic algorithm 
are satisfied. We start by noting that the ODE for the Q values, 
d Q'(a') = 7r'(a) I r'(a', 7r Q'(a) for all i, a, it 
has a unique globally attracting fixed point Q=1: (7r) (recall definition (3.6)). 
The remainder of our analysis will assume that the Q values are accurate, and so 
smooth best responses are taken with respect to opponent strategies (as opposed 
to Q values). It is also clear that the ODE 
N=_ 7rN 9 
for fixed 7r<N = (7r',. .. 7r 
N-1), has a globally attracting point, #'V(7r"N), so the 
assumptions A(2)-A(N) may fail only for intermediate players that are not tile 
fastest or slowest (no assumption need be made about the slowest timescale). 
Assumption C For each i=2,..., N-1 there exists a Lipschit: furiction 6' 
such that b'(7rl,..., 7r'-) is the globally asymptotically stable rquilibrium poird of 
the ODE 
ir' = 0' 7r' 
where we recursively define 
pN(7r: 5(N-1)) 
(b'+'(7r: 54), B>(4+1) (7r: 5', b4+'(7r5i))1 
Effectively this will tell us that, for any i, if we fix the strategies for players 
i then almost surely 
>i 7rn -+ B>4(r"). 
This convergence assumption is fairly restrictive, although it doe-S not prevent 
the application of this algorithm to several different games (see Sections 4.3-4.4 
below). It allows us to use Tlicorcm 40 to charactcrisc the mymptotic bchaviour 
of the algorithm (4.6). 
Chapter 4. Multiple timescales 
Theorcin 42 Under Assumption C, the strategies 7r,, played during the multiple- 
tirnescales actor-critic algorithm (4.6) satisfy 
(7r 2 N) 
_ B"'(7r')Il -+ 0 as n -+ oo a. s. n) 7rn n 
and a suitable continuous time interpolation of the 7r, ', is an asymptotic pseudotra- 
jectory of Me sciniflow induced by Me ODE 
P= Pl (B>1(7r')) - 7rl 
P1100P Since the Q' (ai) -+ ri(a', 7r-') whenever 7r is fixed, the proof is imme- n 
diatc from Theorem 40 and Assumption C. 
This result means that to analyse the multiple-timescales algorithm in a partic- 
ular game, or class of games, it suffices to show that Assumption C is satisfied and 
to analysc the behaviour of the slowest player under the assumption that all other 
players play the strategy dictated by the function Y". 
REMARK We can consider this system as relating to a multiple-timescales 
singular perturbation of the smooth best response dynamics: 
P=e (1)01(7r-1) 
irl = C(2) 
(02(7r-2) 
_ 7r2) 
irN = 7rN) 
with c(i) = o(c(i+l)) as e(i) -+ 0. Consideration of this system may indicate 
how to 
relax Assumption C. 
REMARK It is a trivial extension to this algorithm to consider a setting where 
the players also learn tile Q values at different rates to each other. If we assume 
Qi i) +, \i n+ (a = Q' (a') n+ II 
(ai =ai)(R' - Q'(a')), nnnn 
4.3. Two-player games 
then all that is required is for p'/A' -+ 0 as n -+ oo. This is because the malues nn 
Q' only have any direct bearing on the strategy 7r' of player i. The condition 
pf /A' -+ 0 corresponds to the players being 'cautious', in that they will adapt their nn 
strategy more slowly than they will adjust assessments of the values of actions. 
4.3 Two-player games 
It is easy to see that for 2-player games Assumption C is vacuous, since there are 
no intermediate players (each player is either the fastest or tlic slowest). Thus it 
is sufficient to analyse the ODE 
irl = pl(#2(7rl)) - 7rl (4.7) 
We have a positive convergence theorem for two major classes of 2-player games: 
zero-sum games and partnership games. 
Proposition 43 For both 2-player zero-sum games and 2-player partnership 
games the ODE (4.7) admits a Lyapunov function 
for the set of Ash distribu. 
tions. 
PROOF For zero-sum games consider the function U(7r') = rl(7r,,, 
O, (7r, )) + 
rv'(7r') - rv'(P'(7r')). Wc sec that 
jr'(-, P'(7r')) + rVv'(7r) dt 
f+ VVI(7r, )) - 
10V 2 (7r I )) 
- 7rl 
+ VV2(#2(7rl))) ad, 
02(jrl). 
r'(7r', -) di 
By the definitions of the smooth best responses, the second term 
is 0 and dlU(rl) 
0 with equality only at Nash distributions. So -U(7rl) is a Lyapunov 
function for 
the set of Nash distributions. 
For partnership games consider the function 
V(7rl) = r(7rl, 02(7r')) + 7v'(7r') + 
Chapter 4. Multiple timescales 
Tv'(P'(7r')). Again 
d V(7r') = 
fr(.,, 8'(7r')) + rVv'(7r') irl +f r(7r', + TVV2(02 (7r')) _4_02 
(7r') T, dt 
{_VVI(pl(#2 (7rl))) + VV'(7rl)l ,f pl 
(02 (7r I )) 
- 7rlJ 
and so -V(7r') is a Lyapunov function for the set of Nash distributions. 
Corollary 44 Under the multiple-timescales actor-critic algorithm (4.6) in a 2- 
player zero-sum game, the strategies of the players will converge to the unique Nash 
distribution. In an N-player partnership game with finite or countably many Nash 
distributions, the strategies will converge to one of these Nash distributions. 
P110or The proof of this corollary is immediate from Theorem 42, Proposition 
43, and Proposition 21. 
Thus we have asymptotic convergence results which are comparable to those for 
smooth fictitious play, and for our simple actor-critic algorithm (3.5). However a 
proof of convergence for general N-playcr partnership games is not available, since 
in this framework it is likely that for a fixed strategy of the slow players there will 
be several equilibria to which the fast players may converge, and Assumption C 
will riot be satisfied. 
4.4 Some difficult games 
We now consider the inultiplc-timcscalcs actor-critic algorithm applied in the two 
classic examples of difficult games for learning algorithms: the Shapley game (3.2) 
and the 3-player inatching pennies game (3.3). We start by proving convergence 
of our algorithm in a generalisation of the latter game, then show convergence of 
our algorithni for the Shapley game. 
4.4. Some difficult games 
Co - _ci 
0 e+OO 1 e+06 2 946 3 e+06 4 e+OO 5 o+OO 
-6 tiz Nt 
lxwvvm_ 
0 9+00 1 e+06 2 9+06 3 9+06 4 9+06 5 o+08 
e+OO 1 e+OO 2 o+OO 3 o+OO 4 o+OO 5 o+OO 
Figure 4.1: Non-convergent strategies in the 3-player matching pennies 
game, over 5x 105 iterations of the single-timescale actor-critic algorithm 
(3.5), using Boltzmann smoothing (r = 0.1), with A. = (n + 100)'55 and 
p,, = (n + 100)-0.8. 
4.4.1 N-phaycr matching polillies 
Our generalisation of Jordan's game (Jordan 1993) is the N-player matching pen. 
nies game, in which each player can choose to play 'heads' (11) or 'tails' (T) and 
the reward to player i depends only on the actions a' and ai+', where i+I is 
calculated modulo N. The reward structure is 
r' (9) = l(ai=ai+l) for iN-1, 
(4.8) 
rN( a) = l(aNi4al)- 
The cyclical nature of this game allows the easy verification of Assumption C. 
As long as player 1's strategy is fixed then player N's strategy will converge to 
pl(7r-N) since this only depends on 7r'. Similarly, under the assumption that 
player one is fixed and player N has calibrated, it is clear that player (A' - 1)'s 
Chapter 4. Multiple timescales 
0 o+OO 1 e+06 2 e+06 3 e+06 4 e+06 5 e+06 
0 0 e+OO 1 e+OO 2 e+06 3 e+06 4 e+06 5 e+06 
0 o+OO 1 946 2 948 3 946 4 e+06 5 e+06 
Figure 4.2: Convergent strategies in the 3-player matching pennies game, 
over Sx 10" iterations of the multiple-timescales actor-critic algorithm (4.6), 
100)-0.55' 111 using Boltzmann smoothing (r = 0.1), with A,, = (n +n 
(14 + 100)-1, j12 
(n + 100)-0-8 and p3n = (n + 100)-o-6. 
strategy will converge to P N-1(7r-(N-1)), since this depends only on 7rN = #N( 7r-N) 
which is fixed. This is repeated, so that whenever player 1's strategy is fixed the 
strategies of the faster players must converge to the unique best responses. By 
Theorem 42 it suffices to consider the ODE 
irl = iol(#2(... 
(, ON(7rl)) 
- 71. 
Assume that the smooth best responses are monotonic in the payoffs i. e. r'(a') > 
ri(b') = #'(ri)(ai) > fl'(ri)(bi) (a sufficient condition for this to be the case is for 
each smoothing function vi to be invariant under permutations of the actions). 
Thus if 7r'(Il) > 1/2 we must have Plv(7r')(II) < 1/2 and so, in turn, 
pi(pi+l( (ON(7ri)) ))(11) 1/2 
4.4. Sonic difficult ganies 
for each i=1,. .., N. So for 7r'(II) > 1/2 it is the case that irl(II) < 0. Similarly 
if 7r I (II) < 1/2 then irl(II) > 0, and so it follows that the Nash distribution 
7r'(II) = 1/2 is a globally attracting fixed point. Therefore the strategies under the 
multi ple-timescales actor-critic algorithm will converge to this Nash distribution. 
REMARK We have shown that the multi ple-ti mescaics algori t1i m (4.6) wi II coll- 
verge almost surely to the Nash distribution of the matching pennies game provided 
that learning rates of the players are ordered in the same way as the players are 
ordered in the game. In fact it is not difficult to see that this specific ordering is 
unnecessary, and any ordering of the players will suffice; see Section 4.5. 
We conclude our discussion of the N-player matching pennies game with Sam. 
ple learning trajectories, shown in Figs. 4.1 and 4.2. As predicted by Theorem 3.1, 
in conjunction with the results of Benajm and Hirsch (1999) on the smooth best 
response dynamics in this game, the single-timcscale algorithm (3.5) cycles persis- 
tently (Fig. 4.1). However, the multipic-tiincscales algorithm (4.6) is converging 
slowly towards the Nash distribution where 7r(11) = 1/2 for each i (Fig. 4.2). This 
is in agreement with the theoretical results of this section. Also visible in Fig. 4.2 
is the different behaviour of the three players. Player 1, with learning parameters 
that decrease quickly towards 0, does not adjust 7r' very rapidly. However, player 
3, with slowly decreasing learning parameters, displays behaviour with a fairly 
persistent level of stochasticity, although ir 3 is always close to being a sinooth best 
response to 7rl (not evident from the plot). 
4.4.2 Shapley's gaille 
Shapley's game (3.2) is a 2-player game, where each player hai three actions. A 
player gets a point if their opponent plays an action I greater (modulo 3) And gets 
no point otherwise. Without loss of generality (due to the symmetry or the game) 
we assume that player I is the slower, and since it is a 2-player game Assumption 
ClinPter 4. Multiple timescales 
C is irrelevant (as observed previously). So we simply need to analyse the ODE 
ir I= pl(p2(7rl)) 
_ 7rl. (4.9) 
Note 7r'(3) =1- 7r'(l) - 7rl(2), so that this defines a planar serniflow. Therefore if 
the divergence of the sciniflow in (70(1), 7r'(2))-space is negative then the solutions 
of the ODE must converge to a fixed point. 
ror simplicity we assume that players use the Boltzmann distribution (1.16) for 
their smooth best responses. It follows that 
8'(7r-' .) (a) elr-' 
(a+I)Ir 
e7r-(al)/, r 
Deri nc p(n) = (7r I (a) - 7r 1 (3)) /-r for a=1,2, and let 
2= p2 (7r 1) =I- (e p(2) 1 eP(')). (4.10) 
1+ ep(l) + ep(2) 
By the chain rule applied to (4.9), 
Div =2 
okl(a) 232 gpl(7r2) (a) 0jr2 (a') (9p(b) E 
Or I (a) =EEE 07r2(al) (9p(b) (97r'( a=l a=l al=l b=l 
so to calculate the value of this sum we first calculate the component partial 
derivatives: 
(9p I (7r2) (a) c 
W2(, '), r (I(al=a+t) EVEA elr' 
(b')/, r 
0jr2(al) 'r (EVEA e 
ff2(bl)/7) 
Or 2 cp(l) + DIP(l) 
+ Cp(l) + ep(2))2 
00 ep(2) 
- (I + e"(1), -eP(l) Dp(2) + Cp(l) + ep(2))2 
Op(b) 
(I + Dir I (a) 
where the last derives from the fact that ? r'(3) =1- 7r'(l) - 7r'(2) and so 
(21rl(l) + 7r'(2) - 1)/r, p(2) = (7r'(1) + 27r'(2) - 
1)/7-. 
4.4. Some difflcult games 
Substituting all of these into the expression for the divergence, wc get that 
jr2(a)/, r + e, 
(I) + e., 
(2))2 
x (Div + 2) 
lr2( ')/Te jr2(2)/r(, p(l) c p(2) - 2cOM - 
2Cp(2)) 
e jr2(2)/reT2(3)/r(ep(2) - 2cO(l) - 2cP(l 
)e(2)) 
2(, )I, 
2(3)/r(Cp(l) 
- 2cP(2) - 2c"(')c, 0(2)) 
Recalling the expression (4.10) for 70, this shows that 
Ee ff2(a)/, r x (Div + 2) 
= eff 
'(')Ire 7r2(2)/r j7r 2( 1) 7r 2 (3) - 27r2(2)7r2(3) - 27r 
2( 1)7r"(2)) 
+ ir2(2)/, r e ir2(3)/, r {7r2( 1)r2(2) - 27r 
2 (2) 7r2 (3)-2 7r2( 1)7r 2 (3)) 
+e ff2(1)/, r, 7r2(3)/, r f 7r 2 (2) 7r2 (3)-2 7r2( 1)r 
2 (2) - 21r2(1)ir 
2 (3)) 
This expression is invariant under a cyclical permutation or actions, so without 
loss of generality we can assume 7r' 
(1) :5 7r2 (3) and 7r2(2) < ir 
2 (3). Initially we 
assume further that 7r 2(j) < 7r'(2) :5 7r 2(3), so that 
2( 1) 7r2 (3)-2 r2 (2) jr2 (3) - 
27r2(1)ir 2 (2) < 0, 
7r2( 1) 7r2 (2) - 
27r2 (2)ir2(3) - 21r2(1)r2(3) < 
If 7r2 (2)7r2 (3) - 
27r2(1)7r2 (2) - 
27r 2( 1)ir 2 (3) <0 we are done. Otherwise 
ew2(1)/Irelr2 
(3)/r {ir2(2) 
7r2 (3)-2 7r2( 1)7r2(2) -2 7r2 
(I )7r2(3)) 
7r2(2)/rew2(3)/r {7r2 (2) 7r2 (3) - 
27r2(1)7r 2 (2) - 21r 
2(l ) ir2(3) ), 
and the expression in (4.11) is bounded above by 
, lr2(1)/r. 7r2 
(2)/7- f7r 2( 1) Ir2 (3)-2 7r2 (2)ir2(3) -2 7r2(l 
)7r2(2) ) 
+ tr2(2)/rr2(3)/, r I -7r 
2( 1 )7r2 (2) - 7r2(2)r'(3) - 4x'(1); r2(3)) , 
which is clearly negative. A similar argument works with the assumption 7r2(2) :5 
7r'(1) :5 r2 (3), and so thc expression in (4.11) is always negative. This shows th-tit 
2 0*1(a) 
07rl(a) - 
Chapter 4. Multiple timescales 
Since we have a planar semiflow with negative divergence the system must con- 
verge to a fixed point; there is a unique fixed point, at the Nash distribution 
(Cowan 1992), so this point must be globally attracting. Therefore from Theorem 
42 it follows that the learning algorithm (4.6) will converge with probability 1 to 
the Nash distribution of the Shapley game. 
4.5 A graphical analysis 
It is of interest to know when the convergence assumption (Assumption C) will 
hold. One method that can be used to analysc games is to extend the concept of 
graphical games (Littman et al. 2001; Koller and Milch 2003). 
Given a ganic, we draw a graph with a node corresponding to each player. An arc 
is drawn from node i to nodc i if the actions of player i directly affect the rewards 
received by player j. Thus a simple non-degencratc 2-player game is represented 
by the graph 
and Jordan's 3-playcr matching pcnnics game is rcpresented by the graph 
c) When considering the cffccts of using multiple timescales, a graph can be drawn. The node representing the slowest player is then removed, along with all arcs connected to it. The remaining graph represents the game as if the strategy of 
the removed player is fixed. In particular, if the resultant graph is acyclic then 
At4suniption C holds. An obvious class of games for which this holds is games for 
which the initial graph is acyclic, i. e. a directed tree. A slightly more complicated 
4.5. A graphicnI nnalysis 
class of games where this happens is the class of cyclic games, such as N-player 
matching pennies (Section 4.4.1), where the graph is a simple directed cycle: 
Removing any node leaves a simple directed line of nodes, and convergence clearly 
follows. A third class is that of star games, where each agent only interacts directly 
with one central controller: 
In this case, removing the central player means that the graph is discollnected, 
and therefore acyclic. This class of games could have applications in arm. s such wS 
auctions and computer communications. 
However, it may be necessary to consider the resulting game more thoroughly. 
Consider a 3-player game, consisting of a matching pennies game with all appren. 
ticc for one of the players: 
Playcr 3's choice: HEAD Irik 111 
Player 2's choice: 
Player J. 's choice 
IIEAD TAIL 
(1,0,1) (09 1,0) ( 
(0,1,0) (0,0,0) 
11 EA 1) TA 1L 
(0,0,0) (0) 1,0) ( 
(01110) (11091) 
Clinpter 4. Multiple timescales 
Players 1 and 2 arc playing a matching pennies game, while Player 3 is an ap- 
prcnticc to Player 1: Players 1 and 3 will not get any points unless they both win 
the matching pennies game (by matching Player 2), while Player 2 scores a point 
by simply playing the opposite action to Player 1. The actions of Player 3 only 
directly afrect the reward to Player 1, and so the graph of this game is given by 
Removal of nodc I leaves a very simple graph, and so Assumption C would hold if 
Player 1 is slowest. On the other hand, suppose Player 2 is the slowest, resulting 
in a graph as for a generic 2-player game. For any fixed strategy 70, Players 1 
and 3 face a coordination game similar to that studied in Section 2.3; there is not 
a unique Nash distribution to such a game, and so Assumption C fails to hold. 
Finally, however, suppose that Player 3 is slowest. Again a generic 2-player graph 
arises, but now for fixed 70 this is a game with a unique Nash distribution, and so 
Assumption C does hold in this case. 
So we see that graphical methods can be useful to help analyse whether the 
learning algorithin will satisfy Assumption C, and may even help a system engineer 
to decide on fast and slow learners (in the case of a computer communications for 
example). I lowcvcr, they arc not a complete solution to the problem of determining 
whether Assumption C will hold, as demonstrated by our example of matching 
pennies with an apprentice. 
4.6 Conclusion 
We have extended the actor-critic algorithin of the previous chapter to the case 
or players that learn at different rates, thus breaking the symmetry that causes 
4.0. Conclusion 
strategies to cycle. This necessitated an extension Borkir's (1997) two-timescales 
stochastic approximation result to the case of multiple timescales. However, 
Borkar's simple assumption that the ODE associated with the fast titne. scale has 
a unique globally attracting fixed point becomes rather more cumbersome ill tile 
multi ple-ti mescales case. 
We show that this extended algorithm will still converge for tile siniple 2-player 
games in which the simpler actor-critic algorithm (3.5) (and stochastic fictitious 
play) will converge, and also that the algorithm converges to the unique Nash dis- 
tribution for Shapley's game and for a generalisation of Jordan's 3-player pennies 
game. This is the first (sensible) algorithm for which this is known to happen. 
A further gcneralisation to the case of 'cautious' players, where each player uses 
different learning parameter schedules for tile Q values, gives identical asylliptotical 
results. The only constraint in this case is that no two players learn fit identical 
rates, and that all players adapt their strategies at a slower rate than they learn 
their Q values. Thus the players in this algorithm are truly independent: irplayers 
use a continuous distribution to choose random p', E (0-5,11 with P. 
4% < and 
set A. ' = (n + Qx)-, 014, it,, = (n + Cp)-14, for constant 
C. %, C,, > 0, then the n 
appropriate conditions will be satisfied without any coordination between players 
at all. 
Analysing when the convergence conditions of the algorithm will hold call prove 
difficult, but a graphical analysis may lielp in certain situations. Four classes or 
games for which Assumption C holds are 2-player ganies, gaines for which the 
graph is a tree, cyclical games, and star games (if the 'Jiulj' is the slowest player). 
Chapter 5 
Q-learning in normal form games 
In this chapter we study 'individual Q-learning', where players do not maintain an 
explicit strategy, and simply utilisc a standard value-based reinforcement learning 
algorithm. In Section 5.2 we will show that individual Q-1earners will converge to 
Nash distribution in a 2-player zero-sum game. We consider a multi ple-ti mescales 
Q-1carning algorithm in Section 5.3, proving that strategies converge to Nash dis- 
tribution in several classes of game. 
Ideas from this chapter were presented in the Multi-Agent Learning workshop 
at NIPS 2002. 
5.1 Individual Q-1carning 
nie. model we consider is a simple one, under which players simply play a dis- 
tribution based upon their current Q values, and adjust these Q values towards 
the reward observed. While the standard method of adjusting Q-values, as used 
ill the actor-critic algorithm (3.5), would be an obvious choice, Fudenberg and 
Levine (1998) suggest that the update to Qi (ai) should be divided b the prob- ny 
ability of playing ni (see (5.1)). This is motivated partly by the fact that if an 
action is played with low probability, it will not be played often, and any observed 
Changes ill value need to have a significant effect. Further motivation is that for 
5.1. Individunl Q-1enming 
2-player games this results in trajectories that are closely related to the Smooth 
best response dynamics (1.8), and so results can be inferred from these well-studied 
dynamics. The algorithm to be studied is therefore: 
Individual Q-learning algoritlini 
i Each player i selects an action an using the strategy 0"(Q,, ), then updates 
Q' according to n 
Q, ', +I (a') = Q,, (a') + 
Aniah=awj Q, ', (a')), for ai fli(Qi)(ai) n 
where is a deterministic sequence satisfying the standard conditions 
(1.15). 
Again, the only information used by player i is the action site played and the 
reward she was given-she sees this reward to be simply a random %-ariable (which 
is of course dependent on the action played by the opponents). 
Proposition 45 If the individual Q-1carning algorithm (5,1) converges to a ftrtd 
point 
as it -+ oo 
then the strategies fl'(i) are a Nash distribution. 
PROOP As before, convergence can only occur when the expected change 
Q,, is zero. Writingfl-'(Q-) for the opponent strategies arising 
from the %"aluei 
Q-', it is clear that 
(IQ'+, (a') -Q"(a')}IA,, IQ, =Q] nn 
and so we must have ' = Therefore, for each i, is a 
smooth best response to the opponent strategies, and thercrore the are a 
Nash distribution. 
Chripter 5. Q-1earning in normal form games 
Following identical arguments to those previously given, it is clear that a con- 
tinuous tirnc interpolation of the Q values is an asymptotic pseudotrajectory of 
the sciniflow induced by 
'(a') = r(a', fl-'(Q -')) - Q'(a'), 
(5.2) 
so long as the Q values remain bounded. Note that division by 0'(Q, ', )(an) may n 
cause difficulties with boundedness, but if We Set An = minjminj, 3i(Qni)(ain), A'n}I 
With f satisfying (1.15), then there are no difficulties (eventually the bound- 
edness of Q values means that An = An alternative approach would be to 
use the method of random truncations (Chen and Zhu 1986). However, in practice 
(Section 5.4) there arc no difficulties with boundedness, and so we are content with 
leaving boundcdness as an assumption. 
5.2 2-player zero-sum games 
Fudcnberg and Levine (1998) observe that, for 2-player games, if 7r evolves accord- 
ing to the smooth best rcsponsc dynamics (1.8), then r'(a', 7r-') follows trajectories 
of the Q-1carning ODE (5.2). Reversing this argument, if initial Q values are belief- 
based, i. e. satisfy Qi(ai) = ri(ai, 7r-i) for some 7r, and evolve according to (5.2), 
then they will behave as if they result from evolution of strategies according to 
the smooth best responsc dynamics. 
Lenunn 46 In 2-player zero-sum games, trajectories of the ODE (5.2) with belief- 
based initial conditions will converge to a unique fixed point, corresponding to the 
unique Nash distribution. 
PROOr Suppose the initial conditions correspond to the beliefs 7r. The tra- 
jectory or oic smooti, best response dynamics (1.8) starting at 7r will converge to 
the unique Nash distribution * (Theorem 32), and so tile trajectories of ri(7r) will 
converge to r(fl. But these trajectories are the trajectories of the Q values, and 
tile result follows. 
5.2.2-pinyer zero-sum games 
Despite this lemma, it is not immediate that the updates (5.1) will result in 
convergence to Nash distribution, since we have only shown that trajectories of 
(5.2) converge to Nash distribution values for a limited set of initial conditions; 
we need to analyse the global convergence properties of (5.2). In order to do 
this, we will prove a general dynamical systems result in order to show that tile Q 
values are asymptotically belief-based. We need the following version of Cronwall's 
inequality: 
Theorem 47 (Gronwall's inequality) Let X be a Banach space, arid UCX be 
an open set. Let f, g. U -+ X be continuous functions, arid 
let y, x- : 
[t, t+ TJ -* U 
satisfy 
f (Y), 
Assume that f is Lipschitz, with constant L, and that there exists a continuous 
function q: [0, T) -+ [0, oo) such that Ilf (z(i + 
h)) - g(. -(i + h))Il :5 rj(h). Then for 
hE [0, T] 
Ily(t + h) - z(i + h)II :5 
JhIlY(t) +c Lh 
C-LT ri(r) dr. 
PROOP For sE [t, t+ T], 
U-8 Ily(s) - z(s)ll :5 U(s) - -(s)ll 
= Ilf (Y(S)) - g(z(. S)) 11 
:5 Ilf WS -f (ZW)ll + li(f 
(.. (. 5 - g(--(9ii 
=: 5 Llly(s) - 2(s)ll fl(s - 
Thus for 7E (0, T] 
and the result follows. 
4 Recalling the definition (3.6), and examining the Q-1carning ODE (5.2), we mv, 
that the Q values arc always attracted towards points r(fl(Q)), which lie in the 
Clinpter 5. Q-1carning in normal form games 
interior of some lower-dimensional space-the set of all points r(7r) is a compact, 
convex subset of an affine subspace of the set of possible Q values, and since smooth 
best responses arc used the rewards lie in the interior of the set of values d7r). We 
will consider an abstract representation of this system. 
Leninin 48 Consider the ODE 
=F(y)-y, YER', (5.3) 
where F: R' -+ R' is a Lipschitz continuous function. Take an affine subspace 
SC R"I and a compact, convex subset DCS. Suppose F(Y) E ints(D) for all 
yE R', where ints denotes the interior with respect to the linear subspace S, and 
further that all trajectories with initial conditions yo ED converge to a unique 
fixed point y*. Then y* is a globally attracting fixed point of the ODE. 
PROOP Without loss of generality we can assume S= fy E RI : y,,,, +, 
... = y,,, = 0) for some 1 <- in' -< m, and 
that D= fy ES: jyj :5 1} where 
denotes Ejudidean distance. Thus (5.3) becomes 
l  F 11 (Y) 
0 Yml+i 
Consider trajectories restricted to the invariant subspace S, and consider IV = 
JyJ2/2; it is clear that 
IV =y-=y- (F(y) - y): 5 lylIF(y)l - JyJ2. 
I'lius for jyj : I we have TV < 0, since IF(y)l < 1, and so there exists an c>0 
such that if jyj >1-c then IV < 0. 
5.2.2-player zero-sum gnmes 
Suppose Jyj >I for all time, and so IV <0 for all time; this implies that IV 
tends to a limit and TV -+ 0. Therefore y converges, to the set fy : Jyj :51- c), 
contradicting our assumption that Jyj >I for all time. But then it follows that 
in finite time we must have Jyj :51, Le. yEA Therefore the trajectory 111ust 
converge to y*, since all trajectories starting in D converge to y*, and so y* is a 
globally attracting fixed point of the semiflow restricted to the affinc subspace S. 
Now consider a general trajectory, not restricted to lie in S. It is clear that 
the components y,,, +,,..., y.. will tend to zero exponentially, so we compare 
(5.3) to the system that behaves as if these components are already zero. Dc- 
fine F(yi, and consider the seiniflowp defined 
F(z) - z. (5.4) 
It is clear, due to the decoupling of (zi,... gzm, 
) and ... I mb that -, 
(i) = 
zj(O)e-' for i> m', and that y* is the unique globally attracting fix('41 point of this 
scmiflow. 
Define f(y) = F(y) -y and g(z) Z. Since 
F is Lipschitz continuous, 
with constant C, say, it is clear that both f and g are Lipichitz continuous (with 
constant C2 = C1 + 1), and also that 
Ilf(z(t+h))-g(z(t+h))115CI E jZj(i+h)j=C3C-(1+A)- 
jWm'+1 
Thus by Gronwall's inequality, if y solves (5.3) and - solves (5-4), 
Ily(i + h) - z(i + h)JI :5 eclhlly(i) - z(t)jj + C-'C4(c 
-C -A). 
Translating back to the language of sciniflows, we see that . -(t + 
and so 
sup Ily(t + h) - Vh(y(i))Il :5 C-'C4 SUP 
(CC2h 
_c -h) 
O<h<T O<h<T 
Therefore y(t) is an asymptotic pscudotrajectory of the serniflow (P, and trajectories 
converge to the unique globally attracting fixed point (Proposition 21). Thus all 
trajectories of (5.3) converge to the point y*, and the lemina is proved. 
Chapter 5. Q-learning in normal form games 
This lemma applies directly to the Q-learning ODE (5.2), and is useful for 2- 
player zero-sum games where there is a unique Nash distribution. 
Lemma 49 For 2-player zero-sum games, all trajectories of the ODE (5.2) will 
converge to the unique fixed point corresponding to a Nash distribution. 
PROOF Note that (Ql, Q2) E RIAII+IA21. Since we consider 2-player zero-sum 
games, there is a matrix Al such that r 1(., or2) = Afor2 and r2(., OI) = -)VITal 
(where MT is the transpose of Al). Define 
xE RIA'1'IA'l 
T 0 -. Al 
(M0)(0,2 ) 
0" A'l 
0 _MT Ul 
Since 3(Q') E int(Ai), it follows that (rl(-, #2(Q2)), r2(., #2(Ql))) E ints(D). 
Further, Q values in D are belief-based, so from Lemma 46 all trajectories with 
initial conditions in D converge to the Q values corresponding to the unique Nash 
distribution. Thus by Lemma 48 the result follows. 
Proposition 50 In 2-player zero-sum games, provided the Q values are bounded 
for all time, the strategies 3'(Q') of individual Q-learners (5.1) will converge al- n 
most surely to the unique Nash distribution. 
PROOF Lemma 49 shows that all trajectories of the ODE (5.2) converge to 
the unique Nash distribution values. Standard stochastic approximation results 
(Section 1.3) show that the Q values will converge almost surely to the unique 
globally attracting fixed point of the ODE (5.2), corresponding to Nash distribu- 
tion values. But the strategies of the players are simply the smooth best responses 
to these values, and so the strategies converge almost surely to the unique Nash 
distribution. 
5.3. Multiple-timescales Q-1earning 
REMARK It is clear that a corresponding result can be obtained for 2-player 
partnership games. For Lemma 48 the presence of a unique globally attracting 
equilibrium in D is not particularly important: we have essentially shown that 
trajectories of (5.3) will converge to the chain-recurrent set of the serniflow re- 
stricted to S. A little extra work will show that this chain-recurrent set lies within 
D, and consists of Nash distributions (if these form an isolated set, i. e. if there are 
finitely or countably many of them). 
REMARK A symmetric Q-learning equivalent of Model 1, Section 3.4, could 
be constructed, where now the population maintain Q values using (5.1), and the 
agent who plays the game selects an action according to a smooth best response 
to these values. This could be analysed in an identical manner to the N-player 
algorithm proposed here. 
5.3 Multiple-timescales Q-1earning 
The individual Q-1earning algorithm (5-1) can be studied using the smooth best 
response dynamics (1.8), and hence will not converge in the same situations as 
stochastic fictitious play or our simple actor-critic algorithm (3.5). In this section, 
we consider multiple-timescales Q-1earning, in which each player learns at a 
ferent rate, in a similar fashion to the multiple-timescales actor-critic algorithm 
(4.6). The updates are exactly the same as for the individual Q-1earning algorithm 
(5-1), except that the learning parameters are different for each player: 
Chapter 5. Q-learning in normal form games 
Multiple-timescales Q-learning algorithm 
Each player i selects an action a' using the strategy 6'(Q' ), then updates nn 
Q' according to n 
Qi n+ I (a') = Q' (a') + 
Ain I "*"=*i)) (R'n - Qn' (a')) , 
for a' E A', (5.5) n 8i(Qi)(a' 
where JA' In> 1 are deterministic sequences satisfying the standard conditions n 
(1.15), and An /AIn -+ 0 as n -+ oo whenever i 
Following an identical argument as for individual Q-learning, it is clear that if 
Q,, -+ 
0 then P'(0') gives Nash distribution strategies. 
To analyse this algorithm in more detail, notice that for each i there is a separate 
timescale, with the associated ODE in each case being identical to that in the 
single-timescale case: 
Q'(a') = r'(a',, 8-'(Q-')) - Q(a'). 
For the multiple-timescales actor-critic algorithm (4.6) we had to assume that for 
fixed strategies 7r: 5' of the slow players, the fast players would converge to a unique 
joint smooth best response ff"(7r: 5'). An exactly equivalent assumption needs to 
be made for the multiple-timescales Q-learning algorithm: 
Assumption Q For each i=2,. .., 
N-1 there exists a Lipschitz function qi 
such that q'(7r',..., 7r'-') is the globally asymptotically stable equilibrium point of 
the ODE 
i=ri(., B"[7r",, 3'(Q')]]) - Q' 
where ff" is as defined in Section 4.2. 
This assumption allows us to prove a result directly analogous to Theorem 42. 
Theorem 51 Under Assumption Q, and assuming the Q values remain bounded 
for all time, the values Q,, arising from the multiple-timescales Q-learning algo- 
5.3. Multiple-timescales Q-1earning 
rithm (5-5) satisfy 
as n-+oo a. s. 
for 2,..., N, and a suitable continuous time interpolation of the Q' is an n 
asymptotic pseudotrajectory of the semiflow induced by the ODE 
' = r'(-, B"(, 61(Q'))) - 
PROOF Immediate from Theorem 40 and Assumption 
As noted for the multiple-timescales actor-critic algorithm, the convergence as- 
sumption (in this case Assumption Q) is vacuous in the case of 2-player games. 
From Theorem 51, we know that for the multiple-timescales Q-learning algorithm 
in a 2-player game, 
IIQ 2_ r2(., pl(Ql))11-40 as n-+oc), n 
and an interpolation of the Q1 is an asymptotic pseudotrajectory of the serniflow n 
induced by 
1=-Q1- (5.6) 
As in Section 5.2, this is most helpful in the case of zero-sum games, for which 
there is a unique fixed point. 
Proposition 52 In 2-player zero-sum normal form games, the strategies Pi(Qni) 
of multiple-timescales Q-learners (5.5) will converge almost surely to the unique 
Nash distribution, provided that the Q values remain bounded for all time. 
PROOF As for Lemma 49, it is a consequence of Lemma 48 and Proposition 43 
that the dynamical system (5.6) has a globally attracting fixed point corresponding 
to the unique Nash distribution. Thus Theorem 51 and Proposition 21 show that 
the Q values converge to the Nash distribution values. Since the strategies are 
simply a continuous function of these Q values, the result follows. 
Chapter 5. Q-learning in normal form games 
As for the individual Q-learning algorithm (5.1), it is highly plausible that a 
similar result will hold for 2-player partnership games, but we do not show this 
here. Instead, consider a general game for which Assumption Q holds, but where 
Player 1 (the slowest) has only 2 actions. 
Proposition 53 Consider a game for which Assumption Q holds, where Player 1 
has only 2 actions, and where there are finitely or countably many Aash distribu- 
tions. If Player 1 uses Boltzmann action choice, and the Q values remain bounded 
for all time, then the strategies arising from the multiple-timescales Q-learning 
algorithm will converge to a Nash distribution. 
PROOF For this proof, to ease notation, write 
P(a)=rl(a, B"(P'(Q'))), 
Since 7r'(2) =1- 7r'(1), we see that (a) depends on the scalar variable ir'(1), 
which in turn depends on Q'(1) and Q'(2). Thus 
dP(a) 197r 1 (1) 1(1) + 
07r 1(111(2) 
d7rl(l) 
9Q'(l) aQI(2) (5.7) 
d'() 
'r-I 7r'(1)7r'(2) 
(01(l) 
01(2)) 
d7rl(l) 
since 
7r'(1) 1- 71(2). 1+ e{Ql(2)-Q'(1))/T 
We wish to show that the quantity U= Q'(1) - Q1(2) can be used to construct 
a Lyapunov function. This will be true if the time derivative 
&= 1(1) 
1(2) 
has fixed sign for all time, in which case either U or -U is a Lyapunov function. 
Tt dt 
7-1 7rl(1)7r'(2) 
(1(1) 
1(2)) 
( &(1) dP(2) 
d7r'(l) d7rl 
17-'7r'(1)7r'(2) ( dP(l) &(2) )-, 1& 
d7rl(l) d7rl(l) 
5.4. An example 
and so & cannot change sign. Thus either U or -U is a Lyapunov function, and 
by assumption there are finitely or countably many fixed points, so by Proposition 
21 the result follows. 
REMARK It is probable that this argument could be modified to show that for 
the same class of games the multiple-timescales actor-critic algorithm (4.6) will 
converge to Nash distribution, since the values r'(., 7r") under that model follow 
the same trajectories as the values Q1 under multiple-timescales Q-1earning. 
REMARK Proposition 53 shows that multiple-timescales Q-learning will con- 
verge to the Nash distribution of our N-player matching pennies game (4.8). 
5.4 An example 
In this section we consider Q-1earning in Shapley's game (3.2). Note that for the 
smooth best response dynamics (1.8) there is an attracting limit cycle for the 
strategies, which implies that there is an attracting limit cycle for the Q-1earning 
ODE (5.2). Therefore we would expect the Q values, and hence the strategies, 
arising from the individual Q-learning algorithm to cycle continuously. 
On the other hand, there is a unique globally attracting fixed point of the per- 
turbed smooth best response dynamics (4.7) for this game (Section 4.4.2). There- 
fore the analysis presented above for zero-sum games will carry through to show 
that the strategies arising from multiple-timescales Q-1earning will converge to the 
unique Nash distribution in this case. See Fig. 5.1. 
5.5 Conclusions 
In this chapter we have dropped the explicit updating of a strategy, and 
instead 
consider an algorithm that is fully value-based (with the strategies played 
being 
simply a function of the values). 
Chapter 5. Q-Ienrning in normal form games 
c clq 0 
0.0 0.2 0.4 0.6 0.8 1.0 
7r (R) 
Figure 5.1t Strategies of Player 1 in Shapley's game (3.2) with Boltzmann 
action choices (r = 0.1) over 5x 10' iterations of individual Q-learning 
With An = (n + 100)-0,9 (top) and of multiple-timescales Q-1carning with 
A, I, = (n + 100)-0-0 and A2n = (n + 100)-0.7 (bottom). For individual Q- n 
learning the strategies follow a limit cycle, while for multi ple-timescales Q- 
learning the strategies are converging towards the unique Nash distribution. 
0.0 0.2 0.4 0.6 0.8 1.0 
7r'(R) 
5.5. Conclusions 
We have shown that under individual Q-1carning the Q values are asymptoti- 
cally belief-based, and therefore individual Q-1carning behaves asymptotically in 
a similar manner to stochastic fictitious play and the actor-critic algorithill of 
Chapter 3, at least for 2-player games. 
A multi ple-ti mescales Q-learning algorithm has also been presented, which can 
be analysed in a similar manner to the multiple-timescales actor-critic algorithm. 
Again, a generic analysis of the behaviour of this multiple-tiniescales algorithin is 
not available, since the convergence assumption will not hold for all games. 
The theoretical results have been verified by a numerical example, where we 
applied the algorithm in Shapley's game (3.2). As predicted, the strategies do not 
converge in the case of individual Q-1carning, but do converge to the unique Nash 
distribution when multiple-timescales Q-1carning is used. 
Chapter 6 
Weakened fictitious play and an 
actor-critic algorithm 
So far we have considered players who choose smooth best responses, either to 
opponent play (in the case of stochastic fictitious play) or to estimates of action 
values (in the case of the reinforcement learning algorithms that have been consid- 
ered). However, these algorithms result in agents that will play suboptimal actions 
with a non-vanishing probability even when an algorithm converges. 
In this chapter we consider algorithms that are rational, in the sense of Bowling 
and Veloso (2002); if a rational algorithm converges to a fixed point then only 
actions with maximal expected reward will be played in the limit. Thus if these 
algorithins converge when applied in a game they must converge to the set of Nash 
equilibria (as opposed to the Nash distributions considered previously). 
We study these algorithms by extending Ilofbaucr (1995) to show that the 
limit sets of fictitious play (Brown 1951), weakened fictitious play (Van der 
Genugten 2000), and a new actor-critic algorithm (to be introduced in Section 
6.4) are each contained in the limit set of the best reply differential inclusion. 
, rhis ninit set is shown to coincide with the Nash equilibria of the game for 2- 
player zero-suni games, non-degcnerate 2xm games and games solvable by strict 
dominance. 
0.1. Discussion 
6.1 Discussion 
Traditional analyses of discrete fictitious play, and its variants, have relied oil ad 
hoc procedures to prove convergence (or otherwise) to the set of Nash equilibria, 
even though it has long been known that a fictitious play process is an Ell r , le 
discretisation of the best response dynamics (Brown 1931). Robinson (1951) used 
"vector systems" to prove convergence in 2-player zero-surn games, all appr(Nich 
extended to allow consideration of a converging sequencc of games (Wicze anti 
Tijs 1982) and "weakened fictitious play" (Van der Cenugicii 2000). On tile other 
hand, Monderer and Shapley (1996) use a quasi-Lyapunov function approach ill 
games with identical interests, and Milgrom and Roberts (1991) show directly that 
only serially undominated strategies will be played in the limit. 
The methods of stochastic approximation used so far in this thesis will not apply 
in the case of fictitious play, since the best response dynamics (1.7) arc not contin- 
uous. Some results (Delyon 1996; Tadi6 1998) allow the stochastic approximation 
of discontinuous processes, but only where a Lyapunov function is present, which 
is not always the case for the situations we consider (though see llofbaucr and 
Sorin (2002) for indications of developments that may allow stochastic approxi- 
mation of the best response differential inclusion)l. Further, tile two-timescales 
approach used for our actor-critic algorithm is not easily studied using these Inctil- 
Therefore we follow 11ofbauer (1995) in using specific aspects of tile proofs of 
stochastic approximation results; lie shows that the limit set of a discrete fictitious 
play process is contained in the maximal invariant set of the best response dynaill- 
ics, concentrating on symmetric 2-player games. This has been extend(A 
ill several 
more recent works (11ofbauer and Sorin 2002; Berger 2003). 
Here wc extend this 
work further, relating the limit sets of weakened fictitious play in A%player gallies 
to an invariant set of the best response differential inclusion. 
IThis since appeared as as Benalm ct al. (2003) 
Chapter 6. Weakened fictitious play and an actor-critic algorithm 
After discussing fictitious play models and the best response dynamics in Section 
6.2, we prove in Section 6.3 that the limit set of a weakened fictitious play process 
is contained in an invariant set of the best response dynamics (it will be noted that 
a traditional fictitious play process, henceforth called a Brown-Robinson process, 
is a special case of a weakened fictitious play process). In Section 6.4 we introduce 
our actor-critic reinforcement learning algorithm, and show that it results in a 
wcakcned fictitious play process. 
6.2 Fictitious play and the BR dynamics 
It is clear that a Brown-Robinson process (1.6) is a decreasing step-size discretisa- 
tion of the best response differential inclusion (1.7). It is intuitively obvious that, 
for sufficiently large n, a continuous-time interpolation of the Brown-Robinson 
process should track a trajectory of the best response dynamics (henceforth the 
1111 dynamics). Indeed Ilofbauer (1993) shows that any limit point of the Brown- 
Robinson process (1.6) will be contained in an invariant set of the BR dynamics 
(1.7). 
However it has recently been observed (Van der Genugten 2000) that the speed 
of convergence of the Brown-Robinson process can be improved by considering 
weakened fictitious play, where players choose an c,, -best response at stage n. 
Here player i's c-bcst responses to opponent strategy7r-' are given by 
13 ft, (7r-') = (b' E A' : r'(b, 7r-") 
max ri(7ri, 7r-i) - C}, 
irl EAi 
and we write 
111 (7r) = ((b', ..., 
blv) E A1x ... x AN : b' E BIV, (7r-i) for each i}. (6.1) 
If -+ 0 as it -+ oo, so that players play asymptotically optimally, it is again 
intuitively obvious that the limiting behaviour of such processes is characterised 
by the limit behaviour of the BR dynamics (1.7), and we show that an identical 
0.2. Fictitious pIny nnd the Illt dynninics 
result can be proved for this process as is achieved by 11ofbauer (1995) for tile 
Brown-Robinson process. 
Define a set A to be invariant for a differential inclusion if, for all ro E A, 
there is a trajectory x(t) that solves the differential inclusion, with X(O) = zo and 
x(t) EA for all t. We here state a theorem summarisitig previous results on the 
BR dynamics. 
Theorem 54 The maximal invariant set of the best response dynarnics (1.7) is 
contained in the set of Nash equilibria for the following classes of Saincs: 
1.2-player zero-sum games, 
2. non-degenerate 2-player 2xm games, 
3. games solvable by iterated strict dominance. 
PROOF Class 1 is directly from Section 7 of 11ofbauer (1995). Class 2 is the 
result of a recent paper (Berger 2003). Class 3 follows directly from the observation 
that the probability of playing a dominated strategy decreases exponentially for 
all time. 
REMARK rollowing 11ofbaucr and Sigmund (1998) and Monderer and Shap- 
ley (1996) we note that thc same results hold for game-; that are best response 
equivalent in mixed strategies to these games. In what follows we will not mention 
these rcscalings, though clearly all our results will hold in this wider class. 
REMAM Although it may seem natural that a similar result will hold for 
partnership games, this is not the case: despite the fact that all trajectories of the 
best response differential inclusion will converge to the set of Nash equilibri. a, nit 
invariant set may contain other points. 
Chapter 6. Weakened flctitious play and an actor-critic algorithm 
6.3 Weakened fictitious play 
In this section we extend Appendix B of Hofbauer (1995) to prove that limit points 
of a weakened fictitious play process will converge to an invariant set of the BR 
dynamics (1.7). This shows that a weakened fictitious play process will converge 
to the set of Nash equilibrium for the 4 classes of games listed in Theorem 54. 
Consider a continuous weakened fictitious play (CIVFP) process f (t) with 
+ r) = c-f (t,, ) + (1 - e-') b(t,, ) for 0<r<a,, = t,, + 1-t, 
b(in) EB R. (f (t. )) 
t, -+ 00 
(6.2) 
Any weakened fictitious play process (as described in Section 6.2), with belief 
vectors la,, },, >o, can be interpolated by a CWFP process with t,, = log(n) and 
a,,; howeva we consider a general CWFP process (6.2). 
Deflnitimi 55 A CIVFP process (6.2) is called a S-path if a,, <S and c,, <8 for 
all n. 
Thus for small 8 the step sizes are small and the b(t,, ) are close to being best 
responses. Intuitively therefore, small 8 should mean that the process (6.2) behaves 
similarly to the Blt dynamics. This is what we will proceed to show. 
Lemnin 56 Let (Si}i>t be a positive sequence of numbers such that Si -+ 0 as 
i -+ oo, and let fi be a Si-path for each i. Then for given T there is a subsequence Si, 
, such that the functions fi, (t) converge uniformly on the interval [0, T] as k -+ 00 - 
, tiny such 
limit 7r(t) is a solution of the BR dynamics (1.7) on [0, T]. 
PROOP NVC closely follow the proof of Hofbauer (1995). Let t(') denote the n 
'interpolation I)Oints' of fi. Note that (6.2) is equivalent to 
., L for (6.3) nn n+ n 
0.3. Weakened flctitious piny 
and an integrating factor shows that fj satisfies 
A(t) = C-Ifi(o) +i co-lbi(s) (1.9, 
where bi is a cad lag step function with values b, (d) 6 
From the differential equation representation (6.3) it follows that tile fi are 
uniformly Lipschitz continuous, and thus by the Arzela-Ascoli theorem there is 
a subsequence Ji. such that the functions fi, arc uniformly convergent on (0, TI; 
suppose that fi., -+ 7r. 
Now consider the functions bi,,. Since we are working in compact spaces, there 
exists a weak accumulation point. Take any such accumulation point b, and con- 
sider the value of b(t) for arbitrary tE (0, T]. If we can show that b(i) E 
we arc done, since then 7r satisfies 
ir(t) = e- 
t 7r(0) + 
ei-fb(. 3) ds, b(is) E 
which is the integral representation of the lilt dynamics (1.7). 
Fix t and choosc tj > 0. In wliat follows let B be tile olvil unit ball if) 
RIAII+---+IANI 
, and 
for xE RI" 
1+---+IANI let T+ yB= {X + y.. :"E B). Sim- 
ilarly, for sets X, YC RIAII+, --+IANI let X+y={. T +y: TEX, ye 
1"). Ily tile 
definition (6.1) of c-best responses, anti the continuity of lilt, at 0, we call 
choose t7li72 >0 such that 
8< 71 = 11114(7r(t)) C BI1(7r(i)) + -12B9 and 
zE 7r + r12 B =; , B Ri (z) C 11114 Or M) + 
22 B. 
Since fi, -+ 7r, and the fi, are uniformly Lipschitz, we can chowe 
K>0 such 
that, for all k> It', 
 ill, and 
11fi, (i 
- i') - 7T(t))Il ? 12 
for all t' < Si,. 
Then, si nce bi, (i) E 111 Vi, (i - 0) for some i' < Si,, for k 2: K, 
bi,, (t) E BRsjfih(t -i')) C Bllj,,, 
(7r(i))+ 2,11 C 
Clinpter 6. Weakened fictitious play and an actor-critic algorithm 
Thus b(t) E BR(x(t)), and the proof is complete. 
NVc use this lemma to consider the limit sets of CWFP process (6.2) for which 
a, -+ 0 and c,, -+ 0 as n -+ oo. As already noted, this case includes the interpo- 
lation of a discrete weakened fictitious play process. 
Lenin-ia 57 Consider a CIVFP process f with a,, -+ 0 and c,, -+ 0 as n -4 oo. 
The set of limit points of this process is an invariant set for the BR dynamics 
(1.7). 
PROOr This proof is in Appendix B of Ilofbauer (1995). We include it here 
for completeness. 
Let L be the set of limit points of f (which exists because f(t) is in a compact 
space). L is a limit set, and so is compact; if for arbitrary pEL and T>0 we can 
construct a solution x(t) E L, -T <t :5T with x(O) =p then the result follows. 
For any PEL there exists a sequence fsi}i>o with si -+ oo as i -+ oo such that 
f (si) -+ p. Define functions xi(t) =f (si+t) for -T <t<T (since si -+ oo we can 
assume w. l. o. g. that si > T), and define fi(t) = xi(t - T) for 0 <- t <- 2T. Then 
the fi(t) satisfy the conditions of Lemma 56, and there exists an accumulation 
point 9(t), 0 :5t :5 2T, which is a solution of the BR dynamics (1.7). Defining 
x(t) = 9(t + T), -T <t<T, it is obvious that x is an accumulation point of 
the xi and satisfies the BR dynamics. From the definition of the xi it follows that 
x(O) = 1), and since x is an accumulation point of the xi it follows that x(t) EL 
for -T: 5 i<T. 
Theorem 58 The limit set of any weakened fictitious play process is contained in 
the maximal invariant set of the BR dynamics. 
P110011 As noted at the start of this section, any weakened fictitious process 
has an interpolation (6.2) with i,, = log(n). Thus a,, = log(n + 1) - log(n) ; z: s 1/n. 
Since the limit set of the discrete process is clearly contained in the limit set of 
the interpolation, the result follows immediately from Lemma 57. 
0.3. Weakened flctitious play 
Corollary 59 The limit set of the Brown-Robinson process is contained ill the 
maximal invariant set of the BR dynamics. 
PROOF The Brown-Robinson process is a special case of weakened fictitious 
play. 
Corollary 60 Any weakened fictitious play process will convenye to the act of Nash 
equilibria in 2-player zero-sum games, non-degenerate 2x in ganics, and garlif'. 1 
solvable by iterated strict dominance. 
PROOF This is immediate from Theorems 54 and 58. 
REMARK It is clear that the result of a fictitious play process where the esti- 
mates of action values r'(a, 7r-i) are made using a converging sequence of reward n 
functions r,, is a weakened fictitious play process, since for any (>0, we can 
choose S>0 such that 
l1r, ', - r'll,,,, < argrpax r, 
', (ir', 7r-') C 
REMARK We show that the type of fictitious play in converging 2-player zero- 
sum games studied by Vricze and Tijs (1982) can easily be incorporated in the 
framework of weakened fictitious play. Vriczc and Tijs (1982) consider estimates 
U, ', (a') that are updated according to 
U. '+ (a') = U. 
' '(a') + r' ', a-'). n(a n 
If ri = ri for all n then this is exactly equivalent to the fictitious play proc"s n 
n described above, with r'(ai, L7n) = Un4 (a')/n, but when we take ri -+ ri as n -+ oo 
the equivalence is not immediate. However, fix c>0 and let n(c) be such that 
11r' - r'llo,, <e for all n : n(c). ror n 'e n(c) we see that n 
(a') = U, 
(a') + rn (a a,, 
kmn(e)+l 
Chapter 6. Weakened f ictitious play and an actor-critic algorithm 
and so 
U. ' (a') - (, )(a') + r'(a', a; ')} < (n - n(, E))c < ne. 
k=n(e)+l 
n "Ut Ek=n(e)+, 
r (a', a-') = nr'(a', a-i) - n(c)r'(a', a-' nn n(c)) and so 
Un(a')/n - r'(a', an') < 
r'(a', a-i +f 
2c for sufficiently large n. 
Thus optimal actions under Ui, are c,, -optimal actions under r'(a', a-i), with 
C, ' n 
0 as n -+ oo; Vrieze and Tijs's fictitious play for converging games is a weakened 
fictitious play of the limit game. Note that this also shows that the weakened 
fictitious play of Van der Genugten (2000), which is based on Vrieze and Tijs's 
fictitious play in converging games, is also a weakened fictitious play of the limit 
game, and so the tight conditions placed on c,, by Van der Genugten (2000) can 
be relaxed to general c,, -+ 0. 
REMARK Since the only conditions we place on the a,, are that a,, -4 0 and 
n>l a, = oo 
this allows the consideration of fictitious play processes where beliefs 
about opponent strategies places more weight on recent observations. Therefore 
define generalised weakened fiditious play to be any process 
O'n+l -: - (1 - An)O'n + AnB"fn(Orn)i 
where A,, -+ 0 and c,, 0 as n -+ oo, and E,, >, A,, = oo. The interpolation 
(6-2) requires that a,, - log(l - A,, ), and the condition a,, -+ 0 corresponds 
to the condition A,, -+ 0. Thus a gencralised weakened fictitious play process will 
converge to the maximal invariant set of the BR dynamics. This may seem counter- 
intuitive, since we have relied on the condition F,, >, An2 < oo throughout this 
thesis. However, recall that this is essentially a condition to bound the variance, 
and since there is no (explicit) stochasticity involved in weakened fictitious play 
the condition is no longer necessary. 
6.4. An actor-critic learning algorithm 
6.4 An actor-critic learnhig algorithin 
We now introduce an actor-critic reinforcement learning algorithm, which we 
demonstrate will result in a weakened fictitious play process. In common with 
the other algorithms introduced in this thesis, this actor-critic process (foes not 
require players to observe the actions or rewards of the other players, and is just As 
applicable in a single-agent learning task. Indeed, this algorithm is also rational, 
in the sense of Bowling and Veloso (2002), and will converge to the set of optimal 
actions in a single-agent problem. 
The algorithm of this chapter is a modification of that studied in Chapter 3, 
in which players adjust their strategies towards best response.,; (histead of smooth 
best responses). If, as in that chapter, the estimates Q,, satisfy 
IlQn - r-(7rn)II -+ 0 as it -+ w 
then the7r,, will be a (gencralised) weakened fictitious Play process, and the results 
of the previous section will hold. 
However the best responses remove the opportunity to use the full strength of 
Borkar's results (Theorem 23), which require continuity. Also, since strategies 
no longer remain completely mixed for all time, there arc added coil) pl ications 
in checking that all actions arc updated infinitely often so that the Q %%lues tire 
asymptotically accurate. NVc start by giving conditions under which all actions 
will be played infinitely often: 
Lemn-ia 61 Suppose that at time n, the probability of playing cach action is boun- 
ded below by (,, = (C + n)-P for sorne C>0 and PE (0,1). Thers with probability 
1 all actions will be played infinitely ofifn. 
PROOP This is a simple consequence of the Borel-Cantelli leninla. 
Although this condition on the strategies 7r,, will not arise naturally, it can be 
enforced by having player i select actions according to a projection O(Jiri) of the 
Chapter 6. Weakened fictitious play and an actor-critic algorithm 
current strategy 7rni, where 
C- 7r(a) 
s=max O, max 
aEA 1- 7r(a) 
This is a projection into the space where all strategies are played with sufficiently 
high probability. An alternative would be to simply choose a random action with 
probability (,, and otherwise use 7ri,, but this disturbs the strategies unnecessarily 
if they are all played with sufficiently high probability anyway. 
We can now specify our algorithm: 
Discontinuous actor-critic algorithm 
Each player i selects an action ai using the strategy Oc. (7ri), then updates nn 
'rnand Qn' according to 
ii 7rn+l = jin+1 )7r + Jln+jb'(Q') nn (6.4) 
Qi i) n+, (a = Q'(a') + Q'(a')), for a' E A' nnnn 
where: 
b"(Q) E argmax 7r - Qi nn 
lreAi 
0 /in+l =2 (C, + n)--O,, for some C, >0 and p,, E (0-5,1], 
\i (Cx + cn(ain))--O, % for some Q\ >0 and p, \ E (0.5, p,, ), where n+l 
en(a') En en k=O l(afn`cl')' 
* C,, = (Cc + n)-Oc for some Cc >0 and pC E (0, pi, - P, \). 
We start by showing that the Q values are asymptotically accurate estimates of 
tile action Values. 
Lemnin 62 Fix i, ai, and let fVk}k>l be the sequence of times when action a' is 
played by player i. Define Me differences 
0.4. An actor-critic learning algorithm 
Then Dk -+ 0 almost surely. 
PROOF First notice that vk is well-defined for all k, by Lemma 61. Taking 
expectations with respect to the history up to vk, 
E[Dk+l - Dk] =E[Q, 
' (a') - ri(ai ir -i Q' (a') + r'(a', 
7r -1)) 
1(h + 1) t S'(k+l) ilk Pit 
Q, ' (a') + vk 
and so 
k+l (sk)+, 
)Dk + A(i, 
*)+I(Afk 
+ I"k 
where Afk is a bounded martingale difTcrence, and 
= r'(a', Oc,,,, (7r,, ) -') - r'(a', 7r,, 
Ek = {r 
i (a', 7r r(a , 7r tvk+ I) Vk 
If we can show that jjFkjj -+ 0 and JjEkjj -+ 0 almost surely, 
then Lemma I of 
Singh et al. (2000) shows that Dk -+ 0 almost surely. 
This is trivial for Rk, since 
(,, -+ 0 and ri is continuous. For Ek, notice that 
r'(a', 7r, -, +' r'(a'. 7rn -i)11*0: 5 
for some C (depending only on the reward function r'), and so 
Ek+l-l 1 lk I' (Vk+l Vk)il(ii, )+l ovk+l - vk < -A,  <c -71 
(1,00 
where C'depends on the constants CO and Qx. Thus, by the Borel-Cantelli 
lemma, 
we see that 1JEJ -+ 0 almost surely if, for arbitrary 
Vk+l - Vk p( 
Vkp`-PA 
Chapter 6. Weakened fictitious play and an actor-critic algorithm 
Let j be the greatest integer less than or equal to S(vk)P,, -PA. Then 
(1+1 1> 8) = P(V" > V, Vk'o' pA 
Cvk+l)(1 
(s/k+2) 
Gk+j) 
<(1 - CPk+j)1 
exp I -j (,,,, +j }. 
It follows from the definition of j that 
(Vk+l 
>8< exp 
f- (J(vk)PA-px (Vic 
Vkp'A-P'\ 
= exp Clk+j x expj-J(Vk)'00-'O'(v, +jj - 
Sincc C,, is decreasing with n, it follows that exp(,, +j < C, for some constant 
C1 > 0, and additionally from the definition of j and (,, +j we see that 
h +j = 
(CC + Vk 
(CC + Vk + J(Vk)"A_P") -PC 
(Vk)-"' (CC(Vk)-' +1+ S(Vk) PJA _PA -1) -PC 
C2(vk)-"c for some 
C2 > 0. 
Therdorc, it follows that 
Vk+l - Vk 
>8<C, exp 
-SC2(Vk)p"-PA-PC 
Vkplj-p'\ 
Since vk : k, this is bounded above by C3 exp{-C4ko---, A--Oc} for some C3, C4 > 0. 
Now, for il > 0, 
C-C"-"dx Y: =="c-" 17-1 
y"-'- I e-cl Ydy = 77 - 'r(77-I)c, -n-' 
where r is the Gainina function. Therefore Ek>O C3 exp{-C4k,, --OA-, c} < oo, 
since pC < PA - PAt and we see that (6.5) holds. 
This shows that at the times that an action is played, its Q value is close to 
the action's current reward. However, since all actions are played with strictly 
6.4. An actor-critic learning algorithm 
Positive probability at all times this shows that the Q values are asymptotically 
accurate, as required, and so the two-timescales nature of the continuous actor- 
critic algorithm (3.5) passes through to this discontinuous version. Note that the 
careful choice of (,, is vital to ensure that actions are played sufficiently frequently 
to gain this asymptotic accuracy. 
Theorem 63 The 7r,, resullingfrom the discontinuous actor-critic algorithm (6. j) 
are a generalised weakened fictitious play process. 
PROOF By Lemma 62, and the fact that any action is played with strictly 
positive probability at any time, -* 0 as it-+ oo. Therefore 
bi(Q, i, ) E BR,,, (7r; i) for some c,, -+ 0. Thus the 7r. are a gencralised weakened nn 
fictitious play process. 
Corollary 64 The strategies arisingfrom the discontinuous actor-critic a1yorithin 
(6.4) will converge to the set of Nash equilibria in 2-playcr -cro-surn games, non. 
degenerate 2x rn games, and games solvable by iteratcd strict dominance. 
PROOF This is immediate from Theorem 63 and Corollary 60. 
We conclude our analysis of the discontinuous actor-critic algorithm by present- 
ing the results of an experiment using the 2-player inatching pennim gaine, with 
reward matrix 
(110) (011) 
(0,1) (1,0) 
This is a constant-surn game, so strategies evolve exactly as if it is zero-511111 (Ifor. 
bauer and Sigmund 1998), and should therefore converge to the uniquc Nash equi. 
librium, where each player plays each action with probability 1/2. In Fig. GA we Svc 
that even after 5x 10'3 iterations the strategies arc still cycling, but are spiralling 
towards the Nash equilibrium. 
Chapter 6. Weakened fictitious play and an actor-critic algorithm 
0.0 0.2 0.4 06 08 1.0 
Figure 6.1: Strategies over 5x 10(3 iterations of the discontinuous actor- 
critic algorithm in the 2-player matching pennies game. The parameters are 
pi, = 1.0, p, \ = 0.6, and pC = 0.1. After an initial period the strategies spiral 
clockwise towards the equilibrium point. 
6.5 Conclusion 
In this chapter we returned to actor-critic algorithms, and investigated what hap- 
peris when best responses are used instead of smooth best responses. We studied 
this algorithm by generalising results on fictitious play, relating weakened fictitious 
play processes to the best response dynamics (1.7). 
In particular, we have shown that the limit set of any generalised weakened 
fictitious play process is contained in the maximal invariant set of the BR dynamics 
(1.7). Using previous results about these dynamics, this shows that a generalised 
weakened fictitious play process will converge to the set of Nash distributions for 
2-player zero-sum games, non-degencratc 2xm games, and games solvable by 
iterated strict dominance. This gcncralises a result of Van der Genugten (2000), 
who placed tight conditions on the sequence jc, } to prove convergence of values 
in 2-player zero-sum games. 
0.5. Conclusion 
We then showed that an actor-critic algorithm, similar to that of Chapter 3, 
results in a generalised weakened fictitious play process, and therefore converges to 
equilibrium in the same class of games. However, the fact that play call converge 
to strategies where not all actions arc played with positive probability means that 
similar problems might be faced as with the simple learnitig model of Chapter 2 
(i. e. convergence to non-Nash purc strategy combinations). However, we showed 
that the Q values are asymptotically accurate if the strategies played arc carefully 
controlled, and this means that convergence to a non-Nash point is not possible. 
Chapter 7 
Smooth best responses in 
stochastic games 
The reinforcement learning algorithms studied in this thesis were inspired by simi- 
lar algorithms applied in Markov decision processes. It therefore seems reasonable 
to expect that learning to play stochastic games is within the reach of extensions 
of our algorithms, since stochastic games are simply a combination of Markov 
decision processes and normal form games. 
While convergence results have so far proved elusive in this area, progress has 
been made in the study of smooth best responses. This is related to an observation 
of John (1994) that Q-1carning under persistent exploration does not take into 
account the fact that suboptimal actions, which are potentially very costly, will 
always be played (since for Bellman's equations V(x) = maXaEA(x) Q(X1 a))' John's 
suggestion is to take into account the fact that the policy 7r(x) played at state x 
is a function of the Q values at state x, so that writing7r(x, a) for the probability 
of playing action a at state x, the Q value formulation of Bellman's equations 
becomes 
Q(x, a) = r(x, a)+ JEP,,, (a)V(y) 
=E 7r (x, a) Q (x, a), for all x and a. 
aiEA(X) 
7.1. Error-based methods are eximnsive 
Now V(x) represents the'expccted Q value' at state z, and Q(z, a) gives tile actual 
expected future discounted reward if action a is played and then policies 7r(x) arc 
followed (as opposed to the maximal expected future discounted reward, which is 
obtained when V(x) = max,, EA(z) Q(x, a)). Under the kind of learning algorithm 
we have been studying (other than in Chapter 6), smooth best responses will be 
played for all time, and so again if the Q values (anti V values) are to represent tile 
expected future reward to be received we must use V(x) = E., eA(, ) 7r(x, a)Q(x, a). 
Ilowcvcr Littman (1996) observed that if Boltzmann smooth best responses are 
played there may not even be a unique solution to the modified Hellman equations 
(7.1). This is because the map Q -+ V with Boltzmann smooth best responses 
is not contracting (with respect to the L,,,, norm). We arc therefore interested in 
smooth best responses 7r such that this map is non-expansive. 
Two methods of choosing smooth best responses have been proposed: McNa- 
mara et al. (1997) use a model where players make errors, and tile probability of 
playing a suboptimal action is a function of the loss induced by doing so, whereas 
Fudenberg and Kreps (1993), based on Ilarsanyi (1973), suggest that players Add a 
random perturbation to their action values before selecting all action to maxinlise 
the perturbed values. We show that non-expansive best responses are impos4ble 
with the former method, but provide sufficient conditions and a noll-cxpansive 
smooth best response function based on Fudenberg and Kreps' model. 
7.1 Error-based inctliods are expansive 
Under the intuitive scheme of McNanlara ct al. (1997), the representation of V(x) 
in (7.1) becomes 
V(X) = 
ZaCA. h(C(Xla))Q(Tfa) 
EAh (c(x, a)) 
where c(x, a) = maxbEAQ(x, b)-Q(x, a) and his a functionsatisfying the following 
properties: 
Chapter 7. Smooth best responses in stochastic games 
o h(c) >0 for all c 
o h'(c) :50 for all c>0, 
o h(c) -+ 0 as c -+ oo. 
These conditions say that the probability of playing any action is positive (h(c) > 
0), but that the probability of playing an action decreases towards 0 as the cost 
c(x, a) of playing that action gets large (h'(c) :50 and h(c) -+ 0 as c -+ oo). 
Since it is required that the smooth best response be non-expansive at all states 
x, in the sequel we will fix x and write q,, = Q(x, a), c. = c(x, a). We will derive 
additional constraints on h that ensure the map q -+ V(q) is a non-expansion, 
where qE R", V(q) 9'h(c') d m, the number of actions, is arbitrary. The E. h(c. ) I- 
set of constraints on h will then prove to be inconsistent, showing that no suitable 
h exists. 
Suppose one of the partial derivatives Ov(') is negative. We see that for some eq. 
sinall 8E R+ 
OV(q) 
<0 V(q + S,, ) < V(q) Dqa 
where 8,, is a vector with 0 in every entry except for a8 in position a. Then, 
V(q + 2S) = V(q) + 2S > V(q + J,, ) + 2S, 
where 8 is a vector of length m with every element equal to J. So 
I V(q+2i)- V(q+8,, )l > 28= II(q+28)-(q+8. )Iloo 
and we have generated an expansion. Therefore a necessary condition for us to get 
a non-expansive inap with respect to the L,,. norm is that the partial derivatives 
2-VI21 be non-negative. 09" 
Now, without loss of generality, assume that q, = max. q., so that c. = q, - q,, 
for each aEA. Therefore we see that 
V(q) = qI _ 
Z, ch(c. ) 
E h(C. ) ' 
7.1. Error-bnsed methods nre eximnsive 
and so, for m>1, 
(9V(q) Jh(em) - omh'(c*ln)) Ea>l h(ca) - h'(c,,,, ) F,,, >2 csh(ce) 7qT =- (E, 
>, h(c. ))' 
Choosing q such that q, = q2 = ... = qm-l = qm + c, the numerator of this 
fraction 
becomes 
lh(c)}' + (m - I)h(O) (h(c) + cli'(c)}. 
Since we require this to be positive for any c and any %alue of tit, this implirs that 
h(c) + ch'(c) 2: 0 Vc 2: 0. (7.2) 
Now, for general q, 
h(c. )) -fZc. h'(c,, )) fZ h(c. )) + 
JZ h'(c, )) JZ c. h(c,, )) h(O)JE 
(9v(q) a>1 a>2 a>I 4>2 a? 2 
Oqj - (E h (c. ) 12 
Setting m 2k + 1, and choosing q such that C2 Ck+I =C and Ck+2 
... = C2k+I d, the numerator becomes 
{h(O)}2 + kh (0) 1h (c) +h (d) - ch'(c) - dh'(d)} +k 
2(tl_ C) {h'(c)h(d) - h'(cl)h(c)), 
and again since we can take k as big as we want we require that 
(d - c) {h'(c)h(d) - h'(d)h(c)) 
be non-negativc for all c and d, i. e. 
Lj(c) 
h'(d) 
h (c) -h (d) 
or equivalently 
h'(c) '<0. (7.3) ( 
Now since h(c) >0 for all c (by assumption), we can write 
h(c) = ef(") for 
some function g. Further, since h is (not necessarily strictly) decrewsing, we must 
have g((x) > 0. Applying condition (7.2) we see that 
-cg'(c) 2: ot 
Chapter 7. Smooth best responses in stochastic games 
and so g'(c) < 1. C 
However, applying condition (7.3) we see that g"(c)  0, and so g'(c) is non- 
decreasing in c. We cannot have g'(c) =- 0, since then the condition h(c) -+ 0 as 
c -+ oo would fail, and so for sufficiently large c we find that g'(c) is bounded 
away from 0. But this contradicts the fact that g'(c) :51, and so there is no such C 
function h. 
This shows that the method of McNamara et al. (1997) cannot result in a non- 
expansive map Q -+ V with respect to the LO,, norm, which is in some sense the 
natural norm to use when considering value iteration. 
7.2 Non-expansive smooth best responses 
Now consider smooth best responses (3.4) in the style of Harsanyi (1973), as used 
for stochastic fictitious play (rudenbcrg and Kreps 1993), and the standard defi- 
nition of the smooth best response dynamics (11ofbauer and Hopkins 2000). As in 
the previous section, we fix x, and write q,, = Q(x, a), and V(q) for the value of 
V(x) resulting from the Q(x, a). We see that 
V(q) = max 
7r(a)q,, +, rv(7r) 
Introduce a Lagrangian multiplier AER so that the maximisation becomes 
max 1: 7r(a)q,, +, rv(7r) +A1-1: 7r(a) 
vrERIA1, AeR 
aGA aEA 
assume that v(7r) (7r(a)), and differentiate with respect to 7r(a) to see that 
P(q)(a) solves 
+ 7Ve((q)(a -A= 
The conditions on v specified in Section 1.1.2 imply that Vb has a smooth inverse 
function h which is strictly decreasing and positive, and so 
P(q)(a) 
7.2. Non-expansive smooth best responses 
where A is chosen so that 
ZaEA P(q)(a) = 1. 
We investigate how to choose h (and hence v) such that the resultant P is a non- 
expansive smooth best response, approaching the problem by trying to maximise 
JV(q) - V(q')l for fixed arbitrary q, under the constraint that JJq - q'11,. < D; if 
this maximal value is no greater than D then we are done. 
If Ov() >0 for all q then it is clear that V(q) is maximised, subject to our 
constraints, by taking q,, = q'(a) +D for each aE it, at which point V(q) 
V(q') + D. Similarly, V(q) takes a minimum value of V(q) -D when q. = q(a) -D 
for all aEA. So 
21 >0 for all q is a sufficient condition to get a non-expansive i9qa - 
map. As before, Ov(') >0 is also a necessary condition for the in-, q) q -+ V(q) to 8q. - 
be non-expansive. 
Now, differentiating the condition EbEAh(r-'(A - rl&)) =I with respect to q. 
gives 
OA h'(r- I (A - q. )) 
c9q, - EbCA hl(, r- I (A - qb)) 
Since V(q) = Eb h(r-1 (A - qb))qb, it follows that 
OV(q) 
=h(r-'(A q,, )) r-lh'(r-(A - q. 
+ r-I'OA 
E h'(r-'(A - qb))q6 Oq" 
=h(r-'(A - q,, )) + r-(A - q. )h(r- 
'(A - 9. )) 
1 h'(r-(A q. )) 
A h(r- 
I (A - qb))(16 A 
ZbEA hl(r- I (A - qb)) 
This is perhaps easier to read if we write 2 = r-' (A - q. ). Then 
OV(q) 
h(6. ) + a. h(. ) - h(2,, ) 
A h(4)4 
Oq,, &C A h'(4) 
As we have shown, if this is non-negative for all q then we 
have a non-'expinsive 
map. Recalling that h1(c) <0 for all c, sufficient conditions 
for this to be non- 
negative for any q are that A ': :q, 
for all a and h(c) + chl(c)  0 for all c. 
Using this formulation, and taking (v(a)) = log(7r(a)) so that h(c) = c-1, 
follows that this results in a non-expansive map. Therefore we 
have shown Ihat 
Chapter 7. Smooth best responses in stochastic games 
non-expansive distributions exist, even if they may not be particularly practical 
(A for this model is the solution of a degree JAI polynomial). 
Incidentally, taking h(c) = e-c gives the Boltzmann distribution. Notice that 
h(c) + ch'(c) = (1 - c)e', which can clearly be negative. From this, it is easy to 
construct examples where the map q -+ V(q) is expansive. 
7.3 Conclusion 
Wc have considered a modification of Bellman's equations for MDPs where play- 
ers accept that they will not play optimally. This means that the possibility of 
experimenting with potentially disastrous outcomes will be factored into the value 
functions. However, it is not clear that there is a unique smooth best response to a 
fixed environment under these conditions (nor even that there is a unique solution 
to the modified Bellman equations (7.1)). 
NVc showed that there is no form of smooth best response in the style of McNa- 
inara et al. (1997) which results in a non-expansive map with respect to the L,, 0 
norin for general action spaces. 
On the other liand, we showed that using the formulation of Fudenberg and 
Kreps (1993) we can construct a non-expansive smooth best response. Using 
these non-expansive smooth best responses means that there is a unique solu- 
tion of the modified Bellman equations (7.1) for a fixed Markovian environment 
(Littnian 1996). 
However, this is not sufficient to prove directly that there is a unique Nash 
distribution of Markov games; perhaps by using a suitable weighted maximum 
norin based on the rewards of the game (see Section 1.3.1) the extension to 2- 
player zero-sum stochastic games could be achieved. 
Chapter 8 
Further work 
8.1 Actor-critic algorithins 
Two-timcscales stochastic approximation is a natural tool to study actor-critic 
learning algorithms, and asynchronous versions of the b. Lsic technique have 1XVII 
studied by X'onda and Borkar (2000) and Borkar (2001). This suggests studying 
a simple extension of the actor-critic algoritlan of Chapter 3 which is applicable 
in stochastic games. In this situation, the policy will be c%-aluated using Cithcr Q. 
learning (which is off-policy) or SARSA (the on-policy e(juh-Alctit) thell updating 
strategies using a smooth best response to the current Q values. However, the 
interaction between states introduces complications into the resultant differential 
equations, and a direct analysis using the techniques of Borlar (1998) has thus far 
proved elusive. 
8.2 Q-1carning 
Similar issues arise when we try to gencralise dic individual Q-1carning algorithill of 
Chapter 5 to stochastic games. However, for 2-player zero-suin stochastic games, 
since a normal form game has a unique Nash distribution, a generalis. 1tion of 
Szepcsviri and Littman's result is highly promising, although interaction betwt-vu 
Chapter 8. Further work 
the players prevents an immediate application. 
A further extension of our analysis of individual Q-learning would be to show 
that this algorithm will converge to Nash distribution values for any games in 
which the chain-recurrent set of the smooth best response dynamics consists solely 
of Nash distributions. Since we have shown that trajectories of the Q-1earning 
ODE (5.2) are asymptotic pseudotrajectories of a serniflow closely related to the 
smooth best response dynamics, I believe this is more of a notational extension 
than anything more fundamental. 
8.3 Multiple-timescales learning 
Niultiplc-timcscales learning, in both the actor-critic and Q-learning formulations, 
is a development allowing the algorithms to converge in games for which few (if 
any) previous learning algorithms (or evolutionary processes) are known to con- 
verge. It is crucial to the theoretical study of multi ple-timescales stochastic pro- 
cesses that the fast processes can be shown to converge to unique fixed points for 
fixed values of the slow processes. There are two complementary areas of fruitful 
research here: studying methods of showing that the fast processes converge to 
unique fixed points, perhaps by extending the graphical analysis of Section 4.5, 
will assist in application of the current theory, while studying what will happen 
if there are multiple fixed points of the fast systems, probably by relating the 
stochastic approximation to the theory of singularly perturbed dynamical systems 
(Jones 1995), might allow the application of the techniques to a wider range of 
systems. 
It is also clearly of interest to extend our multi ple-timescales learning algorithms 
to stochastic games. Very similar issues arise here as have been discussed with 
respect to the previous extensions to stochastic games. 
8.4. Discontinuous algorithms 
8.4 Discontinuous algorithins 
Perhaps the area with greatest immediate promise is the study of discontinuous 
processes, such as the discontinuous actor-critic algorithm of Chapter 6. We have 
shown that these can be studied using ideas closely related to stochastic approxi- 
mation, and even that a two-timescales approach is fe-asible. Although tile ad hoe 
nature of the present approach to discontinuous systems is not wholly satisractory, 
Delyon (1996) and Tadi6 (1998) have developed a theory of stochastic approxi- 
mation with discontinuous dynamics, and llorbaucr and Sorin (2002) suggest that 
they arc preparing a paper, along with Benalim, which will extend Dena"im"s meth- 
ods of stochastic approximation to cover differential inclusions as well as tile simple 
ordinary differential equations covered by Beneim (1999). It is hoped that these 
general results can be extended to two titnescales. 
The work of Chapter 6 can be trivially extended to include a version of the 
actor-critic algorithm of Chapter 3 in which each player adjusts their strategy 
towards a smooth best response to the Q values, but with %, anishing temperature 
parameters in the limit. Further, a modification of stochastic fictitious play in 
which the smooth best responses arc calculated using ranishing temperatures call 
be studied in this framework too; it is clear that the beliefs will converge to a Nash 
equilibrium, but of more interest (and less obvious) is whether tile strategies or 
the players must converge. 
In Chapter 5 we showed that individual Q-1carning with fixed temperature 
smooth best responses is closely related to the smooth best reipotow dynamic. It 
is clearly of interest whether an asymptotically optimal version or this algorithm, 
where in the limit the players only play actions which maximi th Q %a ,C st, C- 
IUC All 
be shown to relate in some meaningful way to the best response dynamics. If this 
can be extended to stochastic games, it would justify a naive implementation of 
standard Q-1carning in a multi-agcnt setting. 
Chapter 8. nrtlier work 
8.5 Convergence-rate analysis 
A final area of research that has not been considered in this thesis is the rate of 
convergence of the algorithms. Although we have frequently shown that the limit 
sets of strategies will be contained in the set of Nash distributions, or the set of 
Nash equilibria, there is no indication of how long this convergence might take. 
Indeed the numerical results suggest that several million iterations is not sufficient 
for the strategies to be even particularly close to the equilibrium (for example 
Fig. 5.1). IConda and Tsitsiklis (2002) have studied some issues relating to the 
convergence rate of two-timescales stochastic approximation, but if algorithms are 
to be applied in real-world multi-agent settings it is important that progress be 
made to assist in the choosing of learning parameters for unknown environments. 
Bibliography 
Akin, E. and V. Losert (1984). Evolutionary dynamics of zero-sum games. Jour. 
nal of Mathematical Biology 20,231-258. 
Aubin, JA. and A. Cellina (1984). Differential Inclusimm. New York: Springer- 
Verlag. 
Auer, P., N. Cesa-Bianchi, Y. Freund, and It. E. Schapire (1995). Gambling in a 
rigged casino: the adversarial multi-armed bandit problem. In 361h Annual 
Symposium on Foundations of ComputerScience, pl). 322-331. IA)s Alamitos, 
CA: IEEE Press. 
Bafios, A. (1968). On pscudo-garnes. The Annab of Mathematical Statistics 30, 
1932-1945. 
Bellman, R. (1952). On the theory of dynamic programming. Promdings of the 
National Academy of Sciences of the United States of Arnfric, 4 38,716-719. 
BcnaTm, Al. (1999). Dynamics or stocliastic approximation algorithms. In Ix 
Seminaire de Probabilites, Voluine 1709 of Lcclurt Xotts in iiaihrtitaties. 
New York: Springer-Verlag. 
BenaTm, M. and At. W. Ifirsch (1999). Mixed equilibria and dyn. -unical isys. 
tems arising from fictitious play in perturbed games. Gaines and L'conorrsic 
Behaviour 29,36-72. 
Bcneim, M., J. Holbatier, and S. Sorin (2003). Stoclimstic approximations and 
differential inclusions. Available at http: //www. unine. ch/math/ 
BIBLIOGRAPHY 
Personnel/equipes/benaim/benaim-pers/bhs. pdf . 
Bergcr, U. (2003). Fictitious play in 2xm games. Ordinariat VW 5 Discussion 
Paper 0301, Vienna University of Economics. Presented at the 2003 Game 
Theory Festival at Stonybrook. 
Dertselcas, D. P. and J. N. Tsitsiklis (1996). Neuro-Dynamic Programming. Bel- 
mont, NIA: Athena Scientific. 
116rgers, T. and R. Sarin (1997). Learning through reinforcement and replicator 
dynamics. Journal of Economic Theory 77,1-14. 
Borkar, V. S. (1997). Stochastic approximation with two time scales. Systems 
and Control Letters 29,291-294. 
Borkar, V. S. (1998). Ashyncronous stochastic approximations. SIAM Journal 
of Control and Optimization 36,840-851. 
Borkar, V. S. (2001). Reinforcement learning in Markovian evolutionary games. 
Available at http: //www. tcs. tifr. res. in/-borkar/game. ps. 
Bowling, NI. (2000). Convergence problems of general-sum multiagent reinforce- 
merit learning. In Proceedings of the Seventeenth International Conference 
on Alachine Lcarning, pp. 89-94. San Francisco, CA: Morgan Kaufmann. 
Bowling, M. and NI. Veloso (2002). Multiagent learning using a variable learning 
ratc. Artificial Intelligence 136,215-250. 
Boyan, J. A. and NI. L. Littman (1994). Packet routing in dynamically changing 
networks: A reinforcement learning approach. In J. D. Cowan, G. Tesauro, 
and J. Alspector (Eds. ), Advances in Neural Information Processing Systems, 
Volume 6, pp. 671-678. San Francisco, CA: Morgan Kaufmann. 
Bran(Ure, 0. (1998a). The dynamic system method and the traps. Advances in 
Applied Probability 30,137-151. 
Bran(Ure, 0. (1998b). Somc pathological traps for stochastic approximation. 
SIAM Journal of Control and Optimization 36,1293-1314. 
BIBLIOGRAPHY 
Brown, G. NV. (1951). Iterativc solution of gaines by fictitious play. In T. C. 
Koopmans (Ed. ), Activity Analysis of Production and Allocation, pp. 374- 
376. New York: John Wiley k, Sons, Inc. 
Bush, R. It. and F- Mosteller (1951). A mathematical model ror simple learning. 
Psychological Review 58,313-32: 3. 
Chen, II. -F. and YAT. Zhu (1986). Stochastic approximation proct4lures with 
randomly varying truncations. Scietatia SifliC4, Series A 20,914-92G. 
Claus, C. and C. Boutilier (1998). The dynamics or reinforcement learning in co- 
operative multiagcnt systems. In Procccilings of the Fifteenth National Con. 
ference on Artificial liddliguice (A. 4.41-98) and the Tcrith Confirence on 
Innovative Applicationi of Artificial liddligcricc pp. 74-IG-752. 
Menlo Park, CA: AAAI Press. 
Cowan, S. (1992). DynamicalSysterns A rising front Ganic Throry. 11h. 1). thesis, 
Univcrsity of Calirornia, Ilcrkeley. 
Crites, It. 11. and A. 0. Ilarto (1995). An actor/critic algorithm that is equi%-alent 
to Q-1carning. In G. Tesauro, 1). Touretzky, and r. IA-en (Eds. ), Advances in 
Neural Information Processing Systons, Volume 7, pp. 401 -108. Cambridge, 
AIA: MIT Press. 
Crites, It. 11. and A. G. Barto (1998). E. 1crator group control using multiple 
reinforcement learning agents. Alachiric Lcanting 33,235-262. 
Delyon, B. (1996). General reitilts on the convergence of stochastic algorithms. 
IEEE nansactions on A utornalic Control . 11,12,15-1255. 
Filar, J. and I*%'. Vricze (1997). Compaitive Atarkou Dccision I'mysscs. New 
York: Springer-WrIng. 
roster, D. 1. and It. V. Volira (1997). Calibrated learning and cormlated "jui- 
libriuin. Games and Economic Behavior 21,40-35. 
BIBLIOGRAPHY 
Foster, D. P. and R. V. Vohra (1998). Asymptotic calibration. Biometrika 85, 
379-390. 
Foster, D. P. and R. V. Vohra (1999). Regret in the on-line decision problem. 
Games and Economic Behavior 29,7-35. 
Fudenberg, D. and D. M. Kreps (1993). Learning mixed equilibria. Games and 
Economic Behavior 5,320-367. 
Fudenberg, D. and D. K. Levine (1998). The Theory of Learning in Games. 
Cambridge, MA: MIT Press. 
Fudenberg, D. and D. K. Levine (1999). Conditional universal consistency. 
Games and Economic Behaviour 29,104-130. 
Fudenberg, D. and J. Tirole (1991). Game Theory. Cambridge, MA: MIT Press. 
Gaunersdorfer, A. and J. Hofbauer (1995). Fictitious play, Shapley polygons, 
and the replicator equation. Games and Economic Behavior 11,279-303. 
Gilboa, I. and A. Matsui (1991). Social stability and equilibrium. Economet- 
rica 59,859-867. 
Govindan, S., P. J. Reny, and A. J. Robson (2003). A short proof of Harsanyi's 
purification theorem. Games and Economic Behavior 45,369-374. 
Hannan, J. (1957). Approximation to Bayes risk in repeated play. In 
M. Drescher, A. W. Tucker, and P. Wolfe (Eds. ), Contributions to the theory 
of games, Vol. 3, Volume 39 of Annals of Mathematical Studies, pp. 97-139. 
Princeton University Press. 
Ilarsanyi, J. C. (1973). Games with randomly disturbed payoffs: A new ratio- 
nale for mixed-strategy equilibrium points. International Journal of Game 
Theory 2,1-23. 
Harsanyi, J. C. and R. Selten (1988). A General Theory of Equilibrium Selection 
in Games. Cambridge, MA: MIT Press. 
BIBLIOGRAPHY 
Hart, S. and A. Mas-Colell (2000). A simple adaptive procedure leading to 
correlated equilibrium. Economeirica 68,1127-1150. 
Hart, S. and A. Mas-Colell (2001a). A general class of adaptive strategies. Jour- 
nal of Economic Theory 98,26-54. 
Hart, S. and A. Mas-Colell (2001b). A reinforcement Procedure leading to cor- 
related equilibrium. In W. N. G. Debreu and W. Trockel (Dis. ), Econontic 
Essays: A Festschrift for Werner Hildenbrand, pp. 181-200. New York: 
Springer-Verla, g. 
Hart, S. and A. Nfas-Colell (2003). Uncoupled dynamics cannot lead to Nash 
equilibrium. American Economic Review 23,1830-1836. 
11ofbauer, J. (1995). Stability for the best response dynamics. Technical report, 
Institut fr Mathematik, Universitt Wien, Strud1hofgasse 4, A-1090 Vi. 
enna, Austria. 
Ilofbauer, J. (1996). Evolutionary dynamics for bimatrix games: A Hamiltonian 
system? Journal of Mathematical Biology 34,675-688. 
11ofbauer, J. (2000). From Nash and Brown to Maynard Smith: Equilibria, 
dynamics, and ESS. Selection 1,81-88. 
Hofbauer, J. and E. Hopkins (2000). Learning in perturbed asymmetric games. 
Available at http: //www. ed. ac. uk/-ehk/perturb. pdf. 
11ofbaucr, J. and W. 11. Sandliolm (2002). On the global convergence of stochas- 
tic fictitious play. Economdrica 70,2265-229-1. 
Ilofbauer, J. and 11C. Sigmund (1998). Evolutionary Games and Population Dy- 
namics. Cambridge University Press. 
Ilofbauer, J. and S. Sorin (2002). Best response dynamics for continuous zero- 
sum games. Technical Report 2002-028, Laboratoire d'econoinctric, Ecole 
Polytechnique. 
BIBLIOGRAPHY 
Ilofbauer, J. and J. W. Weibull (1996). Evolutionary selection against dominated 
strategies. Journal of Economic Theory 71,558-573. 
Hopkins, E. (1999). A note on best response dynamics. Games and Economic 
Behavior 29,138-150. 
11u, J. and M. P. Wellman (1998). Multiagent reinforcement learning: Theoreti- 
cal framework and an algorithm. In Proceedings of the Fifteenth International 
Conference on Alachine Learning, pp. 242-250. San Francisco, CA: Morgan 
Kaufmann. 
Jaakkola, T., M. I. Jordan, and S. Singh (1994). On the convergence of stochastic 
iterative dynamic programming algorithms. Neural Computation 6,1185- 
1201. 
John, G. 11. (1994). When the best move isn't optimal: Q-learning with explo- 
ration. In Proceedings of the National Conference on Artificial Intelligence 
(AAAI-94). Menlo Park, CA: AAAI Press. 
Jones, C. K. R. T. (1995). Geometric singular perturbation theory. In Dynamical 
Systems, Volume 1609 of Lecture Notes in Mathematics, pp. 44-118. Berlin: 
Springer-Vcrlag. 
Jordan, J. S. (1993). Three problems in learning mixed strategy equilibria. 
Games and Economic Behavior 5,368-386. 
Malal, E. and E. Lehrer (1993a). Rational learning leads to Nash equilibrium. 
Econometrica 61,1019-1045. 
11[alai, E. and E. Lehrer (1993b). Subjective equilibrium in repeated games. 
Econometrica 61,1231-1240. 
II'Loller, D. and B. Milch (2003). Multi-agent influence diagrams for representing 
and solving games. Games and Economic Behavior 45,181-221. 
I'Conda, V. It. and V. S. Borkar (2000). Actor-critic-type learning algorithms for 
Nfarkov decision process. SIAM Journal on Control and Optimization 38, 
BIBLIOGRAPHY 
94-123. 
Konda, V. R. and J. N. Tsitsiklis (2002). Convergence rate of two-time-scalc 
stochastic approximation. Submitted to Annals of Applicd Probability, March 
2002. 
Kushner, 11. J. and D. S. Clark (1978). Stochastic Approximation jildhods for 
Constrained and Unconstrained Systems. New York: Springer-Verlag. 
Kushner, 11. J. and G. G. Yin (1997). Stochastic Approximation Algorithms and 
Applications. New York: Springer-Verlag. 
Leslie, D. S. and E. J. Collins (2003). Convergent inultipic-timescales reinforce- 
ment learning algorithms in normal form games. Annals of Applied Proba. 
bility 13,1231-1251. 
Littman, M. L. (1996). Algorithms for Sequential Decision Making. Ph. D. flicsis, 
Department of Computer Science, Brown University, Providence, 111. 
Littman, M. L. and P. Stone (2001). Implicit negotiation in repeated games. 
In J. -J. Ch. Meyer and N1. Tambe (Eds. ), Intelligent Agcrits V111. Agent 
Theories, Architectures, and Languages, Volume 2333 or Lecture Notes in 
Computer Science, pp. 393-40-1. New York: Springer-Verlag. 
Littman, A L. and C. Szcl)csviri (1996). A generalized reinforcement-learning 
model: Convergence and applications. In L. Saitta (Ed. ), Procccdings of the 
Thirteenth International Conference on Afachine Learving, pl). 310-318. San 
Francisco, CA: Morgan K'atifinann. 
Littman, At. L., At. Nearns, and S. Singh (2001). An efficient, exact algorithin, for 
solving trec-structured graphical gamcs. In T. G. Dietterich, S. Becker, and 
Z. Gliahramani (Eds. ), Advances in Neural Information Processing Systems, 
Volume 14. Cambridge, AIA: MIT Press. 
Ljung, L. (1977). Analysis of recursive stochastic algorithins. NEW, 7ansactions 
on Automatic Control 22,551-575. 
BIBLIOGRAPHY 
Maynard Smith, J. (1982). Evolution and the Theory of Games. Cambridge 
University Press. 
McNamara, J. M., J. N. Webb, E. J. Collins, T. Sz6kely, and A. I. Houston 
(1997). A general technique for computing evolutionarily stable strategies 
based on errors in decision-making. Jounal of Theoretical Biology 189,211- 
Megiddo, N. (1980). On repeated games with incomplete information played by 
non-Bayesian players. International Journal of Game Theory 9,157-167. 
Milgrom, P. and J. Roberts (1991). Adaptive and sophisticated learning in nor- 
mal form games. Games and Economic Behavior 3,82-100. 
Monderer, D. and L. S. Shapley (1996). Fictitious play property for games with 
identical interests. Journal of Economic Theory 68,258-265. 
Narendra, K. S. and M. A. L. Thathachar (1989). Learning Automata: An 
Introduction. Englewood Cliffs, NJ: Prentice-Hall. 
Nash, 1 (1950). Equilibrium points in n-person games. Proceedings of the Na- 
tional Academy of Sciences of the United States of America 36,48-49. 
Nash, J. (1951). Non-cooperative games. Annals of Mathematics 54,286-295. 
Pernantle, R. (1990). Nonconvergence to unstable points in urn models and 
stochastic approximations. Annals of Probability 18,698-712. 
Plank, M. (1997). Some qualitative differences between the replicator dynamics 
of two player and n player games. Nonlinear Analysis, Theory, Methods & 
Applications 30,1411-1417. 
l'uterman, M. L. (1994). Alarkov Decision Processes: Discrete Stochastic Dy- 
namic Programming. Chichester: John Wiley & Sons, Inc. 
Ritzberger, K. and I W. Weibull (1995). Evolutionary selection in normal form 
games. E"conometrica 63,1371-1399. 
BIBLIOGRAPHY 
Robbins, Il. and S. Monro (1951). A stochastic approximation mcthod. Annals 
of Mathematical Statistics 22,400-407. 
Robinson, J. (1951). An itcrative method of solving a gamc. Annals of Alathe- 
matics 54,296-301. 
Ross, S. M. (1982). Introduction to stochastic dynamic programming. New York: 
Academic Press. 
Rummery, G. A. (1995). Problem Solving with Reinforcement Learning. Ph. D. 
thesis, Cambridge University. 
Sato, Y. and J. P. Crutchfield (2002). Coupled replicator equations for the dy- 
namics of learning in multiagent systems. Technical Report 02-0.1-017, Santa 
Fe Institute. 
Schraudolph, N. N., P. Dayan, and T. J. Scjnowski (199-1). Temporal differ- 
ence learning of position evaluation in the game of go. In J. D. Cowan, 
G. Tesauro, and J. Alspcctor (Eds. ), Advances in Neural Information Pro. 
cessing, Volume 6, pp. 817-824. San rrancisco, CA: Morgan Kaufmann. 
Schuster, K. P. and I'%'. Sigmund (1981). Coyness, philandering and stable strate- 
gics. Animal Behavior 29,186-192. 
Shapley, L. S. (1953). Stochastic games. Proceedings of the National Academy 
of Sciences of the United States of America 39,1093-1100. 
Shaplcy, L. S. (1964). Some topics in two person games. In Nt. Drescher, L. S. 
Shapley, and A. W. Tucker (Eds. ), Advances in Game Theory. Princeton 
Univcrsity Press. 
Singh, S. and D. Bertsekas (1997). Reinforcement learning for dynamic chan- 
nel allocation in cellular telephone systems. In At. C. Mozer, M. 1. Jordan, 
and T. Petsche (Eds. ), Advances in Neural Informaiion Processing Systems, 
Volume 9, pp. 974. Cambridge, AM MIT Press. 
BIBLIOGRAPHY 
Singh, S. and R. S. Sutton (1996). Reinforcement learning with replacing eligi- 
bility traces. Alachine Learning 23,123-158. 
Singh, S., T. Jaakkola, M. L. Littman, and C. Szepesvari (2000). Convergence 
results for single-step on-policy reinforcement-learning algorithms. Machine 
Learning 38,287-308. 
Singh, S., M. Kearns, and Y. Mansour (2000). Nash convergence of gradient dy- 
namics in general-sum games. In Uncertainty in Artificial Intelligence (UA1): 
Proceedings of the 16th Conference (UAI'00). San Francisco, CA: Morgan 
Kaufmann. 
Stone, P. (2000). Layered Learning in Alultiagent Systems: A Winning Approach 
to Robotic Soccer. Cambridge, MA: MIT Press. 
Sutton, R. S. (1988). Learning to predict by the method of temporal differences. 
Machine Learning 3,9-44. 
Sutton, It. S. and A. G. Barto (1998). Reinforcement Learning: An Introduction. 
Cambridge, MA: MIT Press. 
Szcpcsvari, C. and M. L. Littman (1999). A unified analysis of value-function- 
based reinforcement-learning algorithms. Neural Computation 11,2017- 
2059. 
Tadi6, V. (1998). Stochastic approximation with random truncations, state- 
dependent noise and discontinuous dynamics. Stochastics and Stochastics 
Reports 64,283-326. 
Tesauro, G. (1994). TD-gammon, a self-teaching backgammon program, 
achieves master-level play. Neural Computation 6,215-219. 
Thorndike, E. (1898). Some experiments on animal intelligence. Science 7,818- 
Van der Gcnugten, B. (2000). A weakened form of fictitious play in two-person 
zero-sum games. International Game Theory Review 2,307-328. 
BIBLIOGRAPHY 
Von Neumann, J. (1928). Zur Theoric der Gcscllscliaftsspicle. Afathematische 
Annalen 100,295-320. 
Von Neumann, J. and 0. Morgenstern (1953). Theory of games arid economic 
behavior. Princeton University Press. 
Vrieze, 0. J. and S. II. Tijs (1982). Fictitious play applied to sequences of games 
and discounted stochastic games. International Journal of Garne Thcory 11, 
71-85. 
Watkins, C. J. C. If. and P. Dayan (1992). Q-1carning. Alachine Lrarving 8, 
279-292. 
Watkins, C. J. 11. (1989). Learning from Delaycd Rewards. Ph. D. thesis, Cam- 
bridge University. 
Williams, R. J. and L. C. Baird (1993). Analysis of some incremental variants of 
policy iteration: First steps toward understanding actor-critic learning sys- 
tems. Technical Report NU-CCS-93-11, College of Computer Science, North- 
eastern University. 
UN RS 
)F BRISTOL i 

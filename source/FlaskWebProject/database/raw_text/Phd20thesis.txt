University of Southampton Research Repository
ePrints Soton
Copyright  and Moral Rights for this thesis are retained by the author and/or other 
copyright owners. A copy can be downloaded for personal non-commercial 
research or study, without prior permission or charge. This thesis cannot be 
reproduced or quoted extensively from without first obtaining permission in writing 
from the copyright holder/s. The content must not be changed in any way or sold 
commercially in any format or medium without the formal permission of the 
copyright holders.
 When referring to this work, full bibliographic details including the author, title, 
awarding institution and date of the thesis must be given e.g.
AUTHOR (year of submission) "Full thesis title", University of Southampton, name 
of the University School or Department, PhD Thesis, pagination
http://eprints.soton.ac.uk
http://eprints.soton.ac.uk/
Faculty of Engineering and the Environment
Computer simulation studies of
complex magnetic materials
by Weiwei Wang
Thesis for the degree of
Doctor of Philosophy
Supervisors: Prof. Hans Fangohr, Dr. Ian Hawke
October 2015
UNIVERSITY OF SOUTHAMPTON
ABSTRACT
FACULTY OF ENGINEERING AND THE ENVIRONMENT
Doctor of Philosophy
COMPUTER SIMULATION STUDIES OF COMPLEX MAGNETIC MATERIALS
by Weiwei Wang
With the development of both computing power and software engineering, computer
simulation of the micromagnetic model or atomistic spin model, has become an impor-
tant tool for studying a wide range of different complex phenomena in magnetic ma-
terials. Meanwhile, the rapid improvement of advanced measurement techniques has
allowed the probing of ultrafast magnetization dynamics, as well as the magnetic phe-
nomena involving charge current, heat and light. The simulation of magnetism is now
moving towards a multiphysics method. Therefore, fast, user-friendly, and extensible
codes with accurate algorithms are helpful in understanding the physics and designing
novel magnetic devices on the nanoscale.
In the preparation of this thesis we have developed Fidimag, which is a Python/C sim-
ulation tool supporting both micromagnetic and atomistic spin models. The software
has also been extended to support the Landau-Lifshitz-Baryakhtar (LLBar) equation.
Using Fidimag, we have performed simulations to study the domain-wall motion and
spin-wave decaywith the LLBar equation. We also explain the exchange damping in the
LLBar equation as the phenomenological nonlocal damping by linking it to spin pump-
ing, therefore, LLBar equation can be considered as a phenomenological equation of the
nonlocal damping.
We studied magnon-induced domain-wall motion in the presence of Dzyaloshinskii-
Moriya interaction (DMI) numerically and theoretically. We find that the presence of
DMI and easy-plane anisotropy can drive the domain wall very effectively and that the
domain-wall velocity depends on the sign of DMI constant. While the negative velocity
is considered as a result of angular momentum conservation, we attribute this fast
domain-wall motion to linear momentum transfer between magnons and the domain
wall. By numerically solving the Landau-Lifshitz-Gilbert equation with a classical
spin model on a two-dimensional system, we show that both magnetic skyrmions and
skyrmion lattices can be moved with microwave magnetic fields. The mechanism is
enabled by breaking the axial symmetry of the skyrmion with a static in-plane external
field.
Contents
Declaration of Authorship xi
List of publications xii
Acknowledgements xiii
1 Introduction 1
1.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.2 Structure of this thesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
2 Micromagnetic and Atomistic modeling 5
2.1 Magnetic moments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2.2 Equation of Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2.3 Interactions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
2.3.1 Exchange interaction . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2.3.2 Dzyaloshinskii-Moriya interaction (DMI) . . . . . . . . . . . . . . 8
2.3.3 Dipolar interaction . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.3.4 Anisotropy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.3.5 Zeeman energy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
2.4 Atomistic spin model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
2.5 Micromagnetics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
2.5.1 Exchange energy . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
2.5.2 Magnetostatic energy . . . . . . . . . . . . . . . . . . . . . . . . . 14
2.5.3 Dzyaloshinskii-Moriya Energy . . . . . . . . . . . . . . . . . . . . 15
2.6 Landau-Lifshitz-Gilbert (LLG) equation . . . . . . . . . . . . . . . . . . . 16
2.6.1 Spherical form of LLG equation . . . . . . . . . . . . . . . . . . . . 17
2.6.2 Spin transfer torque . . . . . . . . . . . . . . . . . . . . . . . . . . 18
2.6.3 Nonlocal spin transfer torque . . . . . . . . . . . . . . . . . . . . . 19
2.7 Finmag and Fidimag . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
3 Fidimag 21
3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
3.2 Fast Summation of Dipolar interactions . . . . . . . . . . . . . . . . . . . 22
3.2.1 Fast Summation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
3.2.2 Dipolar interaction in triangular lattice . . . . . . . . . . . . . . . 23
3.3 Landau-Lifshitz-Baryakhtar equation . . . . . . . . . . . . . . . . . . . . 24
3.4 Eigenvalue Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
3.5 Verification I . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
vi CONTENTS
3.5.1 A magnetic moment under an external magnetic field . . . . . . . 27
3.5.2 Domain-wall motion under charge currents . . . . . . . . . . . . . 27
3.5.3 Magnetic skyrmions . . . . . . . . . . . . . . . . . . . . . . . . . . 30
3.5.4 Normal modes of a spin chain . . . . . . . . . . . . . . . . . . . . 32
3.6 Stochastic LLG equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
3.7 Verification II . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
3.7.1 A magnetic moment . . . . . . . . . . . . . . . . . . . . . . . . . . 35
3.7.2 Equilibrium distribution of a nanoparticle . . . . . . . . . . . . . 36
3.7.3 Magnon temperature . . . . . . . . . . . . . . . . . . . . . . . . . . 36
4 Phenomenological description of nonlocal damping 39
4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
4.2 Basic equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
4.3 Spin-wave decay . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
4.4 Domain-wall motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
4.4.1 Parallel relaxation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
4.4.2 Nonlocal damping . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
4.5 Ferromagnetic resonance (FMR) . . . . . . . . . . . . . . . . . . . . . . . . 54
4.6 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction 57
5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
5.2 The system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
5.3 Domain-wall profile and Spin-wave excitation . . . . . . . . . . . . . . . 59
5.4 Domain-wall motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
5.5 Two types of domain walls . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
5.6 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
6 Driving magnetic skyrmions with microwave fields 69
6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
6.2 The system and asymmetric skyrmions . . . . . . . . . . . . . . . . . . . 70
6.3 Spin waves modes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
6.4 Skyrmion motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
6.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
7 Conclusion and Outlook 79
7.1 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
7.2 Outlook . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
A.1 Section A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
A.2 Section B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
A.3 Section C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
A.4 Section D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
B Using discontinuous Galerkin Methods 85
B.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
B.2 Laplace operator using CG method . . . . . . . . . . . . . . . . . . . . . . 85
CONTENTS vii
B.3 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
B.3.1 H(div) space . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
B.3.2 BDM space . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
B.3.3 Piola mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
B.4 Using BDM space . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
B.5 MFMFE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89
B.6 A Test . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89
C Treecode for Boundary Element Method 91
C.1 General problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91
C.2 Treecode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91
C.2.0.1 Particle-cluster interactions . . . . . . . . . . . . . . . . . 92
C.2.0.2 Recurrence relations of Taylor coefficients . . . . . . . . 93
C.2.0.3 Implementation of Treecode . . . . . . . . . . . . . . . . 94
C.2.1 Combine Treecode with FEM/BEM . . . . . . . . . . . . . . . . . 95
C.3 Numerical Tests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96
C.4 Improvement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
C.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
Bibliography 101
List of Figures
2.1 Three heat reservoirs (spin, lattice and electron) model. . . . . . . . . . . 11
3.1 Structure of Fidimag. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
3.2 Triangular lattice embedded in rectangular mesh. . . . . . . . . . . . . . 24
3.3 The procession motion of a magnetic moment. . . . . . . . . . . . . . . . 28
3.4 Domain-wall motion driven by spin transfer torque. . . . . . . . . . . . . 29
3.5 Two types of skymrions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
3.6 Belavin-Polyakov skyrmion. . . . . . . . . . . . . . . . . . . . . . . . . . . 32
3.7 Normal modes of a spin chain. . . . . . . . . . . . . . . . . . . . . . . . . 33
3.8 Average magnetization of a magnetic moment. . . . . . . . . . . . . . . . 35
3.9 Equilibrium distribution of a nanoparticle . . . . . . . . . . . . . . . . . . 36
3.10 Equilibrium magnetization of a spin chain. . . . . . . . . . . . . . . . . . 37
4.1 The spin-wave amplitude decay along a rod. . . . . . . . . . . . . . . . . 46
4.2 Frequency-dependent spin-wave decay. . . . . . . . . . . . . . . . . . . . 47
4.3 Domain-wall velocities with different susceptibilities. . . . . . . . . . . . 49
4.4 Magnetization length difference of a domain wall. . . . . . . . . . . . . . 50
4.5 Domain-wall velocities for different exchange dampings. . . . . . . . . . 53
4.6 Dynamic susceptibility of an elliptical-shaped nanomagnet. . . . . . . . 55
4.7 Fitted damping from dynamic susceptibility. . . . . . . . . . . . . . . . . 55
5.1 Domain-wall profile in the presence of DMI . . . . . . . . . . . . . . . . . 59
5.2 The domain-wall displacements. . . . . . . . . . . . . . . . . . . . . . . . 62
5.3 The domain-wall velocity for K = 0. . . . . . . . . . . . . . . . . . . . . 62
5.4 The domain-wall velocity for K > 0 . . . . . . . . . . . . . . . . . . . . . 63
5.5 The wavevector of magnons changes. . . . . . . . . . . . . . . . . . . . . . 65
5.6 Two types of domain walls. . . . . . . . . . . . . . . . . . . . . . . . . . . 66
6.1 Skyrmion configurations. . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
6.2 Dynamical susceptibility zz of skyrmions. . . . . . . . . . . . . . . . . . 72
6.3 The velocities of a single skyrmion. . . . . . . . . . . . . . . . . . . . . . . 73
6.4 Total spatial force density. . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
6.5 Spatial force density. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
6.6 The velocities of skyrmion lattices. . . . . . . . . . . . . . . . . . . . . . . 77
B.1 An unstructured mesh. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
B.2 Comparison of DG and CG methods. . . . . . . . . . . . . . . . . . . . . . 90
C.1 The particle-cluster interaction. . . . . . . . . . . . . . . . . . . . . . . . . 92
LIST OF FIGURES ix
C.2 Memory usage for Treecode and FK methods . . . . . . . . . . . . . . . . 96
C.3 Relative error comparison. . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
C.4 Comparison of running time. . . . . . . . . . . . . . . . . . . . . . . . . . 98
List of Tables
2.1 Typical transport parameters of soft NiFe alloy. . . . . . . . . . . . . . . . 20
3.1 RK2a scheme. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
3.2 RK2b scheme. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
3.3 RK2c scheme. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
3.4 RK3 scheme. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
6.1 Unit conversion table . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
B.1 Compute matrix in BDM space. . . . . . . . . . . . . . . . . . . . . . . . . 88
C.1 The algorithm of treecode method. . . . . . . . . . . . . . . . . . . . . . . 94
Declaration of Authorship
I, Weiwei Wang, declare that the thesis entitled Computer simulation studies of complex
magnetic materials and the work presented in the thesis are both my own, and have been
generated by me as the result of my own original research. I confirm that:
 this work was done wholly or mainly while in candidature for a research degree
at this University;
 where any part of this thesis has previously been submitted for a degree or any
other qualification at this University or any other institution, this has been clearly
stated;
 where I have consulted the published work of others, this is always clearly
attributed;
 where I have quoted from the work of others, the source is always given. With the
exception of such quotations, this thesis is entirely my own work;
 I have acknowledged all main sources of help;
 where the thesis is based on work done by myself jointly with others, I have made
clear exactly what was done by others and what I have contributed myself;
 parts of this work have been published as: [1], [2] and [3].
List of publications
1. W. Wang, M. Dvornik, M.-A. Bisotti, D. Chernyshenko, M. Beg, M. Albert, A.
Vansteenkiste, B. V. Waeyenberge, A. N. Kuchko, V. V. Kruglyak, and H. Fangohr,
Phenomenological description of the nonlocal magnetization relaxation in magnonics,
spintronics, and domain-wall dynamics, Physical Review B 92, 054430 (2015).
2. W. Wang, M. Albert, M. Beg, M.-A. Bisotti, D. Chernyshenko, D. Corts-
Ortuo, I. Hawke and H. Fangohr, Magnon-Driven Domain-Wall Motion with the
Dzyaloshinskii-Moriya Interaction, Physical Review Letters 114, 087203 (2015).
3. Weiwei Wang, Marijan Beg, Bin Zhang, Wolfgang Kuch and Hans Fangohr, Driv-
ingmagnetic skyrmions withmicrowave fields, Physical ReviewB 92, 020403(R) (2015).
4. Bin Zhang, Weiwei Wang, Marijan Beg, Hans Fangohr and Wolfgang Kuch,
Microwave-induced dynamic switching of magnetic skyrmion cores in nanodots, Applied
Physics Letters 106, 102401 (2015).
5. P. J. Metaxas, M. Sushruth, R. A. Begley, J. Ding, R. C. Woodward, I. S. Maksymov,
M. Albert, W. Wang, H. Fangohr, A. O. Adeyeye, and M. Kostylev, Sensing mag-
netic nanoparticles using nano-confined ferromagnetic resonances in a magnonic crystal,
Applied Physics Letters 106, 232406 (2015).
6. Simone Borlenghi, Weiwei Wang, Hans Fangohr, Lars Bergqvist and Anna Delin,
Designing a spin-seebeck diode, Physical Review Letters, 112, 047203 (2014).
7. D. Kumar, P. Sabareesan, W. Wang, H. Fangohr and A. Barman, Effect of Hole
Shape on Spin-Wave Band Structure in One-Dimensional Magnonic Antidot Waveguide,
Journal of Applied Physics, 114, 023910 (2013).
http://dx.doi.org/10.1103/PhysRevB.92.054430
http://dx.doi.org/10.1103/PhysRevLett.114.087203
http://dx.doi.org/10.1103/PhysRevB.92.020403
http://dx.doi.org/10.1063/1.4914496
http://dx.doi.org/10.1063/1.4914496
http://dx.doi.org/10.1063/1.4922392
http://dx.doi.org/10.1103/PhysRevLett.112.047203
http://dx.doi.org/10.1063/1.4813228
Acknowledgements
Firstly, I would like to thankmy supervisor Prof. Hans Fangohr for givingme the chance
to perform this work. Prof. Hans Fangohr is an excellent supervisor and working with
himwas a real pleasure. I appreciate his continuous support during thewhole period of
my PhD study. Similar acknowledgments go to my second supervisor, Dr. Ian Hawke,
for providing support with his mathematical expertise when I was lost in equations.
I would like to thank Prof. Volodymyr V. Kruglyak, Dr. Mykola Dvornik, Dr. Dheeraj
Kumar, Dr. Simone Borlenghi, Dr. Bin Zhang and Prof. Wolfgang Kuch for the stimu-
lating discussions as well as their contributions to the publications related to this work.
I owe a big thank to all the Finmag team members: Dmitri Chernyshenko, Marc-
Antonio Bisotti, Maximilian Albert, Marijan Beg, Rebecca Carey, Mark Vousden and
David Corts-Ortuo. I am especially thankful to Dmitri Chernyshenko and Marc-
Antonio Bisotti from whom I learned a lot about programming and software tools
and to Maximilian Albert with whom I had many fruitful conversations. I also really
appreciate the great help from Marijan Beg throughout the PhD. He also helped me a
lot in solving travel issues.
I would also like to thank Ryan Pepper and Marijan Beg for their patient and precise
proofreading of this thesis. I acknowledge financial support from China Scholarship
Council and EPSRCs DTC Grant.

Chapter 1
Introduction
1.1 Background
The various phenomena in magnetic materials are closely related to our daily life.
Recorded knowledge of magnetism goes back to the distant past. For example, in
ancient China, the earliest literary mention of magnetism is in a 4th-century B.C. book
TheMaster of Demon Valley. It has been suggested that hematite might have been used as
amagnet by theOlmec earlier than 1000 B.C. [4]. However, the use ofmagneticmaterials
has been limited until very recently. This is because people knew very little about the
theory behind magnetics.
Things began to change in the 1800s. The first milestone wasMaxwells electromagnetic
theory, in which the macroscopic electrical and magnetic phenomena are unified by
differential equations. After that, the importance of magnetic materials became recog-
nized. For example, people managed to use magnetic materials to generate alternating
currents. The second milestone was the development of quantum theory. This allowed
the use of magnetism on much smaller scales, culminating today at the nanoscale.
Nowadays, the application of magnetic materials is broad, with uses in data stor-
age, magnetoresistive random-access memory [5], magnetic sensors [6] and logic de-
vices [7]. Meanwhile, new research topics such as spin caloritronics and magnonics
develop quickly. As computing power has increased, simulations of the micromagnetic
model [8] and the atomistic spin model [9] have become an important tool to study the
complex phenomena in magnetic materials. These simulations have allowed the study
of the dynamics of spin waves, domain walls, vortices and skyrmions.
Magnonics is a young developing research field that emerged recently [10, 11] although
the concept of spin waves was introduced by Bloch 80 years ago. Magnons are the
particle-like spin excitations in magnetic mediums while the wave-like counterpart
are known as spin waves [12]. Both quantum mechanical and classical properties can
2 Chapter 1 Introduction
be found in spin waves. Due to new techniques in tailoring ferromagnetic materials,
phenomena such as spinwave interference [13] have been observed and thus stimulated
the fast development of field of magnonics.
As the quanta of spin waves, magnons obey Bose-Einstein statistics. Indeed, Bose-
Einstein condensation (BEC) of magnons was demonstrated in various magnetic sys-
tems [14], and even at room temperature in yttrium-iron garnets (YIG) [15, 16]. The den-
sity n0 of the room temperature BEC is unknown but quite low and satisfies n0/n  1
where n is the pumped density of themagnons [17]. Because of this the BEC can survive
despite the attractive intermagnon interactions. Furthermore, it was suggested that the
repulsive interactions could emerge by changing the field configuration so that the BEC
could stabilize at a much higher density [17].
It is believed that periodically patterned magnetic materials in the nanoscale will be
used in the future [12]. The propagation of waves in periodically shaped media is of
special interest in modern physics and technology [11]. The magnonic crystal is the
magnetic counterpart of the photonic crystal [18]. Recently, various types of magnonic
crystals have been studied both theoretically and experimentally [1922]. A typical
method to manipulate the band structure of spin waves in these magnonic crystals is to
use periodic modulation of nanostrip widths [22]. Storage-recovery phenomena were
demonstrated in an artificial crystal with a limited number of periods by employing a
quasinormal mode [23].
From the classical point of view, spin waves are the phase-coherent precessions of
microscopic vectors of magnetization in the magnetic material, which gives us the
opportunity to use mature micromagnetic tools to study the spin-wave dynamics. With
the fast development of computational power, numerical micromagnetic simulations
start to play more important roles in magnonics. The existing micromagnetic tools are
based on two numerical techniques, i.e., the finite difference method (FDM) such as
OOMMF [24] and the finite element method (FEM) such asMagpar [25] andNmag [26].
It is well known that the FDM is not suitable for irregular samples while FEM does
not have this limitation. The demagnetizing field calculations are complex, and while
due to the short range interaction we would expect the exchange field calculation to be
less complex, this is not the case due to the irregularity of cells in FEM. The common
method used in FEM to compute the exchange fields is the so-called box method. For
unstructured (irregular) meshes the error of the box method could be significant and
even worse than O(h) where h is the element edge length [27].
Usually, the finite element method in this context refers to the continuous Galerkin
method as implemented in existing FEMmicromagnetics packages [25, 26]. The satura-
tion magnetization is stored in cells (tetrahedra for 3D) but the unit magnetization vec-
tors are attached in nodes for the dynamics which is generally governed by the Landau-
Lifshitz-Gilbert equation (LLG). This modeling is slightly inconsistent especially when
Chapter 1 Introduction 3
information about the saturationmagnetization is needed in the LLGequation formulti-
materials, such as the spin transfer torque case [28]. This inspired us to look for other
possible FEM techniques in numerical micromagnetics.
Spin caloritronics [29] is a young developing research field that involves with spin
and heat currents. In the presence of temperature gradients, magnetic solitons such
as magnetic domain walls and magnetic skyrmions move [3033]. Experimentally,
thermal-driven domain-wall motion has been observed in a magnetic insulator YIG
(yttrium iron garnet) film [34]. A common and powerful tool used in spin caloritronics
is the stochastic LLG (SLLG) equation used both at the micromagnetic and atomistic
levels. For example, the SLLG equation at the atomistic level is used to study domain
wall and skyrmion dynamics [30, 33] while the SLLG equation at the micromagnetic
level is used in studying domain-wall motion [31] and magnon spin currents [35, 36].
The spin-wave amplitude decays when propagating in the media due to energy dissi-
pation and therefore how the relaxation process is described is a critical problem, at-
tracting great research interest [3741]. In the LLG equation the damping term is char-
acterized by the Gilbert damping constant. Phenomenologically, the Gilbert damping
term can be derived from the Lagrange equation with Rayleighs dissipation term by
assuming the magnetization is uniform [8] which means that the Gilbert damping is
local. Different forms of damping including nonlocal effects have been suggested, for
example, a tensor form ofmagnetization dampingwas proposed to describe themagne-
tization relaxation processes of a uniformly magnetized film [39]. Enhanced damping
phenomena in thin ferromagnetic films were observed in experiments [38], and this is
explained by the spin current pumping from the ferromagnetic layer to the nonmagnetic
metal [42]. A recent experiment on permalloy in nanoscale shows that the damping is
dependent on its shape and size [41], which confirms that the damping is nonlocal.
The Dzyaloshinskii-Moriya interaction (DMI) [43, 44] is an antisymmetric interaction
arising from spin-orbit coupling due to broken inversion symmetry in lattices or at
the interface of magnetic films. The most fascinating part about the DMI is that two
spins are in the lowest energy state when they are perpendicular rather than parallel or
anti-parallel. The existence of DMI leads to new magnetic profiles and dynamics. For
example, a domain wall is curled in the presence of DMI and the domain-wall motion
under an external field [45] or charge current [46] is also modified.
A stable magnetization profile that can exist due to the existence of the DMI is the
skyrmion [47], which is a topologically stable soliton. Unlike the vortex state, a
skyrmion can exist in the ferromagnetic background. Skyrmions are considered to
have potental application in data storage and thus the dynamics is of great interest.
A skyrmion can be driven by charge currents [48, 49], magnetic or electric field gradi-
ents [32, 50] and spin waves [33, 51]. It is of interest to find new ways to control the
skyrmion motion.
4 Chapter 1 Introduction
1.2 Structure of this thesis
What follows is a brief outline of this thesis. In Chapter 2 we will provide a short in-
troduction about the classical spin model and micromagnetics. We start from a basic
concept in magnetism  the magnetic moment, and write down the equation of mo-
tion (Landau-Lifshitz-Gilbert equation), as well as the common interactions between
magnetic moments. In Chapter 3 we will introduce our finite different micromagnet-
ic/atomistic simulation package  Fidimag, which was developed throughout the work
contained in this thesis. Some implementation details and verifications for Fidimagwill
be presented.
Chapter 4 will present the details of nonlocal damping. We will first explain the ex-
change damping in the Landau-Lifshitz-Baryakhtar equation as nonlocal damping by
linking it to the spin current pumping. The spin-wave propagation along a single rod
will be studied using micromagnetic simulations and analytical calculations. Further-
more, the domain-wallmotion under an external fieldwill be studied using the Landau-
Lifshitz-Baryakhtar equation.
In Chapter 5 we will study domain-wall motion driven by spin waves (magnons) in the
presence of the Dzyaloshinskii-Moriya interaction (DMI). In general, when spin waves
pass through a domain wall, the spin waves transfers spin angular momentum to it and
thus the domain wall moves towards to the magnon source. In the presence of the DMI,
the spin waves on the two branches of domains have different wavevectors. We will
show this wavevector change leads to a fast domain-wall motion. We attribute this to
linear momentum transfer.
Chapter 6 will be devoted to the study of magnetic skyrmions driven by microwave
fields. In this studywewill solve the Landau-Lifshitz-Gilbert equation numericallywith
a classical spin model on a two-dimensional system. We will show that both magnetic
skyrmions and skyrmion lattices can be moved with microwave magnetic fields if the
axial symmetry of the skyrmions is broken by a static in-plane external field. The net
velocity of the skyrmion depends on the frequency and amplitude of the microwave
fields as well as the strength of the in-plane field.
In Appendix B a method called called multipoint flux mixed finite element method
(MFMFE) is implemented to compute the exchange field for irregular cells such as
triangles and tetrahedra inmicromagnetics. InAppendixCwewill introduce a treecode
method in computing the demagnetizing fields.
Chapter 2
Micromagnetic and Atomistic
modeling
Both Maxwells electromagnetic theory and quantum theory were well developed by
the 1930s. However, both theories are not enough to describe various phenomena
such as the hysteresis loops of ordered spin structures and macroscopic magnetization
processes [52]. Maxwells electromagnetic theory has been verified experimentally in
a large range of scales, from microscopic to macroscopic. In media, the magnetic
induction B and electric field E in Maxwells equations can be considered as the
statistical average of the microscopic electromagnetic field e and h in an element of
media [53]
E = eelement B = helement. (2.1)
This is becausemicroscopically, the electrons are not static and the atoms vibrate, which
results in the micro-electric field e andmicro-magnetic field h being highly nonuniform
in time and space [53]. The most basic macroscopic magnetic properties of materials
can not be understood without quantum theory [54], although quantum theory gives
a description of magnetic properties on the atomistic level [52]. The development of
the continuum theory for micromagnetism was intended to bridge the gap between
Maxwells theory and quantum theory, which became necessary after Barkhausens
experiment, known as Barkhausens jumps and the domain-wall velocity experiment
performed by Sixtus andTonks [52]. Themodelwas developed quickly afterHeisenberg
and Diracs explanation of ferromagnetism based on the exchange interactions, and
Landau and Lifshitz derived a continuum expression for the exchange energy. This
allowed an interpretation of domain patterns, which was a breakthrough toward the
continuum theory of magnetism.
Today, the atomistic spin model has become an essential tool in understanding vari-
ous complex behaviors of magnetic nanomaterials [9, 55], such as surface anisotropy in
6 Chapter 2 Micromagnetic and Atomistic modeling
magnetic nanoparticles, ultrafast laser-induced magnetization dynamics and tempera-
ture effects [9]. The dynamics of novel magnetic textures such as magnetic skyrmions
can be modeled using the atomistic spin model [47]. The atomistic spin model can be
considered as a natural extension of the Ising model: the atomic spin is allowed to vary
freely in 3D spacewhile in the Isingmodel, a spin only has two states  spin-up and spin-
down [55]. The Isingmodel has been studied extensively for phase transition problems,
however this model is too simplistic and can not be applied to study dynamic simula-
tions of magnetic materials. As we will see in this Chapter, the atomistic spin model
combined with the Landau-Lifshitz-Gilbert equation can deal with the dynamics, even
in the presence of temperature [56].
2.1 Magnetic moments
Magnetic moment is a fundamental object in magnetism; classically it is equivalent to a
current loop, or a magnetic dipole. In atoms the magnetic moment  is associated with
its spin angular momentum S and orbital angular momentum L. For metal systems
with quenched orbital moments, the magnetic moment is mainly related to the spin
angular momentum
 = gBS, (2.2)
where g = 2 is the Lande factor and B = |e|h/(2m) is the Bohr magneton. Here
the local spin S = S(r) is treated as a classical variable [57], thus its relation to
magnetization is
M(r) =  h
S(r), (2.3)
where  = gB/h (> 0) is the gyromagnetic ratio and (r) is the local atomic volume
per magnetic ion. For a simple cubic lattice, (r) = a3 where a is the lattice constant.
2.2 Equation of Motion
According to Ehrenfests theorem, the expectation value of an operator A (assuming A
has no explicit time dependence) can be given by
A = i
[H, A], (2.4)
where [H, A] is the usual commutator. Considering an electron under a magnetic field
H with the Hamiltonian operator
H = gBH  S, (2.5)
Chapter 2 Micromagnetic and Atomistic modeling 7
where S is the spin angular momentum operator. By using the angular momentum
commutation relations [Si, Sj] = ieijkSk and Eq. (2.4), the expectation value of S becomes
S = S H. (2.6)
Note that Eq. (2.6) holds true for a time-dependent magnetic field H [58]. Therefore, the
dynamics of the magnetic moment  is governed by the equation
 = H. (2.7)
As we can see, the energy is conserved if the dynamics is governed by Eq. (2.7). In
reality, the magnetic moments are subject to energy dissipation arising from different
sources such as phonons [57]. Phenomenologically an extra damping term can be added
to Eq. (2.7) and the Landau-Lifshitz-Gilbert (LLG) equation is obtained [8],
= H + 
 
. (2.8)
where s = || and  is a dimensionless damping constant  the Gilbert damping
parameter. This damping constant  is phenomenological, and  is usually less than
0.1 in Fe, Co, Ni metals or alloys [53]. In Permalloy, the damping is even less than
0.01. The Gilbert damping term also emerges by employing a modified Hamiltonian
H = H  i(H  H) where  is the damping constant [59]. Equation (2.8) can be
rewritten in a dimensionless form
= mHeff + m
, (2.9)
where m = /s is the unit vector of the magnetic momentum and Heff represents the
total effective field arising from various interactions.
2.3 Interactions
There are several typical interactions betweenmagnetic moments, such as the exchange
interaction, anisotropy interaction, dipolar interaction, Dzyaloshinskii-Moriya interac-
tion and Zeeman interaction. The total Hamiltonian is the summation of these
H = Hex +Hdmi +Hd +Han +Ha, (2.10)
where Hex, Hdmi, Hd, Han and Ha are the Hamiltonians of the exchange interaction,
Dzyaloshinskii-Moriya interaction, dipolar interaction, anisotropy interaction and Zee-
man interaction, respectively. The effective field Heff can be computed from the total
8 Chapter 2 Micromagnetic and Atomistic modeling
HamiltonianH
Heff = 
. (2.11)
2.3.1 Exchange interaction
The exchange interaction is the strongest magnetic interaction and the most difficult
one to treat theoretically [60]. The classical Heisenberg Hamiltonian with the nearest-
neighbor exchange interaction is given by
Hex = J 
i,j
mi mj, (2.12)
where i, j represents a unique pair between lattice sites i and j and we assume that
the summation is taken only once for each pair. The strength of exchange interaction
is indicated by the exchange constant J. A positive J leads to the ferromagnetic state
since the Hamiltonian [Eq. (2.12)] is minimal when the magnetic moments mi and mj
are parallel while a negative J results in the antiferromagnetic state. Note that if we
write Hex =  J i,j Si  Sj then we have J = JS2. The effective exchange field at site i
can be computed as
Hex,i =
i,j
mj. (2.13)
2.3.2 Dzyaloshinskii-Moriya interaction (DMI)
In a more general form, the Hamiltonian of Heisenberg exchange [Eq. (2.12)] can be
extended to
Hex = 
i,j
STi AijSj, (2.14)
where Aij = {Aij } with ,  = x, y, z is the exchange tensor. We can decompose Aij
into three parts, i.e.,
Aij = JijI + Asij + Aaij, (2.15)
where I is the unit tensor and Jij is the isotropic exchange coefficient,
Jij =
Tr(Aij). (2.16)
This is why the exchange interaction [Eq. (2.12)] is called the isotropic exchange inter-
action. The traceless symmetric anisotropic exchange tensor Asij is defined by
Asij =
(Aij + ATij) JijI , (2.17)
Chapter 2 Micromagnetic and Atomistic modeling 9
and the antisymmetric exchange matrix tensor can be computed as
Aaij =
(Aij  ATij). (2.18)
Hence, the Hamiltonian [Eq. (2.14)] can be rewritten as
Hex = 
i,j
JijSi  Sj 
i,j
STi AsijSj 
i,j
STi AaijSj. (2.19)
The last term (the antisymmetric part) of Hamiltonian [Eq. (2.19)] can be recast into
Hdmi = 
i,j
Dij  (Si  Sj), (2.20)
where
Dxij = A
ij  A
ij , D
ij = A
ij  Azxij , Dzij = A
ij  A
ij . (2.21)
This antisymmetric exchange interaction was first studied by Dzyaloshinskii (1958) [43]
andMoriya (1960) [44]. Dzyaloshinskii predicted that the combination of symmetry and
spin-orbit couplings can lead to antisymmetric exchange interactions andMoriya found
a microscopic mechanism which gives rise to such antisymmetric terms in systems
with spin-orbit couplings. Therefore, the anisotropic exchange interaction [Eq. (2.20)]
is known as the Dzyaloshinskii-Moriya interaction (DMI). As we can see, the isotropic
exchange coefficient Jij and the pseudovector Dij have different symmetry properties:
Jij = Jji, Dij = Dji. (2.22)
In general theDMI can arise from the spin-orbit interaction and the vector D lies parallel
or perpendicular to the line connecting the two spins [54, 61]. For the parallel case, one
can assume Dij = Drij while for the perpendicular case one can assume Dij = Dr ez
if both spins are located in the xy-plane [62]. The former actually corresponds to the
bulk DMI while the latter is the interfacial DMI. This two types DMI have been found
in bulk materials such as MnSi [63] and FeGe [64], as well as in magnetic interfaces [62].
Therefore, the Hamiltonian for DMI can be written as
Hdmi = 
i,j
Dij  [mi mj], (2.23)
where Dij = DijS2. The corresponding effective field can be computed by
Hdmi,i = 
Hdmi
i,j
Dij mj, (2.24)
where the identity a  (b c) = (a b)  c is used.
10 Chapter 2 Micromagnetic and Atomistic modeling
2.3.3 Dipolar interaction
The dipolar interaction is a long-range interaction. The Hamiltonian for dipolar inter-
action between magnetic moments i and j is
Hd = 
4 i<j
3(mi  rij)(mj  rij)mi mj
, (2.25)
where rij is the distance between two magnetic moments. Therefore, the effective field
can be computed by
Hd,i =
4 i 6=j
3rij(mj  rij)mj
. (2.26)
2.3.4 Anisotropy
In the presence of anisotropy, a magnetic moment tends to align along some preferred
direction. Many physical effects can lead to an anisotropy, for instance, the magne-
tocrystalline anisotropy can arise from the interaction between local crystal environment
and atomic electron orbitals [55]. The simplest form of the anisotropy is the so-called
uniaxial anisotropy, and its Hamiltonian is given by
Han = K 
(mi  u)2,
where the unit vector u is the easy axis and the constant K represents the anisotropy
strength. The corresponding effective field due to the uniaxial anisotropy is
Han,i =
(mi  u)u. (2.27)
Some materials such as Nickel have a cubic crystal structure, and thus they have
a different form of anisotropy called cubic anisotropy. The Hamiltonian of cubic
anisotropy is given by
Hcan = Kc 
(m4x + m
y + m
z). (2.28)
By using the identity m2x +m2y +m2z = 1, it is straightforward to see that theHamiltonian
[Eq. (2.28)] is equivalent to the form
Hcan = 2Kc 
(m2xm
y + m
z + m
x). (2.29)
Chapter 2 Micromagnetic and Atomistic modeling 11
2.3.5 Zeeman energy
The effective field of a magnetic moment in the presence of an external field Ha is
obviously Ha itself. This also can be seen from the Zeeman energy given by
Ha = s 
mi Ha. (2.30)
2.4 Atomistic spin model
By treating the spin as a classical variable, the dynamics of atomic spin is governed
by the LLG equation (2.9). Various physical effects are considered through the total
effective field Heff, which can be computed by the total Hamiltonian. The reason to use
the atomistic spin model rather than the continuum micromagnetic model is that, for
some cases the continuum micromagnetic model may fail. In general, there are two
ways to establish the parameters in the atomistic spin model [55]: using ab initio density
functional theory calculations or determined by experiments.
The LLG equation (2.9) does not contain the temperature effect, which is only applicable
for simulations at zero temperature. In reality, the temperature is involved in magnetic
system. In general three types of excitations can be stored in a ferromagnetic solid:
the energy of electrons, the excitation of phonons, and the excitation of magnons.
In this framework, the magnetization dynamics can be understood within the three
thermodynamic subsystems: the spin system, the lattice and the electronic system [9,
el  1 ps
sl  100 pses  10 100 fs
Spin (s  1 ps)
Lattice (l  1 ps)Electron (e < 1 ps)
Figure 2.1: Three heat reservoirs in a ferromagnetic metal. All three reservoirs
also can be separately excited. Approximate relaxation times within the reser-
voirs and between the reservoirs are included. Figure is adapted from Ref. [9].
Energy can be exchanged between the three subsystems, as shown in Fig. 2.1. It is
important to realize that the angular momentum transfer is accompanied when the
energy is transfered to or from the spin system and in this case the angular momentum
12 Chapter 2 Micromagnetic and Atomistic modeling
needs to be conserved as well. The timescale of the spin-lattice relaxation time sl is of
the order 100 picoseconds (ps), which is slower than the electron-lattice relaxation time
el (el  1 ps) [9]. Compared with them, the spin-electron relaxation time es is slightly
fast, which has been found to be at the order of 100 fs.
When the spin system is connected to a thermal reservoir, thermal excitations can be
generated by adding a stochastic field to the effective field in the standard LLG equation
(2.9), in this way, the effect of temperature is included for magnetic dynamics. The LLG
equation with stochastic field  is
= m (Heff + ) + m
. (2.31)
The equation (2.31) is the so called stochastic LLG (SLLG) equation. The thermal
fluctuation is assumed to be a Gaussian white noise, i.e., the thermal noise  obeys the
properties
 = 0,
ui , 
= 2Dijuv, (2.32)
where i and j are Cartesian indices, u and v indicate the magnetization components and
,  represents the average taken over different realizations of the fluctuating field [65].
The constant D denotes the strength of the thermal fluctuations:
. (2.33)
This model [Eqs. (2.31)-(2.33)] is the so called Langevin dynamics model. The strength
of D can be determined by the Fokker-Planck equation. The SLLG equation (2.31) can
be rewritten in a more general form
= Ai + 
BikLk, (2.34)
where Lk = k and
Ai = 
1 + 2
[mHeff + m (mHeff)]i ,
Bik =
1 + 2
(ik mimk)j eijkmj
(2.35)
As we can see, the SLLG equation is multiplicative since Bik/mj 6= 0 (the noise is
called additive if Bik/mj = 0, whereas in this case the Ito stochastic calculus and
the Stratonovich stochastic calculus coincide). By using the Stratonovich calculus, the
time evolution of nonequilibrium probability distribution P = P(m, t) is given by the
Chapter 2 Micromagnetic and Atomistic modeling 13
Fokker-Planck equation [65]:
Ai  D 
Bik 
 D 
BikBjk
. (2.36)
It is found that the second term k Bik j Bjk/mj = 0 and thus we arrive at
1 + 2
m (Heff + mHeff)
m (m 
, (2.37)
where 1 = 2D2/(1 + 2) is the free-diffusion time (also known as Nel time). In
thermal equilibrium P(m) have to satisfy the Boltzmann distribution,
P0(m)  exp[H(m)], (2.38)
where  = 1/(kBT). Note that the definition of the effective field is given by equa-
tion (2.11), so we have P0/m = sHeffP0, and thus the first term vanishes since
/m (mHeffP0) = 0. Hence, the Fokker-Planck equation reduces to
1 + 2
m (mHeff)
m (mHeff)
. (2.39)
The stationary solution requires P0/t = 0, which results in
(1 + 2)s
. (2.40)
Comparing Eq. (2.40) with the Nel time, the amplitude of D in Eq. (2.33) can be
obtained.
2.5 Micromagnetics
In the continuum theory, the isolated magnetic moments are replaced by a continuum
function, magnetization M(r), which represents the average moment density over a
local volume V(r, r),
M(r) =
V(r, r) i
i. (2.41)
In this continuum case, the dynamics of magnetization M is still governed by the LLG
equation (2.9), where m = M(r)/Ms with Ms the saturation magnetization. The
effective field Heff is then calculated as the functional derivative
Heff = 
, (2.42)
14 Chapter 2 Micromagnetic and Atomistic modeling
where E is the total micromagnetic energy, which can be obtained from the total
Hamiltonian of the atomistic model on the continuum limit.
2.5.1 Exchange energy
In the continuum limit the isotropic exchange energy can be written as
Eex =
A(m)2dx (2.43)
where (m)2 = (mx)2 + (my)2 + (mz)2. So the corresponding effective field is
Hex =
2m, (2.44)
and the relation between A and J for simple cubic lattice is J = 2Aa.
2.5.2 Magnetostatic energy
In the continuum case, the dipolar interaction is represented by the demagnetizing
field, also known as the stray field. By applying the Maxwells equations for the zero
macroscopic current case (i.e., only consider the fields due to the magnetic moments),
the demagnetizing field in a sample can be computed as the gradient of a magnetic
scalar potential 
Hd(r) = (r) (2.45)
The magnetic potential satisfies the equation
2 = m, (2.46)
where m =   M can be considered as the magnetic volume charge density.
Therefore, outside of the sample m = 0. The boundary conditions read
+ =  (2.47)
m = ( +)  n (2.48)
where m = M  n is the magnetic surface charge density. With the help of a Green
function, the solution of  can be obtained
(r) =
m(r)
|r r|d
3r +
m(r)
|r r|d
. (2.49)
Chapter 2 Micromagnetic and Atomistic modeling 15
It is easy to check that the potential decays to zero at infinity. Inserting Eq. (2.49) into
Eq. (2.45), the demagnetizing field is given by
Hd(r) =
r r
|r r|3 d
3r +
r r
|r r|3 d
. (2.50)
From the view point of the energy, the demagnetization energy, also known as magne-
tostatic energy, is given by
Ed = 
Hd(r) M(r)dV. (2.51)
2.5.3 Dzyaloshinskii-Moriya Energy
In the continuum limit the DMI energy can be written as
Edmi =
Dam  (m)dx, (2.52)
and the effective field is
H =  2Da
(m), (2.53)
where Da = D/a2. For the interfacial case, the effective field thus becomes,
(ex 
 ey 
) (2.54)
Compared with the effective field of the interfacial DMI [62]
(( m)ez mz), (2.55)
we find Da = D/a2. Actually, the DM energy density (2.52) is related to the so called
Lifshitz invariants, which are terms in the form,
L(k)ij = mi
. (2.56)
The DM energy density has different forms depending on the symmetry class, for
example, the energy density (2.52) corresponds to the T symmetry,
L = L(z)yx + L
xz + L
zy = m  (m). (2.57)
16 Chapter 2 Micromagnetic and Atomistic modeling
2.6 Landau-Lifshitz-Gilbert (LLG) equation
The LLG equation (2.9) can be rewritten as
=  
1 + 2
mHeff 
1 + 2
m (mHeff) , (2.58)
which is equivalent to the Landau-Lifshitz (LL) equation
= LmHeff  Lm (mHeff) . (2.59)
if we set L = /(1 + 2). Therefore, Eq. (2.58) is the LL form of LLG equation. The
LL equation (2.59) is first introduced by Landau and Lifshitz in 1935 to describe the
dispersive theory in ferromagnets [66]. Later, Gilbert derived the LLG equation by using
the Lagrangian formulation with a Rayleighs dissipation function [8]:
L(m, m)
 L(m, m)
R(m)
= 0, (2.60)
where
R(m) = 0
m  m dr (2.61)
is a Rayleighs dissipation functional [8]. In this case the damping mechanisms is local
and uniform. In fact, several nonuniform mechanisms such as rapid spin reorientation
in magnetization dynamics can also contribute to the damping [8]. A more general
dissipation functional is suggested:
Rall(m) =
(r, r)m(r, t)  m(r, t) drdr. (2.62)
It can be seen thatR is a special case ofRall if we set (r, r) = 0(r r). However, to
keep the dissipation simple, the local dissipation functional [Eq. (2.61)]will be used. The
Lagrangian L = T  E where T and E are the magnetic kinetic energy and magnetic
potential energy, respectively. Inserting the Lagrange L into Eq. (2.60), one obtains
T (m, m)
 T (m, m)
+ (Heff + 0m) = 0. (2.63)
By assuming that for 0 = 0 case the equation (2.63) corresponds to
= mHeff, (2.64)
the LLG equation (2.9) can be obtained for 0 > 0 case with  = 0. In practice we
need to use the LL form of the LLG equation [Eq. (2.58)] for numerical implementation.
Chapter 2 Micromagnetic and Atomistic modeling 17
2.6.1 Spherical form of LLG equation
The length of magnetization unit vector is equal to unity, i.e., |m| = 1. Therefore, the
dynamics of magnetization can be described by two variables. In spherical coordinates,
the direction of magnetization is determined by the polar angle  and the azimuthal
angle , that is, m = (sin  cos , sin  sin , cos ). Hence, we have
m = e + sin e, (2.65)
where
e = (cos  cos , cos  sin , sin ),
e = ( sin , cos , 0).
(2.66)
Note that E/ = e  E/m and E/ = sin (e  E/m), so the precessional term
mHeff in LLG equation can be rewritten as
mHeff =
(e  e)
 e)e  (
 e)e
= He + He ,
(2.67)
where the field H and H are defined by
H = 
, H = 
0Ms sin 
. (2.68)
The damping term in the LLG equation can be rewritten as
m m = e   sin e , (2.69)
where we have used m  e = e and m  e = e . Therefore, we arrive at the
spherical form of LLG equation:
 +  sin  = H,
  sin  = H .
(2.70)
The spherical form of LLG equation (2.70) also can be derived from the Euler-Lagrange
equation,
= 0, (2.71)
where X refers to  and . The Lagrangian L is given by
(1 cos ) dV  E, (2.72)
18 Chapter 2 Micromagnetic and Atomistic modeling
where (0Ms/)(1  cos ) is the Berry phase term that plays the role of magnetic
kinetic energy. The dissipation is given by
0Ms
2 + sin2 2
dV. (2.73)
2.6.2 Spin transfer torque
The discovery of giant magnetoresistance (GMR) shows that the resistance of a ferro-
magnetic conductor depends on its magnetization configuration. This suggests that
there is an interaction between the conduction electrons and the magnetization, which
changes its electric conductivity. In the opposite direction, the flow of an electric current
will affect the magnetization dynamics. Indeed, conduction electrons transfer the spin
angularmomentum to themagnetization of a ferromagnet [67, 68]. Interestingly, Zhang
and Li found that [28] most of the physics on the interplay between the magnetization
dynamics of local moments and the spin-polarized transport of itinerant electrons can
bemostly captured by the s-dmodel. The extended LLG equationwith the spin transfer
torque is given by [28, 57, 69],
= mHeff + m
+ u0(j  )m u0[m (j  )m] (2.74)
where j is the spin-polarized electric current. The parameter u0 is given by
PgBa3
, (2.75)
where B is the Bohr magneton, P is the spin polarization of the electric current, e(> 0)
is the electronic charge and Ms is the saturation magnetization. Equation (2.74) is also
known as Zhang-Li extension. The last term in Eq. (2.74) is called nonadiabatic -term,
which is very important for the domain-wall motion driven by spin transfer torque even
the value of  is relatively small.
Equation (2.74) also have other formats, for example, the adiabatic term can be rewritten
as u0(j  )m = u0m  [m  (j  )m] if we noticed m  xm = 0. For numerical
purpose, we change Eq. (2.74) into its LL form,
(1 + 2)
= mHeff  m (mHeff)
+ (1 + )u0(j  )m ( )u0[m (j  )m].
(2.76)
Furthermore, we take an extra step to remove the longitudinal component of (j  )m
although in principle xm is always perpendicular to m, therefore, Eq. (2.74) becomes
(1 + 2)
= mH + H + (1 + )u0  ( )u0(m ) (2.77)
Chapter 2 Micromagnetic and Atomistic modeling 19
where  = (j  )m is the effective torque generated by current. If we assume u = u0 jez,
the Eq. (2.74) can be rewritten in spherical form
 +  sin  = H + u
  u sin ,
  sin  = H + u  u sin ,
(2.78)
where we have used zm = e + sin e and m (zm) = e  sin e .
2.6.3 Nonlocal spin transfer torque
In deriving the LLG equation (2.74) to include the spin transfer torque effect, the
magnetization is assumed to vary slowly in space, e.g., the domain-wall width is much
larger than the transport length scale [28]. In the slow magnetization approximation,
the spatial derivative of the nonequilibrium spin density m can be discarded. However,
when the domain wall (such as an atomically sharp domain wall) is very thin, this
assumption is no longer valid. In this case, the LLG equation with spin transfer torque
is given by,
= mHeff + m
+ T, (2.79)
where T is the spin transfer torque. In the slowmagnetization approximation, it is given
Tloc = u0(j  )m u0[m (j  )m]. (2.80)
In general case, the spin transfer torque can be computed by [28]
T = m m
, (2.81)
where sd = 2h/Jex is the s-d exchange time. Meanwhile, the nonequilibrium spin
density m is governed by
= D2m + m m
+ u0(j  )m, (2.82)
where D is the diffusion constant and sf is the spin-flip time. By changing Eq. (2.79)
into LL form, we obtain
(1 + 2)
= mHeff  m (mHeff)
m m
. (2.83)
Therefore, for the general case, the dynamics of the magnetization can be obtained by
solving Eqs. (2.82) and (2.83) simultaneously.
20 Chapter 2 Micromagnetic and Atomistic modeling
Table 2.1: Typical transport parameters of soft NiFe alloy [70].
Variable Symbol Value
diffusion constant D 2.5 104 m2/s
spin-flip time sf 4 1015 s
s-d exchange time sd 1 1013 s
Table 2.1 shows the typical transport parameters for soft NiFe alloy [70], the spin-
flip time sf and the s-d exchange time sd can be derived from the diffusion length
sf =
Dsf and sd =
Dsd, respectively. As we can see, the typical spin-flip time is
in fs scale and the exchange time is in sub-ps scale.
2.7 Finmag and Fidimag
Finmag is a finite element micromagnetic simulation package. As with Nmag, Fin-
mag can be called by Python, which is an popular intuitive scripting language. In Fin-
mag, the FEniCS/DOLFIN [71] project is intensively used, whichmeans that all features
of FEniCS/dolfin are exposed to users of Finmag. A useful feature of dolfin is that one
can describe a finite element variational problem easily in a python script using high-
level mathematical description. Therefore, Finmag can be extended easily when users
want to model new interactions. Currently, typical micromagnetic interactions such
as the exchange, Zeeman, DMI, and demagnetization interactions are implemented in
Finmag, and the common dynamical equations such as the LLG equation, the stochastic
LLGequation, spin transfer torque aswell as nonlocal spin transfer torque are supported
in Finmag. The extended equations such as the LLB equation and Baryakhtar equation
are also supported in Finmag. C/C++ are used internally where necessary to increase
the speed.
Fidimag is a Python based micromagnetic/atomistic spin simulation package. As a
scripting language, Python runs through an interpreter and suffers from a performance
overhead when compared to lower level languages. Therefore, we make use of C where
as necessary and Cython is chosen to link the Python and C. There are twomain parts in
Fidimag  micromagnetic and atomistic codes. For the micromagnetic part, Fidimag use
the finite difference method to discretize the samples. In Fidimag we also make use of
existing libraries. For example, the dipolar interactions are sped up by using the fast
Fourier transformation techniques from FFTW library; The LLG equation is solved by
Sundials/cvode, which is a general differential equation solver package.
Chapter 3
Fidimag
3.1 Introduction
The motivation to develop Fidimag is that we want to make use of the advantages of
modern script languages. In Fidimag we choose Python, which is much better suited as
a glue language. The basic structure of Fidimag is shown in Fig. 3.1. There are two
main parts (micromagnetics and atomistic spin model) in Fidimag. Based on standard
micromagnetics, common extensions such as temperature effects and spin transfer
torques are included as well. As extensions for the atomistic spin model, Langevin
Fidimag
Standard
micromagnetics
Atomistic
spin model
Temperature,
(nonlocal) spin
transfer torque ...
Landau-Lifshitz-
Bloch, Baryakhtar
Langevin
dynamics
Eigenvalue
methods
Figure 3.1: The basic structure of Fidimag.
dynamics and an eigenvalue method are implemented. The underlying code is written
in C and Cython is used to expose it to Python. In Fidimag, we have used the FFTW
library to speed up the calculation of dipolar interactions and the Cvode from Sundials
library to solve the LLG equation. Cvode is a solver for stiff and nonstiff ordinary
differential equation (ODE) systems.
22 Chapter 3 Fidimag
3.2 Fast Summation of Dipolar interactions
In the micromagnetic part of Fidimag we use the finite difference method (FDM) rather
than the finite element method (FEM) to discretize the sample. An advantage to use
FDM is that, the demagnetizing field can be computed with the help of fast Fourier
transformation (FFT) techniques, the complexity is scaled with O(N log N) since the
main cost is FFT itself which can be achieved within O(N log N) operations [72]. This is
very useful since in both the atomistic spin and micromagnetic models, the long-range
dipolar interactions are the most time-consuming part among the various interactions.
There are twomethods to compute the effective field in numerical micromagnetics [72]:
energy-based and field-based approaches. In Fidimag we use the energy-based ap-
proach. A cuboidal volume element with edge length x, y and z is employed to
discretize the demagnetization energy (3.1) directly
Edemag  
|Vi|M(ri) Hd,i
2 i,j
|Vi|M(ri)  N (ri, rj) M(rj),
(3.1)
where |Vi| = xyz and N(ri, rj), the demagnetization tensor, is a 3  3 matrix
[72]. The computation details can be found in Newells original paper [73]. The
demagnetization tensor has symmetry properties and only related to the distance
between ri and rj
N (i, j) = N (ri  rj) = N (ri, rj). (3.2)
As a result, one arrives at a discrete convolution for the demagnetizing field
Hd,i = 
NijMj, (3.3)
which is a cell-average field. Note that in this manner the magnetization is defined in
the center of each cell. For a simple cubic lattice in the atomistic spin model, the dipolar
interaction can be sped up using FFT techniques. The dipolar field [Eq. (2.26)] can be
rewritten as,
Hd,i = 
N dijmj, (3.4)
where N dij = N d(ri  rj) and
N d(r) = 30s
2  r2/3 xy xz
xy y2  r2/3 yz
xz yz z2  r2/3
 . (3.5)
Chapter 3 Fidimag 23
3.2.1 Fast Summation
As we can see, both cases [Eqs. (3.3) and (3.4)] lead to a summation problem. In a more
general case, the summation problem for Ns source particles and Nt target particles is
f (xj) =
kK(xj  xk) j = 0, . . . , Nt  1, (3.6)
where K is a smooth symmetric function. In our case,  represents the magnetization
components andK is one entry of the demagnetization tensorN . The definitions of the
discrete Fourier transform and inverse Fourier transform are
N , xn =
N , (3.7)
where N = e2i/N . Apply the transformations to the kernel function K, we obtain
K(xk) =
L , bn =
K(xk)nkL , (3.8)
where L = Ns + Nt  1 is the total range number that xj  xk spans. Substitute Eq. (3.8)
into Eq. (3.6), the summation can be rewritten as
f (xj) =
kK(xj  xk) =
n(jk)
(3.9)
If we extend the length of the sequence {k} to L by padding zeros, the sum in the inner
bracket can be computed by the FFT algorithm, followed with an inverse FFT operation
for the remainder. This is the basic principle behind using the FFT method to compute
the summation [Eq. (3.6)] rapidly.
3.2.2 Dipolar interaction in triangular lattice
Triangular lattices are also very common in the classical spin model [74, 75]. For
example, a skyrmion lattice could be formed on a triangular lattice antiferromagnet [74].
Figure 3.2 shows a 2D triangular lattice using black dots. In this situation, we can still
use the FFT techniques to compute the dipolar interactions betweenmagneticmoments.
To do this we create a rectangular mesh based on the original triangular lattice. The
rectangular mesh is shown in Fig. 3.2 with dashed lines and the white nodes represent
the magnetic moments with |m| = 0. The cost of using this method is that we have
extended the size of the system from N to 2N.
24 Chapter 3 Fidimag
Figure 3.2: A rectangular mesh is created based on the triangular lattice, which
is represented by black points.
3.3 Landau-Lifshitz-Baryakhtar equation
In Chapter 4, the Landau-Lifshitz-Baryakhtar (LLBar) equation will be discussed in
more detail. Here we briefly show the equations that have been implemented in
Fidimag. The implemented LLBar equation is
= MHe + rHe  e2He, (3.10)
where r and e are two damping constants. The effective field He is given by
He = 
= Heff +
(1 n2)M, (3.11)
where Heff is the effective field in standard micromagnetics,  is the longitudinal
magnetic susceptibility and n = M/Me with Me the equilibrium magnitude of the
magnetization vector M. In the limit of  0, the LLBar equation (3.10) reduced to
= mHeff  m (mHBeff), (3.12)
where
HBeff = Heff  2Heff, (3.13)
and Heff is the transverse component of the effective field, i.e., H
eff = Heff (m Heff)m.
The parameter  = Mer is theGilbert damping and  = Mee. The simplifiedLLBar
(sLLBar) equation (3.12) also has been implemented in Fidimag.
Chapter 3 Fidimag 25
3.4 Eigenvalue Method
An effective method to compute the natural frequencies and the normal oscillation of
a magnetic system is the so called eigenvalue method [76]. Traditionally, the resonance
frequencies of the magnetic system can be extracted from the standard micromagnet-
ic/atomistic simulations by running the dynamics for a certain time. Compared with
the traditional one, in eigenvalue method the dynamics is not needed [76]. In Fidimag,
we implemented a simple version of the eigenvaluemethod for the atomisticmodel [77].
We start from the Hamiltonian
H = Hex +Hdmi +Han +Ha, (3.14)
where we have considered the exchange interaction, DMI, anisotropies and static
external fields. For a given ground state or metastable spin configuration
m0 = (sin  cos , sin  sin , cos )
T, (3.15)
one can construct a local coordinate system such that
m = wm0 + ue + ve, (3.16)
where e = (cos  cos , cos  sin , sin )T and e = ( sin , cos , 0)T. In matrix
form, Eq. (3.16) can be written as
mxmy
cos  cos   sin  sin  cos sin  cos  cos  sin  sin 
 sin  0 cos 
 . (3.17)
Under this transformation, the unperturbed spin configuration m0 corresponds to u =
0, v = 0 and w = 1. In this local coordinate, the effective fields are given by
Heff = 
=  1
. (3.18)
Substituting Eqs. (3.16) and (3.18) into the LLG equation, we obtain
u = (wHv + vHw) + (wv + vw),
v = (wHu  uHw) + (wu uw),
(3.19)
where Hw, Hu and Hv are effective fields along m0, e and e, respectively. To linearize
the LLG equation, we assume |u|  1, |v|  1 and thus w  1  (1/2)(u2 + v2).
Moreover, we look for the solutions such that u = ueit and v = veit. Therefore, we
26 Chapter 3 Fidimag
arrive at
is(1 + 2)u = (hv  vHw) + (hu  uHw),
is(1 + 2)v = (hv  vHw) (hu  uHw),
(3.20)
where we have ignored the higher-order terms. In addition, Eq. (3.20) can be rewritten
in a matrix form [77]
(1 + 2)
, (3.21)
where we have introduced two vectors u = (u1, u2, ..., un)T and v = (v1, v2, ..., vn)T.
Therefore, the normal modes of the system can be obtained through solving the
eigenvalues of the matrix A. For  = 0 case, the eigenvalues are pure imaginary
numbers since  is real. The related effective fields are given by
Hw = (H(0)/w)
(3.22)
hu = (H(2)/u)
w=1,u=u,v=v
(3.23)
hv = (H(2)/v)
w=1,u=u,v=v
. (3.24)
For exchange interaction [Eq. (2.12)], one has
Hexw,i = J j
cos i cos j + sin i sin j cos(i  j)
hexu,i = J j
uj cos(i  j) cos i cos j + uj sin i sin j + vj cos i sin(i  j)
hanv,i = J j
uj cos j sin(i  j) + vj cos(i  j)
(3.25)
For bulk DMI [Eq. (2.23)] with Dij = Drij, we obtain
Hdmiw,i =jX Dij
sin j sin j cos i  sin i sin i cos j
jY Dij
sin i cos i cos j  sin j cos j cos i
jZ Dij
sin i sin j sin(i  j)
(3.26)
where Dij = Dsgn(j i) with sgn(x) the sign function. The sets X, Y and Z represent
the neighbours of site i in x-, y- and z-axis. Meanwhile, hdmiu,i and h
v,i are given by
hdmiu,i =jX Dij
uj sin j sin i cos i  uj sin i sin j cos j  vj sin i cos j
jY Dij
uj sin i cos j cos j  uj sin j cos i cos i  vj sin i sin j
jZ Dij cos i
uj cos j sin(i  j) vj cos(i  j)
hdmiv,i =jX Dijuj sin j cos i + jY Dijvj sin j sin i+
jZDij
uj cos j cos(i  j) + vj sin(i  j)
(3.27)
Chapter 3 Fidimag 27
For a static external field H = (Hx, Hy, Hz), the corresponding fields are hu = hv = 0
and Haw,i = Hz cos i + Hx cos i sin i + Hy sin i sin i. For anisotropies with Han =
i(Kxm2x,i + Kzm2z,i), these fields are given by
Hanw,i = 2Kx cos
2 i sin
2 i + 2Kz cos
2 i,
hanu,i = 2Kx cos i cos i(ui cos i cos i  vi sin i) + 2Kzui sin2 i,
hanv,i = 2Kx sin i(ui cos i cos i + vi sin i).
(3.28)
3.5 Verification I
3.5.1 A magnetic moment under an external magnetic field
It is always useful to compare the simulation results with the analytical results. The
simplest case is the precession motion of a magnetic moment under an external mag-
netic field. Assuming the external field is along with the z-axis and the initial state is
m0 = (1, 0, 0), then we have
mx(t) = cos(Hzt)/ cosh(Hzt),
my(t) = sin(Hzt)/ cosh(Hzt),
mz(t) = tanh(Hzt),
(3.29)
where  = /(1 + 2). Figure 3.3 shows the precessional motion of the macrospin
under an external magnetic field with strength Hz = 1 105 A/m. As expected, the
macrospin ends at M = (0, 0, 1) after dissipating its energy and aligning with the field.
3.5.2 Domain-wall motion under charge currents
For the domain-wall case, to date only few exact spatiotemporal solutions of the LLG
equation have been reported in the literature. One example is the well known Walker
solution [78], another example is that a domain wall moves in an external field with
arbitrary time dependence [79]. In this example, we will show an exact spatiotemporal
solutionwith spin transfer torque (Zhang-Li extension). We start from the LLG equation
in the spherical form [Eq. (2.78)]
 +  sin  = H + u
  u sin ,
  sin  = H + u  u sin .
(3.30)
28 Chapter 3 Fidimag
0.0 0.2 0.4 0.6 0.8 1.0
Time (ns)
Figure 3.3: The precession motion of a magnetic moment under an external
field with Hz = 1 105 A/m. The macrospin starts with (1, 0, 0) and ends with
(0, 0, 1). The parameters used are damping constant  = 0.5 and gyromagnetic
ratio  = 2.21 105 m/(As).
We consider a 1D system with exchange and anisotropy interactions, so the energy
density of the system is given by
A(2 + sin2 2) + K sin2 
. (3.31)
Note that compared with the standard exchange constant A and anisotropy K, we have
A = (1/2)0Ms A and K = (1/2)0MsK. The effective fields H and H read
H = A
  sin  cos (A2 + K),
H = 2A
 cos  + A sin .
(3.32)
We now look for a domain-wall solution with the form
(z, t) = 0(z z(t)), (z, t) = (t), (3.33)
where
0(z) = 2 arctan exp(z/),  = (A/K)1/2 =
A/K (3.34)
describes a head-to-head domain wall. Note that 0 = sin 0/, we have 
 = 
sin 0/,  = z0, and thus we obtain
z +  = u,
z +  = u.
(3.35)
Chapter 3 Fidimag 29
The final solution is
( )u(t)
(1 + 2)
, z = 
(1 + )u(t)
(1 + 2)
. (3.36)
We add some remarks here. Firstly, the result is an exact solution for the Zhang-Li
extension to the LLG equation, and because its an exact solution we can confirm that
the domain-wall mass exactly equals zero. Secondly, we havent assumed the form of
charge current u, so it could be an arbitrary function u = u(t). And finally, this solution
also holds in the presence of bulk DMI and/or external fields.
0.0 0.5 1.0 1.5 2.0
Time (ns)
=0.2
=0.4
0.0 0.5 1.0 1.5 2.0
Time (ns)
Figure 3.4: A comparison between the simulation and the analytical solution
[Eq. (3.36)] for the motion of a head-to-head domain wall.
To compare with the analytical result [Eq. (3.36)], we apply a time-dependent charge
current with the form u(t) = u0 sin(0t)/(0t) to the system, where 0 =   109 is
selected in the simulation. We make use of the parameters of Permalloy: the saturation
magnetization Ms = 8.6 105 A/m, the exchange constant A = 1.3 1012 J/m and an
effective anisotropy K = 5 104 J/m3. In the simulation we fix the damping constant
 = 0.2 and vary . Figure 3.4 shows the comparison between the simulation results
and the analytical equation (3.36). It is shown that both the domain-wall position and
the domain-wall tile angle  agree with the simulation results very well.
In the presence of easy plane anisotropy, the total energy density of the system becomes
A(2 + sin2 2) + K sin2  + K sin
2  sin2  2H cos 
, (3.37)
30 Chapter 3 Fidimag
wherewe have assumed the easy plane anisotropy is in the xz-plane. The effective fields
are thus given by
H = A
  sin  cos (A2 + K + K sin2 ) H sin , (3.38)
H = 2A
 cos  + A sin   K sin  sin 2. (3.39)
If we search for a solution with  = 0,  = 0 and  = z (the domain-wall profile is
described by  = sin /), we have
 z = K sin  sin 2,
 z = H sin ,
(3.40)
i.e, z = H/, sin 2 = H/(K) and  =
A/(K + K sin
2 ). Therefore, the
corresponding solution for the Zhang-Li model is also exact for a constant u.
3.5.3 Magnetic skyrmions
Magnetic skyrmions are topological solitons, which are considered to be topological
protected particles [47]. In magnetic systems, several mechanisms can be used to gener-
(a) (b)
Figure 3.5: (a) A chiral (vortex-like) skyrmion. (b) A hedgehog (radial)
skyrmion. The skyrmion number is 1.
ate a skyrmion state. For example, both the long-ranged magnetic dipolar interactions
and the Dzyaloshinskii-Moriya interaction (DMI) can lead to skyrmion states. There are
two types of DMI, i.e., bulk DMI and interfacial DMI. Figure 3.5(a) shows a vortex-like
skyrmion with skyrmion number q = 1, where the bulk DMI is used. Meanwhile, a
radial skyrmion is shown in Fig. 3.5(b) in which we have used the interfacial DMI.
Chapter 3 Fidimag 31
We consider a 2D system with energy contributions from the exchange interaction, the
bulk DMI, an uniaxial anisotropy and a Zeeman field. Therefore, the total micromag-
netic energy density is given by
w = A(m/x)
2 + Dm  (m) Km2z  0MsH m. (3.41)
The equilibriummagnetization configurations can be obtained from the Euler-Lagrange
equations [80]
(m/x)
= 0. (3.42)
Since the skyrmion solution is symmetric, wemake use the cylindrical coordinates (r, )
and parameterize the magnetization via the spherical angles ((r), ()) with
m = (sin  cos , sin  sin , cos ), (3.43)
that is, mr + im = sin  exp[i( )]. Skyrmions are thus can be characterized by the
vorticity nv and the helicity nh/2, and thus we define
() = nv + nh/2. (3.44)
It can be seen that the DMI energy depends on both the vorticity and the helicity [47]:
wdmi = Dm  (m) = D sin[(nv  1) +
sin 2
. (3.45)
We look for the solutions with nv = 1 and nh = 1, which results in wdmi =
nhD( + sin  cos /r) where the prime represents the derivative with respect to r.
Similarly, the exchange field can be computed by wex = A[()2 + sin2 ()2] =
A(2 + sin2 /r2). Here, we consider the external field H = Hez. In this situation,
the energy density [Eq. (3.41)] is only a function of  and the Lagrangian density in the
cylindrical coordinates is given by
w = (wex + wdmi + wanis + wh)r. (3.46)
Therefore, by using the Euler-Lagrange equation (3.42) we obtain
 +
 sin  cos 
sin2 
  sin  cos   h sin  = 0, (3.47)
where d = nhD/A,  = K/A and h = 0MsH/(2A). This differential equation can
be solved with standard numerical methods such as the shooting method [62, 81] and
the finite difference method. For a magnetic skyrmion with its core pointing-down, the
corresponding boundary conditions are
(0) = , () = 0. (3.48)
32 Chapter 3 Fidimag
By making use of the assumption that  = sin /r + c(cos   1), we find that  =
2arccot (cr/2) is a solution of Eq. (3.47) if d = 2c, h = c2 and  = c2. Therefore, we
obtain the so called Belavin-Polyakov solution [82]
 = 2 arccot
, (3.49)
where  = 2A/D is the characteristic length. A Belavin-Polyakov skyrmion is a
meta state in the isotropic ferromagnet, in which only the exchange interaction is
included [82]. However, here it is a stable solution, and thereforewe canuse it to validate
Fidimag.
0 50 100 150 200 250 300
r (nm)
D=0.5 mJ/m2
D=1 mJ/m2
D=2 mJ/m2
Figure 3.6: A Belavin-Polyakov skyrmion in the presence of easy plane
anisotropy and Zeeman field.
Figure 3.6 shows the profiles of Belavin-Polyakov skyrmions for different DMI con-
stants. The used parameters are Ms = 8.6 105 A/m, and A = 1.3 1012 J/m. The
simulation result is obtained when the easy plane anisotropy ( < 0) and external field
satisfy h = c2 and  = c2. The sample size is 1001 1001 2 nm3 and the cell size
is 1 1 2 nm3. It is found that the simulation results fit the Belavin-Polyakov profile
[Eq. (3.49)] well.
3.5.4 Normal modes of a spin chain
We consider a 1D spin chain along the z axis including the exchange interaction, DMI
and an anisotropy with its uniaxial axis in z-direction. If the DMI constant D is small,
the ground state is uniform, such as m0 = (0, 0, 1) or m0 = (0, 0,1). For the former
Chapter 3 Fidimag 33
state, i = 0 and i = 0. Hence, for  = 0 Eq. (3.20) reduces to
i(s/)ui = J(vi+1 + vi1  2vi) + D(ui+1  ui1) 2Kvi,
i(s/)vi = J(ui+1 + ui1  2ui) D(vi+1  vi1) 2Kui,
(3.50)
where the total Hamiltonian H = Hex +Hdmi +Han has been used. By introducing a
variable  = u jv with j =
1, we arrive at
J(i+1 + i1  2i) + jD(i+1  i1) 2Ki = (s/)i. (3.51)
The first term in Eq. (3.51) is the discrete Laplace operator for . In the long-wave
approximation, Eq. (3.51) can be cast into
 + k2 + jd = 0, (3.52)
where d = 2D/Ja, k2 = (s/ 2K)/Ja2 and a is the lattice constant. The wavevector
k needs to satisfy
k2 = (n/L)2  (D/Ja)2, (3.53)
where L = Na is the length of the chain and n = 0, 1, 2, ... are integers. Therefore, we
get the frequencies of the normal modes,
= 2K + J
. (3.54)
Figure 3.7 shows the calculated frequencies for a spin chain using Fidimag, where we
have used parameters J = 1, K = 0.01,  = 1, and s = 1. We can find that the Eq. (3.54)
agrees with simulation results very well.
0 1 2 3 4 5 6 7 8 9
D=0.05
D=0.1
Figure 3.7: The frequencies of the normal modes for a spin chain with DMI.
34 Chapter 3 Fidimag
0 0 0 0
h 0 J1 0
Table 3.1: RK2a.
0 0 0 0
3 h 0
3 J1 0
Table 3.2: RK2b.
0 0 0 0
2 h 0
2 J1 0
0 h 0 J1
Table 3.3: RK2c.
3.6 Stochastic LLG equation
For the atomistic spin model, the dynamics in the presence of temperature is governed
by the stochastic LLG (SLLG) equation. In micromagnetics the thermal fluctuation
effects also can be modeled by the SLLG equation [83, 84]. In this situation, the noise
power D is given by
0MsV
. (3.55)
Note the factor of 0; this is because the unit of effective field Heff and saturation
magnetization Ms is A/m while the unit of  is m/(As). There are many numerical
schemes to solve a general stochastic differential equation (SDE) [8590] and some are
developed to solve the SLLG [91, 92]. There are two well-known interpretations for a
SDE, i.e., Stratonovich and It interpretation which are detailed in Appendix ??. An
s-stage stochastic Runge-Kutta method for an SDE is given by
Xi = xn +
Z0ij f (Xj) +
Z1ijg(Xj), i = 1, 2, ..., s (3.56)
xn+1 = xn +
z0ij f (Xj) +
z1ijg(Xj), (3.57)
which can be represented with a table form,
Z0 Z1
z0 z1
. (3.58)
In Fidimag, the implemented schemes are Henu scheme (RK2a) [93], Burrage scheme
(RK2b) [89], EM1 scheme (RK2c) and EM2 scheme (RK3) [85], as shown in Tables 3.1-
3.4. The Henu scheme is the default option in Fidimag.
0 0 0 0 0 0
(2/3)h 0 0 (2/3)J1 0 0
h h 0 J1 J1 0
0 (3/4)h (1/4)h 0 (3/4)J1 (1/4)J1
Table 3.4: RK3 scheme.
Chapter 3 Fidimag 35
3.7 Verification II
3.7.1 A magnetic moment
10-14 10-13 10-12
dt (s)
Analytical
Figure 3.8: Average magnetization of a magnetic moment as a function of time
step dt for different integration schemes. Temperature T = 10 K.
The size of time step is crucial in solving the SLLG equation. We will compare various
integration schemes with different time steps. We consider a single magnetic moment
with s = MsV. In the presence of an uniaxial anisotropy along z-direction, there are
two energy minima  pointing-up or pointing-down. The average magnetization in
thermal equilibrium is given by [94]
mz =
0 exp(z
2)zdz 1
0 exp(z
1 e
(3.59)
where  = KV/kBT and F(z) is the Dawson integral. Figure 3.8 depicts the average
magnetization of the magnetic moment for different integration schemes. It is shown
that the RK3 scheme has a larger convergence area. The used parameters are: V=1 nm3,
Ms = 1281197 A/m, K = 6.9 106J/m3 and damping constant  = 0.1. Therefore, the
typical time (a period of the precession) is T  3.2 ps [94]. From Fig. 3.8 we can find that
dt = 0.1 ps is a safe choice. In Ref. [94] the authors also give a rule on the discretization
time dt, which should be at most 1/30th of the precession time.
36 Chapter 3 Fidimag
1.0 0.5 0.0 0.5 1.0
Analytical
Figure 3.9: The equilibrium probability distribution Peq(mz) of a nanoparticle
at T = 300 K.
3.7.2 Equilibrium distribution of a nanoparticle
As shown in Ref. [95], we consider a nanoparticle with an effective uniaxial anisotropy
along z-direction,
u = Km2z . (3.60)
In the equilibrium state, the probability distribution function (PDF) Peq(mz) satisfies
Peq(mz)  exp(m2z), (3.61)
where  = KV/(kBT). And thus, we have
Peq(mz) =
z , (3.62)
where Z =
z dmz is the partition function. Assume the volume V of the particle
is V = 2.8  1026 nm3, Ms = 1.42  106 A/m and K = 7.2  105J/m3. We obtain
Z = 31.07 for T = 300 K. Figure 3.9 shows the equilibrium probability distribution
Peq(mz) of a nanoparticle at T = 300 K, where the time step dt = 0.5 ps and  = 0.08
are used in the simulation.
3.7.3 Magnon temperature
We consider a quasi-1D spin chainwith exchange interaction and an uniaxial anisotropy
H = J 
i,j
mi mj 
K(ez mi)2. (3.63)
Chapter 3 Fidimag 37
The typical period related to J is T = 2hS/J which gives T = 4.14  1012s for
S = 1 and J = 1 meV, therefore the time step we have used in simulation is dt =
5 1014s which is less than T/60. In the equilibrium state the magnon temperature
Tm and the phonon temperature Tp are the same. Figure 3.10 describes the equilibrium
0.0 0.1 0.2 0.3 0.4 0.5 0.6
magnon temperature kB Tm /J
Simulation
Figure 3.10: Equilibrium magnetization m0 as a function of the magnon tem-
perature Tm. The system size is 1024 4 4.
magnetization as a function of the magnon temperature. It can be seen that the
magnetization in the equilibrium state decreases as the magnon temperature increases.
This behavior can be described by a function,
m0 = (1 Tm/Tc) (3.64)
where Tc is the Curier temperature. The fitted parameters as shown in Fig. 3.10 are
 = 0.3683 and Tc = 0.91J/kB. However, in general both Tc and  are related to the
system size.
Chapter 4
Phenomenological description of
nonlocal damping
Preface
Thework presented in this chapter has been published in [1], in which Prof. Volodymyr
V. Kruglyak and Dr. Mykola Dvornik have rewritten the introduction part and some
equations.
4.1 Introduction
The Landau-Lifshitz-Gilbert (LLG) equation is a fundamental equation that has been
widely used in all areas related to magnetics. This is evidenced by its widespread im-
plementation in various micromagnetic packages based on finite difference or finite el-
ement method. [2426, 96, 97]. Initially, the software for such numerical micromagnetic
simulations of magnetization dynamics is based on solving the Landau-Lifshitz equa-
tion [66] with a transverse magnetic relaxation term, either in the original (Landau) [66]
or Gilbert" [8] form. Over time, dictated by the experimental and technological needs,
the solvers have been modified to include finite temperature effects [65] and additional
contributions to the magnetic energy (and therefore to effective magnetic field) [98].
The recent advances in spintronics and magnonics have led to the implementation of
various spin-transfer-torque terms [28, 69].
The LLG equation was explained by Thomas Gilbert as the Lagrange equation with
a Rayleighs dissipation term [8], thus, the second term in the LLG equation is called
Gilbert damping term. The Gilbert damping can be determined by ferromagnetic
resonance (FMR) experiments. However, some results given by LLG equation are in
contradiction with both experimental data and microscopic calculation. For example,
40 Chapter 4 Phenomenological description of nonlocal damping
a microscopic calculation gives the dependence of spin-wave damping decrement for
short-wave magnons proportional to k4 while the LLG equation shows a dependence
proportional to k2, where k is the spin-wavewavevector [37]. Also, there is a deviation
between damping parameter FMR obtained from FMR and DW calculated from the
domain-wall resonance (DWR) for low-damping ferrimagnetic materials [99].
The magnonics of magnetic systems as a fundamental research topic have attracted
great attention for its potential application [11, 100, 101]. The decay length of magnons
(also called spin waves) is directly related to the damping mechanisms. Different forms
of damping have been suggested, for example, a tensor form of magnetization damp-
ing was proposed to describe the magnetization relaxation processes of a uniformly
magnetized film or particle [39]. In addition, enhanced damping phenomena are ob-
served experimentally [38] and explained as the results of both the interlayer [42] and
intralayer [41] spin pumping.
The intrinsic Gilbert damping is generally considered to have a relativistic origin [66,
102]. Indeed, the relativistic corrections to the Hamiltonian between the spin to the
electric field leads to the Gilbert damping [102]. The nonlocal damping was predicted
for strongly noncollinear magnetizations [40, 103, 104], However, different forms of
nonlocal damping are derived using different theories, for example, the diffusion-type
term m2tm has been obtained by taking into account the disorder and electron-
electron scattering [103] or by expanding the dissipative terms to higher order in spatial
derivatives [105], and the tensor form has been proposed by including the role of con-
duction electrons explicitly in magnetization dynamics [104, 106]. Phenomenologically,
the theories operate with the magnetization (i.e. the magnetic moment density) and
the effective magnetic field as generalized coordinates and forces respectively [66, 107].
The effective magnetic field is defined in terms of various magnetic material parame-
ters, which are determined by fitting theoretical results to experimental data, and at
least in principle, can be calculated using the quantum-mechanical or atomistic meth-
ods. A natural question iswhether some phenomenological theories give these nonlocal
damping terms.
In this chapter, we demonstrate how the phenomenological magnetic relaxation term
derived by Baryakhtar to explain the discrepancy betweenmagnetic damping constants
obtained from ferromagnetic resonance (FMR) and magnetic domain-wall velocity
measurements [108110] in dielectrics can be applied to magnetic metallic samples.
We show that the Landau-Lifshitz equation with the Baryakhtar relaxation term (the
Landau-Lifshitz-Baryakhtar or simply LLBar equation) contains the Landau-Lifshitz-
Gilbert equation as a special case, while also naturally including the contribution from
the nonlocal damping in a tensor form. Here we focus primarily on the manifestations
of the Baryakhtar relaxation in problems specific for magnonics [11] and domain-wall
dynamics [111, 112]. This is achieved by incorporating the LLBar equation within
Fidimag, and by comparing the results of simulations with those from simple analytical
Chapter 4 Phenomenological description of nonlocal damping 41
models. Specifically, we demonstrate that the Baryakhtar relaxation leads to increased
damping of short wavelength spin waves and to modification of the domain-wall
mobility, the latter being also affected by the longitudinal relaxation strength.
This chapter is organized as follows. In Sec. 4.2, we review and interpret the Baryakhtar
relaxation term. In Sec. 4.3, we calculate and analyze the spin-wave decay in a thin
magnetic nanowire. In Sec. 4.4, we analyze the domain-wall motion driven by the
external field and compare the relative strength of contributions from the longitudinal
and nonlocal damping. In Sec. 4.5, we extract the damping fromdynamic susceptibility.
We conclude the discussion in Sec. 4.6.
4.2 Basic equations
In the most general case, the LLBar equation can be written as [108, 113]
= MHeff + R (4.1)
where (> 0) is the gyromagnetic ratio and the relaxation term R is
R = r Heff  e,sp
2Heff
xsxp
. (4.2)
Here and in the rest of the chapter, the summation is automatically assumed for repeated
indices. The two relaxation tensors r and e describe relativistic and exchange
contributions, respectively, as originally introduced in Ref. [109].
To facilitate comparison with the Landau-Lifshitz-Bloch (LLB) equation as written in
Ref. [114], the magnetic interaction energy of the sample is defined as
w = w +
(M2 M2e )2
, (4.3)
where Me is the equilibrium magnitude of the magnetization vector at a given tem-
perature and zero micromagnetic effective field, i.e. the effective field derived from
the micromagnetic energy density w, as used in standard simulations at constant tem-
perature under condition |M| = Me = const (i.e. with only the transverse relaxation
included). The second term on the right-hand side of Eq. (4.3) describes the energy den-
sity induced by the small deviations of the magnetization length from its equilibrium
value Me at the given temperature, i.e., |M2  M2e |  M2e , and  is the longitudinal
magnetic susceptibility. Therefore, the associated effective magnetic field is
Heff = 
= H +
(1 n2)M (4.4)
42 Chapter 4 Phenomenological description of nonlocal damping
where n = M/Me, H is the effective magnetic field associated with w. Hereafter
we assume that our system is in contact with the heat bath, so that the equilibrium
temperature and associated values of Me and  remain constant irrespective of the
magnetization dynamics.
In accordance with the standard practice of both micromagnetic simulations and ana-
lytical calculations, to solve LLBar equations (4.1-4.4), one first needs the corresponding
static equations obtained by setting the time derivatives to zero and thereby to derive
the spatial distribution of the magnetization in terms of both its length and direction.
We note that, in general (e.g. as in the case of a domain wall), the resulting distribution
of the longitudinal effective field and therefore also of the equilibrium magnetization
length is nonuniform, so that the length is not generally equal to Me. With the static
solution at hand, the dynamical problem is solved to find the temporal evolution of
the magnetization length and direction following some sort of a perturbation. Crudely
speaking, the effect of the relaxation terms is that, at each moment of time, the magne-
tization direction relaxes towards the instantaneous direction of the effective magnetic
field, while the magnetization length relaxes towards the value prescribed by the in-
stantaneous longitudinal effective magnetic field. The effective field itself varies with
time, which makes the problem rather complex. However, this is the same kind of com-
plexity as the one that has always been inherent in micromagnetics. One should note
that the longitudinal susceptibility has a rather small value at low temperature, so its
account is only required at temperatures of the order of the Curie temperature.
We neglect throughout the chapter any effects due to the anisotropy of relaxation,
which could be associated with, e.g., the crystalline structure of the magnetic material
[108, 113]. This approximation is justified for polycrystalline and amorphous soft
magnetic metals, as has been confirmed by simulations presented in Ref. [113]. Hence,
we represent the relaxation tensors as r = r I and e = e I where parameters r
and e are the relativistic and exchange relaxation damping constants and I is the unit
tensor. Then, Eq. (4.1) is reduced to
tM = MHeff + rHeff  e2Heff. (4.5)
We separate the equations describing the dynamics and relaxation of the length and
direction of the magnetization vector. Representing the latter as a product of its
magnitude and directional unit vector M = Mm, we can write
= MHeff + R. (4.6)
We multiply this equation by m to obtain,
= m  R. (4.7)
Chapter 4 Phenomenological description of nonlocal damping 43
Then, subtracting the product of Eq. (4.7) and m from Eq. (4.6), we obtain
= mHeff +
R (4.8)
where R = m (m R). In the rest of the paper, we will use A  (A)  A
(A m)m to represent the component of the vector A that is perpendicular (transverse)
to vector m. Note that only the perpendicular component of the torque contributes to
tm  m/t. For given temperature, Me is constant and we can define  = r/(Me).
In the limiting case of   0, M  Me and thus  is recognized as the Gilbert
damping constant from the LLG equation. Let us now consider the case of e 6= 0.
The corresponding contribution to the relaxation term, which we denote here as BBar,
can be written as
BBar = e2Heff  iji, (4.9)
where i  /xi and the quantity ji = eiHeff has the form of some magnetization
current density (magnetization flux).
For the following, it is useful to split the effective field into its perpendicular (relative
to m) part (Heff, perpendicular field") and parallel part (H
eff, parallel field"), i.e.,
Heff = Heff + H
eff, and then to consider the associated magnetic fluxes and torques
separately. The magnetic flux of j,i = eiH
eff and then the contribution of the
associated torque  = ij,i onto m is
() = 2eiH
effim eH
eff(
2m). (4.10)
The perpendicular field can be represented as
Heff =
M M
+ O(R)  1
[m tm] . (4.11)
So, we can write for the magnetization flux associated with the perpendicular field
j,i = (e/)i(m tm). (4.12)
The right-hand side of Eq. (4.12) is the dissipative spin current [105], which can
be interpreted as the dynamically driven spin pumping [105]. For the associated
perpendicular torque , we obtain,
 = ij,i = Meii(m tm), (4.13)
where we have introduced a variable  = e/(Me). We show that the torque ()
could be written as (see Appendix A.1 for details)
() = Me
m (D  tm) m2tm
, (4.14)
44 Chapter 4 Phenomenological description of nonlocal damping
where D is a 3 3 tensor [104, 106],
D = 2(m im)(m im)  (im  im). (4.15)
In the limit of  0, we assume Heff = 0 and therefore obtain
tm = mHeff  m (mHeff) + m (D  tm) m2tm. (4.16)
At the same time, Eq. (4.8) can then be written as
= mHeff  m (mHBeff), (4.17)
where
HBeff = Heff  2Heff, (4.18)
and Heff is the transverse component of the effective field. The first term in Eq. (4.18)
is kept as Heff since m  Heff = m  Heff. In practice, we use the simplified LLBar
(sLLBar) equation (4.17) rather than Eq. (4.16) for numerical implementation. As shown
in Eq. (4.16) the damping terms contain both the form m  2tm [103, 105] and
tensor form m (D  tm) [106]. Hence, we conclude that the exchange damping can
be explained as the nonlocal damping, and Eq. (4.17) is the phenomenological equation
to describe the nonlocal damping.
Phenomenologically, the Gilbert damping is local and the damping due to the nonuni-
form magnetization dynamics being ignored [8]. The exchange relaxation term in the
LLBar equation describes the nonlocal damping due to the nonuniform effective field.
Despite the complexity of various damping mechanisms, the spin current j in conduct-
ing ferromagnets can be calculated, e.g. using the time-dependent Pauli equationwithin
the s-d model. The spin current is then given by ji = (gBhG0/4e2)(tm im), where
G0 is the conductivity [106], and thus the nonlocal damping of the tensor form can be
obtained [104, 106]. As we can see fromAppendix A.1, this spin current densities ji and
jai have the same form, and therefore, we can establish that   gBhG0/4e2Me. The
spin current component jbi (see Appendix A.1) gives the term m2tm [105], and
the value of  can therefore be interpreted as   (/0Me)(h/2)2nesc/m, where ne
is the conduction electron density, m is the effective mass and sc is the transverse spin
scattering time [41].
It is of interest to compare Eq. (4.5) with the LLB equation [114], which could be written
= nHeff +
[n Heff]n
n (nHeff), (4.19)
where n = M/Me(T) is the reduced magnetization and Me(T) is the equilibrium
magnetization value at temperature T. The effective field Heff contains the usual
Chapter 4 Phenomenological description of nonlocal damping 45
micromagnetic contributions Hint as well as the contribution from the temperature,
Heff = Hint +
(1 n2)n, (4.20)
where me = Me(T)/Me(0) and  = m/H with m = M/Me(0) [114]. By substituting
Eq. (4.20) into Eq. (4.19), one arrives at
= nHint + (Hint) + (Hint) +
me
(1 n2)n. (4.21)
Meanwhile, if we neglect the e term in Eq. (4.5) and insert the effective field equa-
tion (4.3) into Eq. (4.5), we obtain
= nHint + rHint +
(1 n2)n. (4.22)
As we can see, Eq. (4.22) is a special case of the LLB equation with the assumption that
 =  = r/(Me) and  = Me(0). However, the LLB equation does not contain
the e-term (nonlocal damping term) which is the main focus in this work.
4.3 Spin-wave decay
To perform the micromagnetic simulation for the spin-wave decay, we have imple-
mented the sLLbar equation (4.17) in Fidimag. A new variable  for the exchange damp-
ing is introduced with  = G, where G is a coefficient to scale  to the same order as
. In practice, G was chosen to be G = A/(0M2e ).
The simulation geometry has dimensions Lx = 2002nm, Ly = 2nm and Lz = 2nm,
and the cell size is 1 2 2 nm3. The magnetization aligns along the ex direction for
the equilibrium state and the parameters are typical of Permalloy: the exchange constant
A = 1.3 1011 J/m, the saturationmagnetization Me = 8.6 105 A/m and the Gilbert
damping damping coefficient  = 0.01. The spin waves are excited locally in the region
0  x  2nm, and to prevent the spin-wave reflection the damping coefficient is
increased linearly [115] from 0.01 at x = 1802nm to 0.5 at x = 2002nm.
Figure 4.1 illustrates the spin-wave amplitude decay along the rod. The y component
of magnetization unit vector my data for 30  x  1800 nm was fitted using (4.23) to
extract the wave vector k and the decay constant , and good agreement is observed
due to the effective absence of spin-wave reflection. We use data after having computed
the time development of the magnetization for 4 ns to reach a steady state. The injected
spin-wave energy is absorbed efficiently enough within the right 200 nm of the rod due
to the increased damping.
46 Chapter 4 Phenomenological description of nonlocal damping
0.04
0.02
 0  500  1000  1500  2000
x (nm)
Simulation
Exponential fitting
Figure 4.1: The spin-wave amplitude decay along the rod, for a spin wave was
excited locally by applying a microwave H = H0 sin(2 f t)ey of frequency
f = 30 GHz and amplitude H0 = 1000 Oe in the region 0  x  2 nm. The
data were fitted using Eq. (4.23) with  = 0.02 and  = 0.01.
To analyze the simulation data, we exploit the uniform plane-wave assumption with
its exponential amplitude decay due to energy dissipation, i.e. magnetization with the
form ei(kxt)ex, where  is the characteristic parameter of the spin-wave damping.
For a small-amplitude spin-wave propagation we have [100]
m = ex + m0e
i(kxt)ex, (4.23)
where |m0|  1, and the effective field of the long rod can be expressed as
Heff = Hsmxex + D2m, (4.24)
where the easy axis anisotropy field Hsmxex originates from the demagnetizing field,
and the constant D measures the strength of the exchange field,
Me, D =
. (4.25)
To test the spin-wave decay for this system, a sinusoidal field H = H0 sin(2 f t)ey was
applied to the rod in the region 0  x  2 nm to generate spin waves.
Figure 4.2 shows the product of the spin-wave-decay constant  and wave vector k as
a function of the frequency. The dependence is linear for the  = 0 case, which is in
agreement with the case with the zero adiabatic spin torque [100]. The addition of a
nonzero  term leads to a nonlinear relation, and the amplitude of the spin-wave-decay
constant that is significantly larger than that given by the linear dependence. We also
performed the simulation for the  > 0 case by using Eq. (4.5) which shows that the
 term is the leading factor for this nonlinearity (the relative error is less than 1% for
 = 1 103). To analyze the nonlinear dependence, we introduce the complex wave
vector k,
k = k + i. (4.26)
Chapter 4 Phenomenological description of nonlocal damping 47
20 40 60 80 100
Frequency f (GHz)
=0.01
=0.02
Eq. (4.31)
=0.01
=0.02
Eq. (4.31)
Figure 4.2: The spin-wave decay constantwave vector product k as a function
of the frequency for different  values. The slateblue line was drawn using
Eq. (4.31) for the case  = 0.01.
By linearizing Eq. (4.17) and setting the determinant of the matrix to zero we obtained
(see Appendix A.2 for details):
( + 0 + i1)( 0 + i1) = 0, (4.27)
where 0 = (Hs + Dk2) and 1 = 0 + Gk20. The second term in Eq. (4.27) is
expected to be equal to zero, i.e., 1 i + i0 = 0. There are two scenarios to consider:
the first is the  = 0 case, in which k could be extracted by taking the imaginary part
of k2 in Eq. (4.26):
2(1 + 2)D
. (4.28)
The linear dependence of k as a function of frequency matches the data plotted in Fig.
4.2. For the  > 0 case, solving (4.27) directly gives
k2 =  b
1 4c
, (4.29)
where a = DG, b = (i + )D + GHs and c = (i + )Hs  i. Taking a Taylor
expansion of (4.29) about a = 0 yields
k2   c
a. (4.30)
By neglecting the higher order terms such as 2,  and 2, we obtained
k  
( + Gk2), (4.31)
where the dispersion relation for the rod is  = (Hs + Dk2). Equation (4.31) shows
48 Chapter 4 Phenomenological description of nonlocal damping
there is an extra k2 term associated with the exchange-damping term in addition to
the linear dependence between k and . The slateblue line in Fig. 4.2 is plotted
using Eq. (4.31) with  = 0.01 and  = 0.01, which shows a good approximation
for the simulation data. This exchange damping could be important in determining
the nonadiabatic spin torque. We could establish the value of  using the existing
experimental data, for example, the transverse spin current data [41] gives   0.1
which hints that the lifetime and propagation length of short-wavelength magnons
could be much shorter than those given by the LLG equation [116].
4.4 Domain-wall motion
We implemented the LLBar equation (4.5) in Fidimag to study the effect of parallel
relaxation process on domain-wall motion. The simulated system for the domain-wall
motion is a one-dimensional (1D) mesh with a length of 20000 nm and a discretization
size of 4 nm. A head-to-head domain wall is initialized with its center near x = 500
nm. In this section, the demagnetizing fields are simplified as Hd = NM and the
demagnetizing factors are chosen to be Nx = 0, Ny = 0.2 and Nz = 0.8, respectively.
The domainwall moves under the applied field for 50 ns and the domain-wall velocities
at different external field strengths are computed. Figure 4.3 shows the simulation
results of domain-wallmotion under external fields for different susceptibilitieswithout
consideration of exchange damping, i.e.,  = 0. The longitudinal susceptibility is
around 104 at room temperature and increases with the temperature [114]. We find
that the longitudinal susceptibilities have no influence on the maximum velocity but
change the Walker breakdown field Hw significantly. The domain-wall velocity in the
limit  0 is almost the same as in the case of  = 104, which could be explained by
the difference proportional to the ratio of (/)2 in Eq. (4.54).
To investigate the effect of longitudinal magnetic susceptibility  and exchange relax-
ation damping  on the domain-wall motion, we use the remainder of this section
for analytical studies. We start from the constant saturation magnetization of a one-
dimensional domain-wall model, such as the 1D head-to-head wall [117]. The static 1D
domain-wall profile can be expressed as
mx =  tanh
, mt = sech
(4.32)
where mt is the perpendicular component of the unit magnetization vector,  is the wall
width parameter and q is the position of the domain-wall center.
We consider the case in which the system is characterized by two anisotropies, easy
uniaxial anisotropy K and hard plane anisotropy K, which originate from demagne-
tization. The aim is to analyze the impact of the longitudinal magnetic susceptibility
Chapter 4 Phenomenological description of nonlocal damping 49
0 200 400 600 800 1000 1200
Applied field (A/m)
=1103
=5104
=1104
=1103
=5104
=1104
Figure 4.3: Simulations results of domain-wall velocities for various suscepti-
bilities. The parameters used are:  = 0.001,  = 0, Ny = 0.2 and Nz = 0.8.
The vertical dashed lines are the breakdown fields computed using Eq. (4.54).
under the 1D domain-wall model, the demagnetization energy density can be written
Ean = 
M2x +
M2z , (4.33)
where K = (1/2)(Ny  Nx)0M2e and K = (1/2)(Nz  Ny)0M2e . In the limit case
 0 case, the effective anisotropy energy density Ean can be rewritten as
Ean = K sin
2 (1 +  sin2 ), (4.34)
where m = (cos , sin  cos , sin  sin ) is used and  = K/K is the ratio between
hard plane anisotropy strength and easy uniaxial anisotropy strength.
The dynamics of the domain wall with the 1D profile can be described using three
parameters [118]: the domain-wallwidth , the domainwall position q and the domain-
wall tilt angle . In this domain-wall model, one can assume that (x, t) = (t) is only
a function of time. Thus, the magnetization profile for the head-to-head domain wall is
given by
(x, t) = 2 tan1 exp
x q(t)
, (x, t) = (t). (4.35)
Using the magnetization unit vector to calculate the exchange energy is a good approx-
imation for the case  1, thus, the total energy density can be rewritten as
Etot =
(M2 M2e )2
+ M2w(m), (4.36)
where
w(m) =
(m)2  K
m2x +
m2z . (4.37)
50 Chapter 4 Phenomenological description of nonlocal damping
Within the 1D domain-wall profile, Hm, the longitudinal component of the effective
field is obtained:
Hm = m Heff =
2M2e
(M2e M2) 2MP sin2 , (4.38)
where P is defined as
0M2e
+ K(1 +  sin2 )
. (4.39)
As we can see, P is a function of the tilt angle  and the domain-wall width . At the
static state, Hm should equal zero, i.e., dM/dt = 0, which gives
M2 = (1 4P sin2 )M2e . (4.40)
Equation (4.40) shows that the difference between magnetization length M and Me
reaches its maximum at the center of the domain wall due to the effect of the exchange
field, which also peaks in the center of the domain wall. According to Eq. (4.40), we can
estimate that the magnetization length difference is M  2P sin2  for the   1
case. Figure 4.4 shows the magnetization length differences of a 1D domain wall for
various , it can be seen that this approximation for M agrees very well with the
simulation results.
460 480 500 520 540 560 580
xs (nm)
=1103
=5104
=1104
Eq. (4.40)
=1103
=5104
=1104
Eq. (4.40)
Figure 4.4: Simulation results of the magnetization length difference M for
a 1D domain wall located at x = 500 nm with Me = 8.6  105 A/m. The
demagnetizing factors are selected to be Nx = 0 and Ny = Nz = 0.5.
In the dynamic case, Hm is not equal to zero. If we wrote Eq. (4.38) as Hm = FM, we
would find that the nontrivial term that contributes to Hm is
(1M2/M2e ) 2P sin2 . (4.41)
Chapter 4 Phenomenological description of nonlocal damping 51
As an approximation for Hm, we expect dF/dt = 0 [119], which gives
m2t mx. (4.42)
In this approximation, we have ignored the terms containing dP/dt and thus the
amplitude of Hm is influenced by only the domain-wall velocity. We employ the
Lagrangian equation combined with dissipation function F to compute the domain-
wall dynamics [111]. The Lagrange equations are
= 0, (4.43)
where X refers to q,  and . The dissipation function is defined by F =
F dx where
0Me[H
eff + (Heff)2], (4.44)
is the dissipation density function.
4.4.1 Parallel relaxation
We neglect the exchange damping term with assumption that  2 and arrive at
0MeH
eff =
0Me(H
 + H
m), (4.45)
where H and Hm are the perpendicular and parallel components of the effective field.
If we also assume that    1, H2 can be approximated by Eq. (4.11),
H2 =
m2 =
(2 + sin2 2). (4.46)
Substituting Eqs. (4.42) and (4.46) into Eq. (4.45) and integrating over space, we obtain
F = 0Me
2 +
(1 + Q)
, (4.47)
where we have ignored the  term. This term leads to the optimal domain-wall
width [111]:
A/(K + K sin
2 ), (4.48)
and for  = 0 the optimal domain-wall width reduces to 0 =
A/K. In what follows,
the domain-wall-width parameter (t) is approximated by the optimal wall width. The
parameter P is then
2K(1 +  sin2 )
0M2e
0M2e
, (4.49)
52 Chapter 4 Phenomenological description of nonlocal damping
and it is straightforward to find its minimum P0 = 2K/(0M2e ), which corresponds to
 = 0.
The introduced parameter Q in Eq. (4.47) is given by Q = (32/15)P2(/)2 and its
value is determined by the ratio of  and , which could be  1 although we assume
    1. Following the treatment of Ref. [111], the integrated Lagrangian action L
is given by
(Etot +
 cos ) dx
+ 2K(1 +  sin2 )(1V) 20MeHaq +
20Me
(4.50)
where 0Me cos / is the Berry phase term [120], and V = 8P/3 is a result of the
varying magnetization that introduced a pinning potential. However, the potential is
fairly small and therefore is negligible since V  Q. By substituting Eqs. (4.50) and
(4.45) into Eq. (4.43),
 + 
(1 + Q) = Ha,
  =  Hk
sin 2.
(4.51)
where Hk = 2K/(0Me). The domain-wall dynamics is governed by Eq. (4.51), by
eliminating q we obtain an equation about ,
1 + 2(1 + Q)
[Ha  Hw(1 + Q) sin 2] (4.52)
where Hw = Hk/2 is the Walker breakdown field. From Eq. (4.52) we can find that the
critical value of  is approximately equal to /4 if Q 1, which leads to the maximum
value of P being P1 = 2K(1 + /2)/(0M2e ). There exists an equilibrium state  such
that  = 0 if Ha < Hw(1 + Q),
sin(2) = h  Ha
Hw(1 + Q)
, (4.53)
which means the Walker breakdown field Hw for the  > 0 case is increased to
Hw(1 + max{Q}), i.e.,
Hw = Hw
, (4.54)
where P1 is themaximumvalue of P. For this steady-state wall motion, the domain-wall
velocity is
1 + Q()
, (4.55)
where
 = 0/
1 h2). (4.56)
Chapter 4 Phenomenological description of nonlocal damping 53
Therefore,   0 in the limit case Ha  0, and the domain-wall mobility  is given
P20 (
, (4.57)
where P0 is the minimum value of P. In Fig. 4.3 the corresponding Walker breakdown
fields are plotted as vertical dashed lines, which gives a good approximation for the
 = 5 104 and  = 1 104 cases. The simulation results show that the Walker
breakdown field Hw could be changed significantly if the longitudinal susceptibility is
comparable to the damping constant.
4.4.2 Nonlocal damping
0 200 400 600 800 1000 1200 1400
Applied field (A/m)
=0.01
=0.02
=0.01
=0.02
Figure 4.5: Simulation results of domain-wall velocities for the limit case that
  0 with various exchange dampings. The parameters used are:  = 0.005,
Ny = 0.4 and Nz = 0.6. The vertical dashed lines are the breakdown fields
computed with Eq. (4.61).
In this part we consider the domain-wall motion influenced by exchange damping for
the case that  0. The dissipation density function (4.44) thus becomes
0Me
H2 + (H)2 + (H)2
, (4.58)
where H and H are the two components of the effective field, and H is computed
using Eq. (4.46). After performing the calculation we obtain
F = 0Me
2( +
. (4.59)
54 Chapter 4 Phenomenological description of nonlocal damping
We take the same Lagrangian action (4.50) for  = 0 and arrive at
 + ( +
= Ha,
 ( + 
) = 
sin 2.
(4.60)
Similarly, the corresponding Walker breakdown field changes to
Hw =
, (4.61)
where 1 = 0
1/(1 + /2). The domain-wall mobility is given by
. (4.62)
As we can see, the nonlocal damping term  influences the domain-wall motion as
well, and we can establish that /2 = (1 + /2)K/(0M2e )  . Therefore, for the
scenarios that K  0M2e , the contributions from the Gilbert and nonlocal damping are
of the order of magnitude for both the domain-wall mobility and Walker breakdown
field.
Figure 4.5 shows the domain-wall velocities for domain-wall motion driven by external
fields in the limiting case of   0. The simulation results are based on a one-
dimensional mesh with a length of 10000 nm and a cell size of 2 nm. The damping
 is set to 0.005 and the demagnetizing factors are chosen to be Nx = 0, Ny = 0.4 and
Nz = 0.6. As predicted by Eq. (4.61), the nonlocal damping  leads to an increment of
the Walker breakdown field, and Eq. (4.61) fits the simulation results very well.
4.5 Ferromagnetic resonance (FMR)
The nonlocal damping effect can be measured from Ferromagnetic resonance
(FMR) [41]. In what follows, we compute the magnetic absorption spectra for the
given systems and then extract the damping  from the magnetic spectra. The magnetic
spectra are calculated by applying a sinc-function pulse in the form h = h0sinc(0t)ez
to the stable states, we collect the average magnetization evaluation and thus the dy-
namical susceptibility  can be computed by means of the Fourier transformation. For
an ellipsoidal magnet the xy-component of susceptibility xy is given by
xy() =
im
(x + i)(y + i)2
, (4.63)
where  is the Gilbert damping,  = Ms, x = Hx and y = Hy. The effective
fields in x- and y- directions are Hx and Hy, respectively.
Chapter 4 Phenomenological description of nonlocal damping 55
0 5 10 15 20
Frequency (GHz)
5.8GHz 9.8GHz
Figure 4.6: Real part of dynamic susceptibility xy for an elliptical-shaped
nanomagnet. Inset: Power plotting of the Endmode and the Center mode.
Next, we consider the elliptical-shaped nanomagnets with the nominal dimensions are
240 200 10 nm3, 360 300 10 nm3 and 480 400 10 nm3, respectively. Figure 4.6
shows the magnetic spectra for the ellipsoidal magnet with a width of 300 nm, and a
cell size of 2.5 2.5 5 nm3 has been used. In addition, an external field He = 500 mT
is applied in the x-direction. Three peaks are found from the dynamic susceptibility.
The first two peaks are found at frequencies f = 5.9 GHz and f = 9.9 GHz, and lowest
frequency is the so called End mode, as we can see from the Insert of Fig. 4.6. The
second mode is the Center mode with frequency f = 9.9 GHz.
200 300 400
Width (nm)
0.015
0.017
0.019
0.021
0.023
Center
200 300 400
Width (nm)
0.015
0.017
0.019
0.021
0.023
0.025
=0.1
Center
Figure 4.7: (a) The extracted damping as a function of the nanomagnet width
using LLG equation. (b) The corresponding damping using the LLBar equation
with  = 0.1. The Gilbert damping  = 0.01 is used.
Figure 4.7 shows the fitted damping using Eq. (4.63) from the simulation data for
56 Chapter 4 Phenomenological description of nonlocal damping
different samples. In the simulation, the Gilbert damping is fixed at  = 0.01. The
extracted damping is larger than the inputted Gilbert damping. For the End mode,
the largest sample (its width is 480 nm) has the highest fitted damping while the second
sample has the highest fitted damping for the Center mode. In the presence of
exchange damping, i.e,  > 0, all the fitted dampings are increased. However, the
increment for the End mode is much larger than that for the Center mode.
4.6 Summary
We explain the exchange damping" in the Landau-Lifshitz-Baryakhtar (LLBar) equa-
tion as nonlocal damping by linking it to the spin current pumping, and therefore the
LLBar equation (4.17) can be considered as a phenomenological equation to describe
the nonlocal damping. In the presence of nonlocal damping, the lifetime and propaga-
tion length of short-wavelength magnons could be much shorter than those given by
the LLG equation. Our simulation results show that the spin-wave amplitude decays
much faster in the presence of nonlocal damping when spin waves propagate along a
single rod. The analytical result shows that there is extra nonlinear dependence scaling
with k2 between k (the product of spin-wave decay constant  and wave vector k) and
frequency  due to the nonlocal damping. Using the micromagnetic simulation based
on the LLBar equation, we show that the difference between magnetization length M
and Me reaches its maximum at the center of the domain wall. For the cases that   
where  is the longitudinal magnetic susceptibility and  is the Gilbert damping, the
Walker breakdown field will increase significantly. By using a 1D domain-wall model,
we also show that both the domain-wall mobility and the Walker breakdown field are
strongly influenced by the nonlocal damping as well.
Chapter 5
Magnon-driven domain-wall motion
with Dzyaloshinskii-Moriya
interaction
Preface
In this chapter, we have used the parameters of Permalloy in the micromagnetic
simulations, the work presented in this chapter with parameters of material FeGe has
been published in [2].
5.1 Introduction
A magnetic domain wall (DW) is a topological soliton in magnetic materials. The
manipulation of domain-wall motion has been extensively studied in the past few years
due to potential applications in logic devices and data storage technology [121125]. A
DW can be driven by an applied field [78], microwaves [126], spin transfer torque [28]
and spin waves (magnons) [30, 115, 127]. Spin waves can drive the DW effectively since
they carrymagnonic spin current. In general, when the spinwaves travel through aDW,
the DW acquires a negative velocity  relative to the propagation direction of the spin
waves  due to conservation of angular momentum [127], although positive velocities
have been observed in micromagnetic simulations at special frequencies [36, 115, 128,
129].
Angularmomentum conservation plays a crucial role in spinwave inducedDWmotion:
when the spinwave passes through the DW, themagnonic spin current changes its sign,
which generates a torque and the DW moves in order to absorb this torque. Magnons
58 Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction
can be considered as particles with angular momentum h and linear momentum hk
[127]. When the spinwave is reflected, linearmomentum is transferred to theDWwhich
results in DW motion [36, 130]. The difference between these two mechanisms is that
the DWmoves in opposite directions [130, 131].
The Dzyaloshinskii-Moriya interaction (DMI) is an anti-symmetric interaction induced
by spin-orbit coupling due to broken inversion symmetry in lattices or at the interface
of magnetic films [61]. The DMI can lead to chiral magnetic orders such as skyrmions
and spin spirals [61, 62, 132, 133]. In addition, the DMI has brought new phenomena
for DW dynamics driven by fields [45] or charge currents [46]. The DMI has been found
both for magnetic interfaces [62] and bulk materials such as MnSi [63] and FeGe [64].
It is well known that DMI leads to nonreciprocal spin-wave propagation [133]. So it is
very natural to askwhatwill happenwhenmagnons pass through aDW in the presence
of DMI.
In this chapter, we perform the micromagnetic simulation for a one-dimensional (1d)
system with DMI and anisotropies. We demonstrate that spin waves passing through a
domainwall in the presence of DMI and an easy-plane anisotropy drive the domainwall
very effectively. We attribute this to linear momentum transfer and show that this effect
can be an order of magnitude more efficient than the better known angular momentum
transfer.
5.2 The system
In this work we focus on bulk DMI with micromagnetic energy density dmi =
Dm  (m) where D is the DMI constant and m is the normalized magnetization.
We consider a quasi-1D nanowire with exchange interaction, DMI and two effective
anisotropies. One anisotropy K is the uniaxial anisotropy along the x-axis, and the
other effective K is an easy xy-plane anisotropy. The combined anisotropies can be
considered as a model of overall effect including the demagnetization field, surface or
magnetoelastic anisotropy [64, 134]. The total free energy for the wire along the x-axis
E = S
A(m)2  Km2x + Km2z + dmi
dx, (5.1)
where S is the cross-sectional area of the wire and A is the exchange constant. The
dynamics of the magnetization m is governed by the Landau-Lifshitz-Gilbert (LLG)
equation
= mHeff + m
, (5.2)
where  (> 0) is the gyromagnetic ratio and  is the Gilbert damping. The effective
field Heff is calculated as the functional derivative Heff = 1/(0Ms)E/m =
Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction 59
2/(0Ms)[A2mDm+KmxexKmzez]with Ms the saturationmagnetization
and 0 the vacuum permeability.
5.3 Domain-wall profile and Spin-wave excitation
100 0 100
x (nm)
-0.15 km 0 km 0.15
k (nm1 )
DMI-magnons torque x
(b) (c)
Figure 5.1: (a) Illustration of the head-to-head DW in the nanowire using
red-blue opaque arrows, the translucent purple arrows represent a spin-wave
excitation. The DMI exerts a torque to change the DW tilt angle when spin
waves pass through the DW. (b) DW profile using Eq. (5.7) with parameters
A = 1.3  1011 J/m, K = 8  104 J/m3, D = 4  104J/m2 and Ms =
8.0  105 A/m for K = 0. The red dashed line shows the simulation data
for mz with K2 = 6 105 J/m3: the easy-plane anisotropy favours a reduced
mz. (c) The dispersion relations inside and outside the DW.
The typical DW structures described by the energy [Eq. (5.1)] for the case D = 0 are
head-to-head and tail-to-tail DWs, and the former is shown in Fig. 5.1(a). By using
spherical coordinates  = (x) and  = (x), the magnetization unit vector m is
expressed as m = (cos , sin  cos , sin  sin ), and the total micromagnetic energy
[Eq. (5.1)] reads
E = S
A(2 + sin2 2) D sin2  + K sin2 (1 +  sin2 )
dx, (5.3)
where  = K/K and  represents the derivative with respect to x. In equilibrium state,
the energy (5.3) must beminimal, i.e., the Lagrangian density L = H satisfies the Euler-
Lagrange equation,
 f 
= 0, (5.4)
60 Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction
where f = ,  and H = A(2 + sin2 2)  D sin2  + K sin2 (1 +  sin2 ).
Therefore, we arrive at two coupled differential equations for  and ,
2A = sin 2(A2 + K(1 +  sin2 ) D),
sin (2A  K sin 2) = 2 cos (D 2A).
(5.5)
The corresponding boundary conditions are  = 0 and (  1/) sin2  = 0 for
x =  where  = 2A/D is the characteristic length [62]. These boundary conditions
are given by
 f 
= 0 at the boundary. (5.6)
We now search for the head-to-head DW solution, therefore the ansatz cos  =
 tanh[(x x0)/] is used, where  is the DWwidth and x0 is the DW center. Initially,
we consider the case of  = 0 (i.e. K = 0) which preserves the rotational symmetry.
We assume that  is a linear function of space x, i.e., (x) = (x  x0)/ +  where 
is the DW tilt angle. Inserting it back to Eq. (5.5) we obtain  =
A/(K A/2). In
the absence of DMI, the DW width reduces to 0 =
A/K which is the well known
Bloch wall width. Therefore the static one-dimensional head-to-head DW profile can
be expressed as [46]
mx = tanh(x/),
my = sech(x/) cos(x/ + ),
mz = sech(x/) sin(x/ + ),
(5.7)
where we have chosen x0 = 0. Fig. 5.1(b) shows the DW profile using Eq. (5.7) for
K = 0 with lines, and the red dashed line depicts the micromagnetic simulation result
of mz for K2 = 6 105 J/m3. The rotational symmetry breaks for K > 0 and the z-
component of the magnetization mz is suppressed by the easy plane anisotropy. The
DW configuration (5.7) is not stable if the DMI constant is larger than the critical value
Dc = 2
AK [46], and the presence of K > 0 increases this threshold.
We assume that the spin wave can be described by a small fluctuation u = u(x) and
v = v(x) around m0, where m0 = (cos 0, sin 0 cos 0, sin 0 sin 0) is the static domain-
wall profile Eq.(5.7),
m = m0 + [u(x)e + v(x)e]e
iwt, (5.8)
where
u2 + v2  1 and  is the spin-wave frequency. The unit vectors e and e are
defined as e = (0, sin 0, cos 0) and e = ( sin 0, cos 0 cos 0, cos 0 sin 0). By
following the treatment in Ref. [127], we obtain for the K = 0 case,
Av  Kv cos(20) = iu/0,
Au  Ku cos(20) = iv/0,
(5.9)
Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction 61
where we define K = K  D2/4A and 0 = 2/(0Ms). By introducing the complex
variable  = u  iv, Eq. (5.9) can be written as a time-independent Schrdinger-type
equation with reflectionless potential [135, 136],
H() = (1 + q2)(), (5.10)
where  = x/ and the operator is H = d2/d2 + 1 2 sech2(). The eigenvalues
1 + q2 = /(0K) define the spin-wave dispersion relation inside the DW, which is
plotted in Fig. 5.1(c) (magenta line) with wavevector k = q/. The above discussion
is only valid for wavelengths smaller than the domain-wall size, which corresponds
to wavevectors greater than km  1/(2). The propagating wave excitations can be
expressed as (, t) = kei(tanh() iq) where  = q  t represents the sine or
cosine type waves and k the wavevector-dependent spin-wave amplitude [137]. The
reflectionless property for spin waves holds even in the presence of the easy plane
anisotropy [138]. Interestingly, the dispersion relation inside the DW is symmetric
in the reduced wavevector q even though the wall is twisted by the DMI. However,
due to the exponential decay of the DW profile when moving away from the DW
center, themagnetization is uniform in the domains and the dispersion relations become
asymmetric outside the DW [133, 139],
 = 0(K + Ak
2  Dk). (5.11)
Fig. 5.1(c) shows the asymmetric dispersion relations outside the DW. The dispersion
relation [Eq. (5.11)] also suggests that the wave vector changes by D/A when the spin
wave passes through the DW if the frequency of the spin wave remains the same. The
spin wave becomes elliptical rather than circular if K > 0 and the corresponding
dispersion relation outside the DW becomes [133]
 = 0[
(K + Ak2)(K + K + Ak2) Dk]. (5.12)
5.4 Domain-wall motion
To study the DW dynamics, micromagnetic simulations have been performed using a
1D mesh with length 2000 nm and cell size 2 nm. The parameters used are typical of
Permalloy: the exchange constant A = 1.3 1011 J/m, the saturation magnetization
Ms = 8.0  105 A/m and the damping coefficient  = 0.01. The spin waves are
excited locally in the region 1000  x  998nm by a linearly polarized microwave
h(t) = h0 sin(t)ey with h0 = 1  105 A/m. The initial domain wall is located at
x0 = 50 nm, and to prevent spin wave reflection the damping coefficient is increased
linearly [115] from 0.01 to 0.5 in the region 800  x  1000nm.
62 Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction
0 1 2 3 4
Time (ns)
0 1 2 3 4
Time (ns)
(a) (b)
Figure 5.2: The domain-wall displacement for (a) K = 0 at frequency f = 32
GHz, and (b) K = 6 105 J/m3 at frequency f = 32 GHz. The DMI constants
employed in the simulation are D0 = 0 and D = 4 104J/m2.
The spin-wave traveling in the +x direction induces DW motion. Figure 5.2 shows the
domain-wall displacements with and without easy plane anisotropy for various DMI
constants. As shown in Fig. 5.2(a), it is found that both negative and positive DMI
constants lead to identical domain-wallmotionwhen K = 0. The domain-wall velocity
is obtained by fitting the displacement of the domain wall (mx as a function of time) and
thus is calculated by v = (L/2)(dmx/dt) where L is the length of the wire.
10 20 30 40 50 60 70
Frequency (GHz)
0 20 40 60 80
Frequency (GHz)
Figure 5.3: Simulation results of the DW velocity as a function of spin-wave
frequency with different DMI constants for the case of K = 0. The DMI
parameters are D0 = 0 and D = 4 104J/m2. Inset: Plot of spin-wave
amplitude decaying characteristic length  versus frequency.
Figure 5.3 shows the DW velocity as a function of frequency with different DMI
constants for K = 0. The DW velocity is negative, which is explained by conservation
of angular momentum, and the DW velocity is ve = (2/2)Vg [127], where Vg =
k/k is the group velocity and  is the spin-wave amplitude. For a circular spin wave,
Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction 63
i.e. for K = 0, by using the dispersion relation inside theDWor Eq. (5.11)we haveVg =
20 Ak = 2
0A( 0K). Themagnitude of the DWvelocity first increases, and then
decreases as the frequency of the spinwave increases. The reason for this is that the spin-
wave amplitude decays exponentially as the spin wave propagates. To quantify this, we
assume the magnetization has the form m = ex + 0ei(kxt)ex/ with |0|  1
[100, 133], and obtain  = (2/)[0Ak D(  D0k)/(K + 2K + 2Ak2)], which
is plotted in the inset of Fig. 5.3 with K = 0. The predicted DW velocity ve is plotted
in Fig. 5.3 as well, which fits the simulation results very well. From Fig. 5.3 we can see
that the DMI has only a small influence on the DW velocity, in this case where K = 0
and the spin waves are circular.
We now repeat the study for Fig. 5.3 above with K > 0 and where the spin waves are
elliptical. From Fig. 5.2(b) we can find that for the scenario of K = 6 105 J/m3, the
sign of DMI constant influences the domain-wall motion significantly. Fig. 5.4 shows
the DW velocity as a function of spin-wave frequency for K = 6 105 J/m3. As in the
K = 0 case, the DW velocity is negative if the DMI constant D is > 0, and is enhanced
by the DMI. The DW velocity is zero if the frequency is less than the cut-off frequency
fcut  16.3 GHz. The DWvelocity first increases, and then decreases with the frequency
due to the spin-wave amplitude decaying. However, for the D < 0 case the DW velocity
is positive in a large frequency range, which is different from the reports in previous
studies [36, 115, 129].
0 10 20 30 40 50 60 70
Frequency (GHz)
vd +ve
Figure 5.4: The DW velocity as the function of the spin-wave frequency with
K = 6 105 J/m3. The DMI constants employed in the simulation are D0 = 0
and D = 4 104J/m2.
To understand this novel DMI induced linear momentum transfer phenomenon, we
recall the dispersion relation [Eq. (5.11)] outside the DW and assume the wavevector of
a magnon before and after passing through the DW to be k1 and k2, respectively. When
64 Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction
spin waves travel though the DW, they jump from branch + to  in the dispersion
relation, as depicted in Fig. 5.1(c). By assuming the frequency keeps the same, the
change in wavevector k = k2  k1 can be calculated. The change in wavevector k
leads to a momentum change p = hk for each magnon.
The excited magnon density is n = 2Ms/(2h) [36] and for elliptical spin waves we
choose 2 = u0v0 where u0, v0 are fluctuation amplitudes in e and e. The linear
momentum of a DW is PDW = (Ms/)
 sin (/x)dx = 2Ms/ [140] and
conservation of linear momentum [130] gives dPDW/dt = dPmagnons/dt = nVgp,
i.e.,  = (1/4)2Vgk. To describe the domain-wall motion, we introduce an effective
field along the x direction by using the spherical form of the LLG equation,
Hx = / = 
2kVg/. (5.13)
For circular spin waves k = D/A, and thus the corresponding effective field is
computed as H0x = (2/2)Dk0/. In the  > 0 case (i.e. for K > 0), the spin wave
is elliptical and k is a function of the frequency, as shown in Fig. 5.5(a). The presence
of a non-zero K suppresses the wavevector change, especially for low frequency spin
waves. The DWvelocity vd induced by this effective field Hx in the presence of damping
can be obtained using the rigid DWmodel [111],
1 h2
, (5.14)
where h = Hx/(HK) and HK = 2K/(0Ms). The total velocity is the sum of
the established vd and ve, which correspond to the linear and angular momentum
conservation, respectively.
To estimate the total velocity ve + vd, we have extracted the spin wave amplitude  at
x = 0 (the initial position of the domain wall) from the simulation and the constant
DW width 0 is used. This total velocity is shown as lines in Fig. 5.4 and shows
a good agreement with the simulation results shown as circle and triangle symbols.
The DW can rotate freely if K = 0 and the DW velocity induced by the field Hx is
v0 = 0Hx/(1+ 2). We can establish that v0  104 m/s, which could explain why
the linear momentum exchange is not significant for the DWmotion shown in Fig. 5.3.
So far the effective field is introduced by linear momentum conservation. In the
following section we cross-check this using the LLG equation. The LLG equation (5.2)
with zero damping is rewritten to describe the spin conservation law [57],
= a + d (5.15)
where je = 0Am m is the exchange spin current associated with localized spin.
The spin source or sink a = 0m  [Kmxex  Kmzez] and d = 0Dm  ( 
Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction 65
m) come from the anisotropy and DMI, respectively. The average DW velocity can
be computed as the overall magnetization, v = (1/2)
mx/tdx where  f (t)
represents the temporal average for the function f (t). Formagnonswe keep this average
to the square of the amplitude of the spin waves and ignore the higher-order ones. By
integrating over space for the x-component of the spin current je, the velocity ve can be
recovered.
20 30 40 50 60 70
Frequency (GHz)
1.0 0.5 0.0 0.5 1.0
D (mJ/m2 )
Figure 5.5: (a) Plot of k as a function of the frequency for K0 = 0, K
3 105 J/m3 and K2 = 6 105 J/m3 with D = 4 104 J/m2. (b) The contour
plot of the simulated DW velocity for different K and DMI constants, the
frequency of the external ac field is fixed at 30GHzwith the amplitude 500A/m,
and the damping  is 0.01.
By using the DW profile (5.7) it is found that the overall contributions of the x-
component torques a and d are zero, i.e.,
 xa dx =
dx = 0. How-
ever, the contribution of the z-component of the DMI is nonzero, i.e.,
(2/2)0Dk mydx, represents an additional torque rotating the DW plane. By in-
troducing an effective field H0x in the x direction such that the total torque on the DW
equals the torque  zd , we obtain H
 zd /
mydx = (2/2)Dk0/, which
is in exact agreement with the analysis above.
Fig. 5.5(b) shows a contour plot of the DW velocity as a function of K and DMI
constant D. The figure is approximately symmetric in the DMI constant, with a biased
velocity originating from the angular momentum exchange between the spin wave and
the DW. The DW velocity is always negative if D > 0. There exist some optimal areas in
which the DW has the highest velocity, and this area depends on the frequency of the
spin wave.
5.5 Two types of domain walls
In Section 5.3 we discussed the domain-wall profile for the K = 0 case. By as-
suming the constant DW width  and the linear dependence of  we obtain  =
66 Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction
0 2 4 6 8 10
=K /K
sin2 
100 0 100
x (nm)
(a) (b)
Figure 5.6: (a) Plot of two types of domain walls, c is obtained by fitting the
simulation data with cos  =  tanh(x/c). (b) Two types of domain walls
obtained from simulation data of type I with K = 8 105 J/m3 and type II
with K = 8 104 J/m3. The used parameters are FeGe [2].
A/(K A/2)where  = 2A/D is the characteristic length. However, these assump-
tions are not true for K > 0 case. To estimate the DW width in general case we start
with Eq. (5.5). Assuming that the DW profile can be described by,
cos  =  tanh f (x), sin  = sech f (x), (5.16)
where f (x) is an unknown function of space and thus the DWwidth is related to f (x),
we expect f (x) is a monotonic non-decreasing function. From Eq. (5.7) we know that
 = sin  f (x) and  = sin [cos  f (x)2 + f (x)], and by considering the first equation
of Eq. (5.5) we assume f (x) = g(x) cos  since f (x) = 0 leads to a constant DWwidth.
Therefore, we arrive at,
A( f 2 + g) = A2 + K + K sin
2  D (5.17)
Note that for the K = 0 case f 2 + 2 = K/A and by combining it with the second
equation of Eq. (5.5), we assume
A( f 2 + 2) = K + K sin
2 , (5.18)
which leads to Ag = (2A  D) and further more,
A f  = (2A  D) tanh f . (5.19)
We can check that Eq. (5.18) and Eq. (5.19) are the solutions of Eq. (5.5). The asymptotic
behavior of f  can be obtained from Eq. (5.19) by making use of the fact that tanh f  1
in the limit of x  +. We can distinguish two types of domain walls according to the
value of f  = limx+ f (x).
The first case is that f  = 0, which requires  = D/(2A) or  = 0. Note that
Chapter 5 Magnon-driven domain-wall motion with Dzyaloshinskii-Moriya interaction 67
 = D/(2A) corresponds to the DW profile obtained in the main content, which
is only valid for K = 0 case. Therefore, we identify the first type of the DW with
 = 0. As an approximation, we assume  = a tanh(x) for this type of wall, so we
have f 0 =
K/A a22 and f  =
(K + K sin
2 a)/A. As we can see, the DW width
is bounded by f 0 and f
. By using  
K/A we find that a 0 in the limit of   
and thus 
The second case is that f  does not converge and (x) is a monotonic function. From
Eq. (5.18) one can deduce that at least one of f  and  oscillates, and combining
Eq. (5.19) we conclude that both of them oscillate. In this scenario, we take the following
approximation forms for f  1,
 =   c cos(2 0),
f  =  + c sin(2 0),
(5.20)
where  = 1/ = D/(2A). We can find that this assumption satisfies Eq. (5.19).
Substitute Eq. (5.20) into Eq. (5.18) and to eliminate the term sin 2 one obtains sin 0 =
2 + 2 and cos 0 = /
2 + 2. Finally, we arrive at,
1 + /2 +
1 + 
 2, (5.21)
and thus the domain-wall width  = 1/ can be established. The oscillation
amplitude is given by c = K/(4A
2 + 2). This solution is only valid for weak
easy plane anisotropy case that requires c < . And thus the critical c can be
obtained by solving the equation Kc = 2D
2 + 2, i.e., AK2c = 2D2(1 + c/2 +
1 + c). Figure 5.6(a) shows the DW width of the two types of domain walls, and the
corresponding  is shown in Fig. 5.6(a) using the data extracted from simulation.
5.6 Summary
In this chapter, we have studied the DWmotion induced by spin waves in the presence
of DMI. We found that the DMI exerts an extra torque which rotates the DW plane
when the spin wave passes through the DW. This torque represents a linear momentum
exchange between the spin wave and the DW. The effect of the linear momentum is
equivalent to an effective field and the direction of the field depends on the sign of DMI
constant andDWprofile. This linearmomentum exchange between spinwaves andDW
exists in addition to the angular momentum exchange, and is more efficient in moving
the DW.
Chapter 6
Driving magnetic skyrmions with
microwave fields
Preface
The work presented in this chapter has been published in [3].
6.1 Introduction
Magnetic skyrmions are topologically stable magnetization textures with particle-like
properties. As proposed by Skyrme [141], the skyrmions are considered to be topologi-
cally protected, in the sense they can not be changed by a continuous deformation of the
field configuration. Magnetic skyrmions have been found experimentally [63, 142145]
in various materials, such as MnSi, FeGe as well as the ultrathin transition metal films.
Magnetic skyrmions have recently attracted great attention [47, 61, 63, 146] due to the
novel transport properties and the potential use in future spintronic devices [144].
The manipulation of skyrmions is of great importance and interest: skyrmions can
be driven using spin-polarized current [48, 49, 132, 147], magnetic or electric field
gradients [32, 50], temperature gradients [33, 148, 149] and magnons [51, 81, 150].
Microwaves, on the other hand, have been broadly used in studying various magnetic
phenomena, such as the ferromagnetic resonance (FMR) and spin wave excitations in
skyrmion crystals [151154]. However, the possibility of creating translational motion
of skyrmions has not been explored in these experiments [152154].
In this Chapter, by using a classical spin model on a two-dimensional system with
Dzyaloshinskii-Moriya Interaction (DMI), we show that both a single skyrmion and a
70 Chapter 6 Driving magnetic skyrmions with microwave fields
skyrmion lattice can be moved by microwave fields if the axial symmetry of skyrmions
is slightly broken by a static in-plane external field.
6.2 The system and asymmetric skyrmions
We employ skyrmions stabilized by the Dzyaloshinskii-Moriya Interaction (DMI) [43,
44]. More precisely, the bulk DMI is considered so that a chiral skyrmion (vortex-like)
rather than a hedgehog (radial) skyrmion configuration emerges [63, 155, 156]. We start
with a classical Heisenberg model on a two-dimensional regular square lattice with
nearest-neighbor symmetric exchange interaction, the bulk-type DMI, and the Zeeman
field [33, 151, 157]. In addition, a time-dependent magnetic field h(t) is applied in the
+z-direction. Accordingly, the systems Hamiltonian can be written as
H = J 
i,j
mi mj + 
i,j
Dij  [mi mj]
|i|(H + h(t)) mi, (6.1)
where i, j represents a unique pair of lattice sites i and j, mi is the unit vector of
the magnetic moment i = hSi with Si being the atomic spin and (> 0) the
gyromagnetic ratio, and J is the symmetric exchange energy constant. In the case of
bulk DMI, the DMI vector Dij can be written as Dij = Drij, where D is the DMI constant
and rij is the unit vector between Si and Sj. We use the DMI value with D/J = 0.18,
which results in the spiral period   2 Ja/D  25nm for a typical lattice constant
a = 0.5 nm [49]. We consider two nonzero components for the static external field H:
an in-plane component Hy and a perpendicular component Hz, i.e., H = (0, Hy, Hz). A
nonzero Hz is essential for stabilizing the skyrmion crystal [151].
The spin dynamics at lattice site i is governed by the Landau-Lifshitz-Gilbert (LLG)
equation,
= mi Heff + mi 
(6.2)
where  is the Gilbert damping and Heff is the effective field that is computed as Heff =
(1/|i|)H/mi. The Hamiltonian (6.1) associated with the LLG equation (6.2)
can be understood as a finite-difference-based micromagnetic model. Therefore, our
simulation results are reproducible by setting the saturation magnetization Ms =
hS/a3, exchange constant A = J/2a and DMI constant for continuum form Da =
D/a2 [corresponding to the energy density dmi = Dam  (m)] in micromagnetic
simulation packages such as OOMMF [24]. We have carried out simulations with and
without dipolar interactions, and the results are qualitatively the same. We report
results without dipolar interactions for clarity of the model assumptions.
A two-dimensional system of size N = 160  160 sites with periodic boundary
conditions is selected to study the dynamics of a single skyrmion, Fig. 6.1(a), and
Chapter 6 Driving magnetic skyrmions with microwave fields 71
(b) (c)
-0.0021
-0.0015
-0.0009
-0.0003
0.0003
Figure 6.1: (a) Skyrmion configuration in the presence of an in-plane field
Hy = 0.006 with D = 0.18, J = 1 and Hz = 0.02. (b) The symmetric topological
charge density distribution of a skyrmion when Hy = 0. (c) The corresponding
topological charge density for the skyrmion shown in (a) when Hy > 0. (d) The
skyrmion lattice with 12 skyrmions in a sample of size N = 174 150 sites,
with an in-plane field Hy = 0.004.
N = 174 150 sites for the skyrmion lattice, as shown in Fig. 6.1(d). We have chosen
J = h =  = S = a = 1 as simulation parameters [151, 158], therefore, the coefficients
to convert the external field H, time t, frequency  and velocity v to SI units are
H = J/hS, t = hS/J,  = J/hS and v = Ja/hS, respectively. Table 6.1 shows the
expressions, and particular values for the case of J = 1 meV, S = 1 and a = 0.5 nm. We
use simulation units throughout the paper. The perpendicular component Hz is fixed
as Hz = 0.02 which corresponds to 0.173 T for S = 1 and J = 1 meV. We use Gilbert
damping  = 0.02 for all simulations except for the magnetic spectra shown in Fig. 6.2
where  = 0.04 is chosen. For the single skyrmion dynamics, we apply the absorbing
boundary conditions for damping [2] by setting  = 1.0 for the 20 spins at the edges of
a simulated domain.
The configuration of a skyrmion in the presence of an in-plane field Hy = 0.006
is shown in Fig. 6.1(a). It is found that the radial symmetry is broken. Indeed, as
shown in Fig 6.1(c), the corresponding distribution of the topological charge density
q(x, y) = (1/4)m  (xm ym) is asymmetric. However, the total topological charge
of a single skyrmion remains constant Q =
qdxdy = 1. As a comparison, Fig. 6.1(b)
shows the topological charge density q for a skyrmion with radial symmetry when
Hy = 0. Similar to the vortex [159], the distortion of the skyrmion is along the x-axis
when an external field is applied in the y-direction.
72 Chapter 6 Driving magnetic skyrmions with microwave fields
Table 6.1: Unit conversion table for J = 1 meV, S = 1 and a = 0.5 nm.
Distance x x = a = 0.5 nm
Time t t = hS/J  0.66 ps
Velocity v v = Ja/(hS)  7.59 102 m/s
Frequency   = J/(hS)  1.52 103 GHz
Magnetic field H H = J/(hS)  8.63 T
0.00 0.02 0.04 0.06
Frequency w
Hy =0.000
Hy =0.002
Hy =0.004
Hy =0.006
0.00 0.02 0.04 0.06
Frequency w
Hy =0.000
Hy =0.002
Hy =0.004
Hy =0.006
Figure 6.2: Imaginary parts of the Hy-dependent dynamical susceptibility zz
as a function of frequency for (a) a single skyrmion, and (b) a skyrmion lattice.
The spectra are obtained by applying a sinc-field pulse h = h0sinc(0t) to the
system with h0 = 1  105 and 0 = 0.1 in the z-axis, the magnetization
dynamics is recorded every dt = 5 for 8000 steps.
6.3 Spin waves modes
The excitation of internal modes depends on the static external field Hz as well as the
frequency and direction of microwaves [77, 151]. The typical excited modes are the
clockwise/counterclockwise rotation and breathing modes [151153]. To study how
the in-plane applied field Hy affects the excitation mode of a skyrmion, we calculate
the magnetic absorption spectrum of the skyrmion. After applying a sinc-function field
pulse h = h0sinc(0t) = h0 sin(0t)/(0t) to the stable skyrmion state we record the
spatially averaged magnetization evolution and from that we compute the dynamic
susceptibility  via a Fourier transformation [160, 161]. For instance, the component
zz is computed using mz when the pulse is parallel to the z-axis.
Figure 6.2 shows the imaginary part of the dynamical susceptibility zz for a single
skyrmion (a) and a skyrmion lattice (b); each calculated for different in-plane fields
Hy. We see in (b) for the skyrmion lattice and Hy = 0 that the mode with frequency
  0.0246 is dominant. This is the so-called breathing mode [151, 152]. The resonance
angular frequency   0.0246 in simulation units corresponds to the frequency f =
/2  5.95 GHz (using  from Table 6.1). The breathing mode frequency decreases
Chapter 6 Driving magnetic skyrmions with microwave fields 73
slightly as the in-plane field Hy increases. A second peak emerges with increasing Hy,
and the frequency of the new mode is   0.0278 when Hy = 0.006. Similar to the
skyrmion lattice, a breathing mode with   0.0168 is found for a single skyrmion,
as shown in Fig. 6.2(a). In general, the resonance frequency of a single skyrmion is
lower than that for the skyrmion lattice. As for the skyrmion lattice, a new mode with
frequency around 0.02 emerges for the single skyrmion case as Hy is increased. This
second mode is the uniformmode with frequency  = H where H ' (H2y + H2z )1/2 is
the amplitude of the external field.
6.4 Skyrmion motion
0 2 4 6
Time t 104
0.01 0.02 0.03 0.04
Frequency w0
0.0 0.5 1.0 1.5 2.0
h0  10000
0 2 4 6
Hy  1000
Figure 6.3: (a) The displacements of the guiding center (X, Y) for a single
skyrmion. The simulation parameters are 0 = 0.017, h0 = 2 104 and the
in-plane field Hy = 0.004. (b-d) The velocities vx and vy as functions of (b) the
microwave frequency 0, (c) the microwave amplitude h0, and (d) the in-plane
field Hy. The fixed simulation parameters are the same as in (a).
In the presence of an in-plane applied field Hy, the skyrmion is deformed, as shown
in Figs. 6.1(a) and 6.1(c). Therefore, instead of the geometric center we measure the
so-called guiding center [162] R = (X, Y) of a skyrmion: X =
xqdxdy/
qdxdy and
yqdxdy/
qdxdy, where q is the topological charge density. For a symmetric
skyrmion, the guiding center is the same as its geometric center. In the rest of this
work, we consider the scenario that a linearly polarized microwave is applied in the z-
direction, i.e., h(t) = h0 sin(0t)ez, where h0 and 0 are the amplitude and frequency
of the microwave, respectively.
Figure 6.3(a) shows the displacement of the guiding center for a single skyrmion with
0 = 0.017 and in-plane field Hy = 0.004. The microwave amplitude is h0 = 2 104,
74 Chapter 6 Driving magnetic skyrmions with microwave fields
which corresponds to 1.73 mT for J = 1 meV and S = 1. It can be seen that the x-
component of the guiding center, X, changes significantly as a function of time, while
the displacement of Y is relatively small. Figure 6.3(b) plots the frequency-dependent
skyrmion velocity and shows that a single skyrmion has maximum velocity when
0 = 0.017, which is the breathing mode resonance frequency. Therefore, exciting the
breathing mode can move the skyrmion effectively in the presence of an in-plane field
Hy. Using the conversions presented in Table I, the maximum velocity is vx  2.8 cm/s.
While vx is positive for frequency 0 = 0.017, it is negative for 0 = 0.023, where
the former corresponds to the breathing mode, and the latter to coherent rotation.
The relation between the velocities and the amplitude of the microwave is shown in
Fig. 6.3(c), and the dependence of vx on h0 is nonlinear: vx  h20 which is proportional
to the power of the microwaves.
Figure 6.3(d) describes the relation between the skyrmion velocity and the in-plane
field Hy. The velocity is zero if Hy = 0, which is expected due to the symmetry
of the skyrmion. The velocity of the skyrmion also depends on the direction of the
in-plane field Hy: the velocity is reversed when the direction of the in-plane field is
reversed. Similarly, a change in the sign of the DMI constant will also reverse the sign
of the velocity, which is different from the case of driving skyrmionswith spin-polarized
currents, where the sign of perpendicular velocity (with respect to the current direction)
of the skyrmion motion is related to the sign of topological charge rather than the DMI
constant sign.
(a) (b)
Figure 6.4: The total spatial force density fi = ms  [ims  mHeff] for (a)
Hy = 0, and (b) Hy = 4 103, where we have used ms = m. The microwave
frequency is 0 = 0.017.
To understand why the skyrmion moves in the presence of an in-plane field, we split
the magnetization unit vector m into a slow part ms and a fast part n, i.e., m = ms + n,
where the slow part represents the equilibrium profile of the skyrmion while the
fast part is responsible for the excited spin wave mode [33, 163]. In the continuum
approximation, the effective field is Heff = A2m  D  m + H + h(t), where
Chapter 6 Driving magnetic skyrmions with microwave fields 75
A = 2A/Ms and D = 2Da/Ms. In the presence of the microwaves with specific
frequency, bound spin-wavemodes are excited, and thuswe expect n = 0 and n = 0
due to the microwave synchronization, where T = 2/0 is the period of microwaves
and the notation  f  =  f (t)  T1 
 t+T
t f (t
)dt represents the time average of
function f (t) over a single period T. Furthermore, one obtains ms  n  0 and
n  ms  0 since ms is the slow part. Therefore, by averaging the LLG equation
(6.2) over a period T we arrive at
ms = mHeff+ ms  ms, (6.3)
where n  n = 0 is used since basically n is a sine or cosine function in time. We
then consider the possible translational motion of the skyrmion such that ms(r, t) =
ms(r  vst), i.e., ms = (vs  )ms, where the skyrmion velocity vs = dR/dt is
assumed to be a constant. If the skyrmion moves slowly, i.e., vsT  L (L is the typical
skyrmion size), we have ms  (vs  )ms (see Appendix A.3) where ms = ms.
Similarly, ms  ms  ms  ms, and thus Eq. (6.3) can be rewritten as
(vs  )ms = mHeff+ ms  (vs  )ms. (6.4)
Following Thieles approach in describing the motion of magnetic textures [164], we
replace the dots in
ms  (ims     )dxdy by Eq. (6.4) to obtain [32, 33, 163]
G vs + Dvs = F, (6.5)
where i = x, y and G = 4Qez. The tensor Dij = ij is the damping tensor in which
ij =
(ims  jms)dxdy = ij is the shape factor of the skyrmion and  is close to
4 [163]. The force F is given by
Fi = 
ms 
ims  mHeff
dxdy. (6.6)
Figure 6.4(a) and (b) depict the total spatial force density for Hy = 0 and Hy = 4 103,
respectively, where we have used ms = m. The force density is symmetric if Hy = 0
and thus the total force F is zero. However, when Hy is nonzero the force distribution is
asymmetric which results in the skyrmion motion due to the nonzero net force. For
small damping   1, we have vx  Fy/(4Q). The total force calculated with
parameters 0 = 0.017, Hy = 0.004 and h0 = 2 104 is Fy = 4.7 104, therefore,
the established velocity is vx = 3.7 105, which fits the simulation result ( 3.8 105)
well. Similarly, for  = 0.023 using Eq. (6.6) we obtain Fy = 5.7  105 and find
vx  4.5 106 fromEq. (6.5); in agreementwith the simulation results (theminimum
of vx is 4.7 106).
76 Chapter 6 Driving magnetic skyrmions with microwave fields
-5e-7 0 5e-7
-3e-3 0 3e-3
Figure 6.5: (a) The spatial force density fi = ms  [ims  m  h] induced
by the microwave field h for a symmetric skyrmion. (b) The force density
fi = ms  [ims  m A2m] due the exchange interaction. The microwave
frequency is 0 = 0.017.
It is of interest to circumstantiate the contributions of the total force F. In Appendix A.4
we show that there are three nontrivial terms
mHeff  n [A2n D n + h(t)]. (6.7)
The exchange term n A2n corresponds to magnon currents [33, 163]. Compared to
the skyrmion motion induced by the temperature gradient, where the magnon current
is generated by the temperature gradient, here the magnon current originates from the
external microwave fields. Another difference is that in our case the contributions from
DMI and microwave fields are also significant.
Figure 6.5 (a) and (b) show the spatial force densities of a symmetric skyrmion induced
by themicrowave field h and the exchange interaction, respectively. It can be found that
the force density, due to the exchange interaction, is much higher than the one induced
by the microwave field. Moreover, the force density due to the exchange interaction is
localized at the skyrmion core, whereas it is relatively uniform for the microwave field
case. However, both of them play significant roles in driving the skyrmion.
We repeat the velocity study for the skyrmion lattice. Fig. 6.6(a) plots the velocities vx
and vy of the skyrmion lattice as functions of the in-plane external field Hy. The de-
pendencies are similar to the single skyrmion case. The frequency-dependent velocities
vx and vy are shown in Fig. 6.6(b). As for the single skyrmion case, the velocity peak
coincides with the dominant dynamical susceptibility peak in Fig. 6.2(b).
In closing, we briefly comment on the importance of symmetry breaking in driving the
skyrmions. The driving force originates from the microwave field, which is periodic
in time and averages to zero. The symmetry-breaking field converts the periodic
Chapter 6 Driving magnetic skyrmions with microwave fields 77
0 2 4 6
Hy  1000
(a) vx
0.01 0.02 0.03 0.04
Frequency w0
Figure 6.6: (a) The velocities vx and vy as a function of an in-plane field Hy for
the skyrmion lattice at frequency 0 = 0.023. (b) The velocities as a function of
frequency 0 with Hy = 4 103. The microwave amplitude is h0 = 2 104.
microwave field into a net force and thus moves skyrmions effectively. A related field
with periodic driving forces is that of ratchet-like transport phenomena [165167],
where the net motion is obtained by breaking the spatial symmetry [165] or temporal
symmetry [167]. We also note that preliminary simulation results suggest that for
magnon-driven skyrmions [51, 81] the introduction of a symmetry-breaking in-plane
field affects the skyrmion motion and changes the Hall angle significantly.
6.5 Summary
In summary, we have studied the skyrmion dynamics driven by microwaves in the
presence of an in-plane external field. We found that both a single skyrmion and
a skyrmion lattice can be moved by a linearly polarized microwave field if the axial
symmetry of skyrmions is slightly broken. The net velocity of the skyrmion depends
on the frequency and amplitude of the microwave fields as well as the strength of the
in-plane field. The maximum velocity is found where the frequency of the microwave
coincides with the resonance frequency of the breathing mode of the skyrmions. These
results suggest a novel method for skyrmion manipulation using microwaves fields.
Chapter 7
Conclusion and Outlook
7.1 Conclusion
A phenomenological equation called the Landau-Lifshitz-Baryakhtar (LLBar) equation
was derived by Baryakhtar. The LLBar equation could be viewed as the combination
of Landau-Lifshitz (LL) equation and an extra exchange damping" term. We explain
the exchange damping" in the LLBar equation as a nonlocal damping by linking it to
the spin current pumping. Using the micromagnetic simulation based on the LLBar
equation, we show that the difference betweenmagnetization length M and Me reaches
its maximum at the domain-wall center. For the cases    where  is the longitudinal
magnetic susceptibility and  is the Gilbert damping, the Walker breakdown field
increases significantly. By using a 1D domain-wall model, we show that both the
domain-wall mobility and the Walker breakdown field are strongly influenced by the
nonlocal damping as well.
Magnon-driven domain-wall (DW) motion was firstly investigated using micromag-
netic simulations [115], and theDWmotiondirection is found to be the same as the prop-
agation direction of spin waves. Later, the magnonic spin-transfer torque that drives
a DW to the opposite direction of spin-wave propagation was studied [127]. We have
studied theDWmotion induced by spinwaves in the presence ofDzyaloshinskii-Moriya
Interaction (DMI). We found that the DMI exerts an extra torque which rotates the DW
plane when the spin wave passes through the DW. This torque represents a linear mo-
mentum exchange between the spinwave and the DW. This linearmomentum exchange
between spinwaves andDWexists in addition to the angularmomentum exchange, and
is more efficient in moving the DW.
Magnetic skyrmions can be moved by spin-polarized currents [48, 49, 132, 147], mag-
netic or electric field gradients [32, 50], magnons [51, 81, 150], and temperature gradi-
ents [33, 148, 149]. We have studied the skyrmion dynamics driven by microwaves in
80 Chapter 7 Conclusion and Outlook
the presence of an in-plane external field. We found that both a single skyrmion and
a skyrmion lattice can be moved by a linearly polarized microwave field if the axial
symmetry of skyrmions is broken. The net velocity of the skyrmion depends on the
frequency and amplitude of the microwave field as well as the in-plane field strength.
The maximum velocity is found where the frequency of the microwave coincides with
the resonance frequency of the breathing mode of the skyrmions.
7.2 Outlook
We have started to use discontinuous Galerkin (DG) methods in micromagnetics. Typi-
cal energies such as themagnetocrystalline anisotropy and Zeeman field are straightfor-
ward to be implemented. We will develop new method based on DG space to compute
the demagnetizing field. In addition, the current development on the magnonic crys-
tals aremainly one- or two-dimensional, which suggests us to develop two-dimensional
finite element tools based on the triangular prisms.
Both the LLBar and the simplified LLBar (sLLBar) equations are supported in Fidimag.
Simulations based on Fidimag with extended nonlocal damping could be performed
to study the related phenomena such as the FMR linewidth and dynamic magnetic
susceptibility. We will try to do simulations about nonlocal damping to compare them
with the recent experimental reports [41].
It is very interesting that both the magnetic domain wall and magnetic skyrmion
move to the hotter side from the cooler side rather than the inversed direction. This
phenomenon actually is consistent with the spin-transfer effect of magnons [31, 127].
More precisely, the temperature gradient yields a magnon flow from the hotter to the
cooler side, when the magnons pass through the domain wall, the magnons transfer
spin angular momentums to it and thus the domain wall moves to the hotter area.
On the other hand, positive velocities of domain-wall motion have been found in
micromagnetic simulations [115]. The positive velocities are explained by the spin-wave
reflection which could happen when the domain-wall width is very thin [138] or in the
presence of dipolar interactions [36]. Moreover, we have found that the domain-wall
velocity also could be positive even without the spin-wave reflection in the presence of
DMI.Wewill studywhether a domainwall couldmove to the cooler area using Fidimag.
The relation between the Gilbert damping  and the stochastic field in the stochastic
Landau-Lifshitz-Gilbert (SLLG) equation is determined by Eq. (2.33), which can be
derived by comparing the SLLG equation and the Fokker-Planck equation in thermal
equilibrium [65]. However, a more general case is the nonequilibrium problem, such as
the ultrafast demagnetization [168]. A key ingredient to treat the system in the far-from-
equilibrium regime is the fluctuation theorem (FT) [169, 170]. Wewill try to explore this
area related to the SLLG equation using the fluctuation theorem.
Appendix A
A.1 Section A
In this section, we will show how the spin current is related to the tensor form
[Eq. (4.15)]. We split the perpendicular spin current j,i into two components,
j,i = j
i + j
i , (A.1)
where we write e/ as , and
jai = (im tm), jbi = (m itm). (A.2)
The torque a generated by spin current jai is given by a = (ij
i ), i.e.,
a = m [im (tm im)], (A.3)
where we have used the identities m  itm = im  tm and m  iim = im  im.
Meanwhile, the corresponding torque b can be computed by b = (ijbi ), which gives
b = a  (im  im)m tm m2tm. (A.4)
Note that a = im[(tm im) m] can be changed into the tensor form,
a = m (D0  tm), (A.5)
where
D0 = (m im)(m im). (A.6)
Therefore, we obtain for a + b,
a + b = m (D  tm) m2tm, (A.7)
82 Appendix A
where D is a 3 3 tensor,
D = 2(m im)(m im)  (im  im). (A.8)
A.2 Section B
We introduce a new variable s to represent the second term in the (4.23), i.e., s =
m0ei(kxt), so we have
m = ex + s,
= i  s,
Heff = Hs(1 + s
x)ex  Dk2s,
(A.9)
where sx  (1/2)(s2x  s2). Considering the fact |s|  1 and neglect the high order
term s2, one obtains Heff = (Hs + Dk2)s and thus
Hbeff = c ex + d s, (A.10)
where
c = Hs(1 + s
x), d = Gk2(Dk2 + Hs) Dk2. (A.11)
Substituting the above equations into (4.17), we have
 sxsy
 = f
 0sz
+ (c d)
 (s
y + s
(1 + sx)sy
(1 + sx)sz
 , (A.12)
where f = Hs(1 + sx) + Dk2. Neglecting high order terms such as s2x and sxsy we
obtained, [
(Hs  d) i w0
w0 (Hs  d) i
. (A.13)
Therefore, Eq. (4.27) can be obtained by setting the determinant of the matrix in (A.13)
to zero.
A.3 Section C
In this section, we will present an argument for the result ms  (vs  )ms. Assume
that a well-behaved function f (x, t) = f (x  vt) describes the dynamics of a soliton
where v is a constant. As we can see, f satisfies f = v f . For given time T, if vT  L
where L is the typical size of the soliton (for example, L could be the domain wall width
Appendix A 83
for a magnetic domain wall), we can find that
 f (0) = 1
f dt =
[ f (x vT) f (x)]  v f (x vT/2), (A.14)
where we have used the Taylor series for f (x) and f (x vT):
f (x)  f (x vT/2) + f (x vT/2)vT/2 (A.15)
f (x vT)  f (x vT/2) f (x vT/2)vT/2. (A.16)
Similarly, we can see that f0   f (0)  f (x vT/2) and thus we have  f (0)  v f0.
This relation actually holds for arbitrary t
 f   v f . (A.17)
A.4 Section D
In this section we will show the three nontrivial terms of the total force. By using the
effective field explicitly and noticing that m = ms + n, the term mHeff can be split
into four parts
mHeff = T1 + T2 + T3 + T4, (A.18)
where T1 = n [A2n D n + h(t)] is shown in Eq. (6.7), T2 = ms  (A2ms 
Dms + H), T3 = n (A2ms  Dms + H) and T4 = ms  [A2n D
n + h(t)]. We expect T2 = 0 since ms represents the equilibrium state of the skyrmion.
For the slow skyrmion motion, replacing ms by ms and noticing that n = 0, we obtain
T3  n (A2ms D ms) = 0 and T4  msA2n Dn+h(t) = 0.
In this slow motion approximation, the fast part n can be computed as n  m m.
Appendix B
Using discontinuous Galerkin
Methods
B.1 Introduction
The exchange field in micromagnetics can be computed using
Hexch =
2m, (B.1)
where m is the magnetization unit vector field and A is the exchange stiffness. The
key operator in Eq. (B.1) is the Laplacian (Laplace operator). Consequently, for the
given unstructured mesh, we assume that the saturation magnetization Ms is constant
through all cells for both the continuous Galerkin (CG) and discontinuous Galerkin
(DG) methods. However, in the DG method, the problem is to how to compute the
Laplace operator in a DG space of zero order (DG0). The lowest space (zero order, DG0
space) will be used since the LLG equation will be integrated at the center of cells.
B.2 Laplace operator using CG method
Let us start from the divergence theorem
  Fdx =
F  n dS. (B.2)
Substituting F = vu into the divergence theorem one gets
v2u dx =
vu  n dS
u  v dx (B.3)
86 Appendix B Using discontinuous Galerkin Methods
where v is a test function, and at the boundary v = 0. Hence we have
v2u x = 
u  v dx. (B.4)
The function u can be represented by the basis functions, namely, u = i uii. Thus, we
obtain 
v2u dx = 
i  v dx. (B.5)
If we suppose that 2u is constant over the local elements and set v = j, we have
j dx = 
uiKij, (B.6)
where Kij =
i  j dx. Note that Kij = Kji, therefore the right hand side of the
Eq. (B.6) is the stiffness matrix K multiplying the coefficient of basis function U, and the
left hand side in fact is the so-called load vector L. In the matrix form we have
2u = L1KU. (B.7)
This is the so-called box method. This method scales with O(h2) for regular meshes
but could be worse than O(h) for unstructured meshes [27]. Before we start to use the
DG method, we show some brief background about the Brezzi-Douglas-Marini (BDM)
space.
B.3 Background
B.3.1 H(div) space
For an open domain   Rn, the Sobolev space Hm() is defined by [171]
Hm() = {v  L2() : D  L2()}, (B.8)
where L2() is the abbreviation of L2(, Rn) which denotes the space of square-
integrable vector fields on , D is the standard differential operator on smooth v for
multi-index . The space H(div, ) is defined by
H(div, ) = {v  (L2())d : div v  L2()}, (B.9)
where div v = ni=1 xi vi. The H(div) space is particularly suitable for the partial
differential equations in mixed formulations.
Appendix B Using discontinuous Galerkin Methods 87
B.3.2 BDM space
Let us first have a look at the BDM space on triangles, which is defined by
Vh(K) = (Pr(K))
2, (B.10)
where Vh(K) is the restriction of Vh to triangle K and Pr(K) is the space of polynomials
of degree at most r on K. The lowest order of BDM space in triangles is,
Vh(K) = {v : v = (a1 + a2x + a3y, a4 + a5x + a6y), ai  R}. (B.11)
So, its dimension is six. The degrees of freedom are the values of normal components
at two points on each edge, such as in Dolfin the two points are chosen as 1/3 and 2/3.
B.3.3 Piola mapping
Suppose K = F(K) is a smooth mapping and DF(x) is the Jacobian matrix which is
invertible, thus one has,
DF1(x) = (DF(x))1. (B.12)
A simple case is the affine mapping
F(x) = x0 + Ax, (B.13)
where DF(x) = A is a constant matrix. For a function v(x) defined on K, the
corresponding function v(x) on K can be obtained using the mapping F
v = F (v) = v  F1. (B.14)
In general F does not preserve continuity of normal trace, thats why we need the Piola
mapping. The contravariant Piola mapping F div is defined by
F div() = 1|detJ| J   F
1, (B.15)
where J denotes the Jacobian matrix DF(x). Under the affine transformation, we can
check that for any edge e the contravariant Piola mapping has
||e||v  n = ||e||v  n. (B.16)
Therefore, the F div mapping preserves the normal trace up to edge length. Further-
more, there are two appropriate ways to define the basis functions. Suppose v is a basis
function, one choice is using ||e||v  n = 1 and the other is v  n = 1. Recall that we are
going to assemble the matrix A and B [Eqs.(B.21) and (B.22)], both could be approached
88 Appendix B Using discontinuous Galerkin Methods
import dofin as df
BDM = df . FunctionSpace ( mesh , "BDM" , 1 )
DG = df . FunctionSpace ( mesh , "DG" , 0 )
sigma = df . TrialFunction ( BDM )
tau = df . TestFunction ( BDM )
u = df . TrialFunction ( DG )
v = df . TestFunction ( DG )
a0 = df . dot ( sigma , tau )  df . dx
A = df . assemble ( a0 )
a1 =  ( df . div ( tau )  u )  df . dx
K1 = df . assemble ( a1 )
a2 = ( df . div ( sigma )  v )  df . dx
K2 = df . assemble ( a2 )
Table B.1: Python codes to compute the matrices in BDM space.
by integration in a reference element,
   dx =
K    dx, (B.17)
  v dx =
  v dx, (B.18)
where
K = 1|detJ| J
T J. (B.19)
B.4 Using BDM space
The BDM space provides a vector space so that the global divergences are well defined.
As we have already seen, our task actually is to find an accurate flux,  = u, where
u is one component of magnetization m. By multiplying the test function  defined in
the BDM space  we arrive at the following variational formulation:
   dx =
  n dS
   u dx   . (B.20)
The boundary condition is the Neumann condition such that   n = 0, and we need to
apply the boundary condition in the function space which could be implemented using
the Dirichlet boundary condition. Assembling the system results in the matrix form
A  = K1m. (B.21)
With known A, K1 and m,  this could be approached by solving linear equations. How-
ever, the computation of exchange fields is needed in each time step of the dynamics.
Appendix B Using discontinuous Galerkin Methods 89
Therefore, it is better to inverse the matrix A and in general we will get a dense matix
A1. In this case, the matrix form of Laplace operator D can be written as
D = K2A
1K1, (B.22)
where K2 is the matrix form of the divergence operator for BDM space, and the
boundary condition could be achieved by modifying the product of A1 and K1.
Table B.1 shows piece of code to compute the matrices. If we write the matrix K2 as
B, the matrix K1 is the transpose of matrix B with a minus sign, so we have
D = BA1BT. (B.23)
In practice, D is not a sparse matrix but in theory D should contain many fairly small
entries so that we could abandon them. Although this is a possible way to sparse the
matrix D, the whole process is not perfect  need to inverse the matrix A and in general
A1 is dense. If we keep in mind that our ultimate aim is to compute the Laplace
operator which should be defined locally, we should be able to obtain a sparse inverse
matrix A1 using another methods.
B.5 MFMFE
We are looking for some methods that lead to a sparse A1. The multipoint flux mixed
finite elementmethod (MFMFE) [172] satisfy this condition and it is a superconvergence
(second-order convergence) method. The MFMFE is related to the multipoint flux
approximation (MPFA) method which has been developed as a finite volume method.
The basic idea of MFMFE is using a quadrature rule to assemble the matrix A, rather
than the inner product defined in BDM space. The quadrature rule is defined by,
(, )K = (K, )K =
K(ri)(ri)  (ri), (B.24)
where s = 3 for the unit triangle and s = 4 for the unit tetrahedron, (, ) represents
the inner product and (ri) is the corner vector associated with vertex located at ri.
The quadrature rule localizes the basis functions interaction and thus MFMFE could be
reduced to the cell-centered stencil.
B.6 A Test
To check the performance of the implemented method and and the so-called box
method (CG method), we compare them using an unstructured mesh. Figure B.1
90 Appendix B Using discontinuous Galerkin Methods
Figure B.1: The mesh used for comparison the exchange fields calculation for
DG and CG methods.
presents an unstructured mesh with dimensions 100 8 8 nm3. The magnetization
configuration is m0 = (0, sin(2x/L), cos(2x/L)) with L = 100 nm.
0 20 40 60 80 100
xs (nm)
Analytical
Figure B.2: The computed exchange fields using DG and CG methods. The
shown data is extracted in a line with y = z = 7 nm.
Figure B.2 shows the z-component of the computed exchange fields for DG and CG
methods. The used parameters are exchange constant A = 1.3  1011 J/m and the
saturation magnetization Ms = 8.6 105 A/m. For comparison, we have mapped the
data in DG space to CG space. As we can see, the DG method gives a better result.
Appendix C
Treecode for Boundary Element
Method
C.1 General problem
The dipolar interaction is a long range interaction. Amore general summation problem
involvingwith interactions between Ns source particles {yi} and Nt target particles {xj}
f (xj) =
i(xj  yi), (C.1)
where j = 0, . . . , Nt  1 and  is a smooth radially symmetric function such that
(xj  yi) =
|xj  yi|
. (C.2)
A direct approach requires O(N2) computation time which is unacceptable for large
system. A relatively easy and efficient method is the Treecode method, which scales
with O(N log(N)).
C.2 Treecode
The revolutionizing treecode method for the fast computation only requires
O(N log(N)) operations and it was first employed to speed up the n-body gravity
force calculation [173]. The crucial idea is to replace the particle-particle interactions by
particle-cluster interactions. To achieve this aim, a regular octree can be used to group
the nearby bodies hierarchically, then a divide-and-conquer strategy can be applied to
travel the tree from its root for every observation particle. Treecode method is easier
than the fast multipole method (FMM), and the whole process can be done recursively.
92 Appendix C Treecode for Boundary Element Method
yc xi
FigureC.1: The particle-cluster interaction between target particle xi and cluster
c = {yj}, where yc is the cluster center, R is the distance between cluster and
target particle, rc is the radius of the cluster.
C.2.0.1 Particle-cluster interactions
In this part, we provide necessary equations to implement the treecode algorithm [174],
where Cartesian multi-index notation is used to simplify the formalism:
k = (k1, k2, k3), ||k|| = k1 + k2 + k3,
k = k1k2k3, D
y = D
(C.3)
Suppose that the particles are already being divided into clusters, so the potential for
target particle xi induced by clusters is
Vi = 
Vi,c, (C.4)
where
Vi,c = 
qj(xi  yj) (C.5)
is the interaction between the target particle and cluster c = {yj} [174]. As shown in
Figure C.1, the target particle and the cluster are well separated with distance R, and rc
is themaximum radius of the cluster. Equation (C.5) is the direct sumof particle-particle
interactions without any speedup. However,  can be expanded in Taylor series with
respect to y around yc since target particle and cluster are well separated:
(xi, yj) = 
||k||=0
Dky (xi, yc)(yj  yc)k, (C.6)
where the notation (C.3) is used. The interval of convergence for Taylor series (Eq. (C.6))
is R > rc, which is a far-field expansion that corresponds to the far-field spherical
Appendix C Treecode for Boundary Element Method 93
multipole expansion in FMM [174]. Substituting Eq. (C.6) into Eq. (C.5), one obtains
Vi,c = 
||k||=0
Dky (xi, yc) 
qj(yj  yc)k
||k||=0
ak(xi, yc)m
(C.7)
where
ak(xi, yc) =
Dky (xi, yc) (C.8)
is the Taylor coefficient and
mkc = 
qj(yj  yc)k (C.9)
is the kth moment of the cluster and p is the truncation order.
C.2.0.2 Recurrence relations of Taylor coefficients
Recurrence relations are simple and efficient compared to the explicit formulas [174].
Let us start with
|x y| = 1, (C.10)
which is the definition of the magnetic potential. By applying Dy1 we arrive at
|x y|2Dy1  (x1  y1) = 0. (C.11)
Next, applying the operator Dk11y1 and using Leibnitzs rule for repeated differentiation
of the product, which yields [174]
|x y|2Dk1y1  (2k1  1)(x1  y1)D
y1  + (k1  1)
2Dk12y1  = 0 (C.12)
where identities Dy1 |x  y|2 = 2(y1  x1), D2y1 |x  y|
2 = 2 and Dky1 |x  y|
2 = 0 if
k > 2 are used. Then, applying the operator Dk2y2 D
y3 , dividing by k and substituting
the definition of ak,
|x y|2ak  2
akei +
ak2ei +
((x1  y1)akei  ak2ei) = 0, (C.13)
where ei are standard Cartesian basis. Another two similar equations can be obtained
by permuting indices, summing these equations leads to a symmetric one. In practice,
Eq. (C.13) is used to reduce calculation time slightly [174].
94 Appendix C Treecode for Boundary Element Method
Data: Source positions yj, target positions xi, source particles weights
Data: User input Taylor degree p,  and N0.
Build Tree;
foreach x in {xi} do:
compute_potential(x,root);
function compute_potential(x,root):
if  is satisfied then:
calculate the moment of tree if needed;
calculate particle-cluster interaction using Taylor expansion;
else:
if tree has children then:
foreach c in children do:
compute_potential(x,c);
else:
calculate particle-cluster interaction using direct summation;
Table C.1: The algorithm of treecode method.
C.2.0.3 Implementation of Treecode
A hierarchy tree must be built to trigger the Treecode method. The particles are stored
into an octree recursively, at each level the space are divided into eight subspaces (four
or two subspaces are used as well to avoid very narrow subspaces) until the number
of particles is smaller than a user-specified number N0. The root cell is the smallest
rectangular box that contains all particles. In practice, both the particle coordinates and
charges are stored in linear array, which are rearranged so that in each cell the particles
indices are stored to a chunk in an array.
There are two options to compute the particle-cluster interaction, i.e., through Taylor
expansion [Eq. (C.7)] or the direct summation using Eq. (C.5). The criterion used here
is the so-called multipole acceptance criterion (MAC): the Taylor approximation only
being employed if the following relation holds
6 , (C.14)
where  is a user-specified parameter to control the error. A smaller  gives a more
accurate result, at the same time, the speed will be low. A good value for  would be
0.5, however, we will use 0.3 for the following tests.
The pseudocode for treecode method is shown in Table C.1, the languages used
in our implementation are Python and C. Meshes, magnetization configuration and
Appendix C Treecode for Boundary Element Method 95
demagnetizing field calculation from magnetic potential parts are written in Python.
Treecode parts are implemented in C and are wrapped by Cython from which these C
functions can be called using Python directly.
C.2.1 Combine Treecode with FEM/BEM
In the hybrid finite element method/boundary element method (FEM/BEM), the
surface integral for U2 is computed analytically which leads to a dense matrix, to avoid
using dense matrix we need to come back to the original integral for U2:
U2(x) =
U1(y)y
|x y|  nydS +
U1(x). (C.15)
Noticing that the first term in Eq. (C.15) can be discretized into the general summation
[Eq. (C.1)] using numerical integral scheme:
U1(y)y
|x y|  nydS j
U1(yj)SjF(yj)  nyj = Vi,c (C.16)
where
F(y) = y
|x y| = y(x, y). (C.17)
However, this approximation is not accurate if the distance between target and source
particles is small, in this case we need to compute it analytically. Therefore, we define
a critical radius Rc = Rclc so that if R < Rc, the analytical equation will be used to
calculate the potential; lc is the characteristic length of the cells for the given mesh. This
extra step slows down the whole algorithm slightly because for some points we need
to compute it using Treecode method first, then subtract it using direct method, and
lastly sum it using analytical expression again, this could happen since in the correction
step we have used the sphere structure while the basic structure in Treecode method is
rectangle box. In our implementation, we try to avoid this by computing the whole leaf
using direct method with the assumption that the correct radius and the minimum tree
radius are at the same scale. By inserting Eq. (C.6) into Eq. (C.16), we obtain,
Vi,c = 
||k||=0
Dky (xi, yc) 
qjyj(yj  yc)k  nyj
||k||=0
ak(xi, yc)M
(C.18)
where
qj = U1(yj)Sj
Mkc = 
qjyj(yj  yc)k  nyj
(C.19)
96 Appendix C Treecode for Boundary Element Method
and ak(xi, yc) is same as in Eq. (C.8).
C.3 Numerical Tests
We have implemented Treecodemethod the algorithm described above: coefficients are
calculated using recursive relation and the correction will be taken according to sphere
radius. There are four parameters to be test in this Treecode-BEM algorithm: , p, N0
and Rc  the first three determine the performance and the last one decides both the
memory usage and accuracy.
102 103 104
Boundary Number
Rc =5
Rc =10
Rc =12
Figure C.2: The memory usage for Treecode-BEM comparing with FK method.
We will use a unit cube mesh for the testing. Figure C.2 shows the memory usages as a
function of the number of boundary vertices for Treecode and CG methods. As we can
see, thememory usage scaleswith N2 for FKmethodwhile only scaleswith N log(N)
for Treecode methods, and a larger Rc costs more memory.
The total demagnetization energy for the unit cube mesh with uniform magnetization
(1, 0, 0) is E0 = (1/6)0M2s . The relative error of the demagnetization energy for both
FK and Treecode methods are shown in Fig. C.3(a). It can be seen that both methods
converge. Very interestingly, Rc = 0 gives a better demagnetization energy. However,
this does not mean Rc = 0 is better than Rc = 0. In principle FKmethod is the limit case
of Rc   in Treecode method, so we stick to that FK is the standard and parameters
chosen in Treecode should lead to a bounded relative error with respect to FK results.
Appendix C Treecode for Boundary Element Method 97
1000 2500 4000
Boundary Number
0.000
0.002
0.004
0.006
0.008
0.010
0.012
Rc =0
Rc =5
Rc =10
1000 2500 4000
Boundary Number
fk rm
Rc =0
Rc =5
Rc =10
Figure C.3: (a) The relative error of the demagnetization energy for FK and
Treecode methods. (b) The relative error respect to FK method (fkrms) for a
unit cube mesh with uniform magnetization (0, 0, 1). The parameters used are
 = 0.3, p = 4, and N0 = 100.
The influence of Rc can be qualified by defining the relative error:
fkrms =

(Hid,j,tr  Hid,j,fk)2
(Hid,j,fk)
. (C.20)
Figure C.3(b) shows the relative error fkrms as a function of boundary number for
different Rc. As expected, a larger Rc gives a smaller fkrms. Therefore, for practical
applications we can choose Rc = 10. Another important concern is the running time.
Figure C.4 shows the comparison of running time for Treecode and FK methods. As
we can see, the Treecode method is slower than the FK method. We also implement a
simplified version which is slightly faster than the Treecode method described above.
C.4 Improvement
As shown in Fig. (C.4), the standard version is 2-3 times slower than the FK method.
The reasons probably are:
98 Appendix C Treecode for Boundary Element Method
0 1000 2000 3000 4000
Boundary Number
Treecode
Treecode-I
FigureC.4: Running time for FKmethod andTreecodemethodwith parameters
used are  = 0.3, p = 4, and N0 = 100.
1. The direct computation is expensive: we have defined a radius Rc within which a
sphere is constructed, all the points in the sphere are computed using analytical
equations, the points beyond the sphere but not far away enough (i.e. R < rc)
are computed using directly method.
2. The recursivemethod to compute the coefficients are not fast enough, for example,
memory clash might be serious in our three-dimensional array.
Therefore, the possible ways to improve the performance are
1. Replace the direct computation by analytical equations and the price is a bit more
memory, i.e.,  N log N. Because of this change, we are not going to correct
according to the sphere radius, sowe hope theminimum tree radius rc and correct
radius Rc satisfy
1  Rc. (C.21)
Furthermore, we still employ the directly calculation if the particle number in a
leaf is smaller than 10.
2. Using the directlymethod to compute the coefficients (needs to optimizemanually
such as find the common terms to reduce computation times) and using one
dimensional array to avoid memory clash. (Note that there are some discussions
about the traceless Maxwell-Cartesian tensor which might be useful [175], but we
neglect this at the moment)
Appendix C Treecode for Boundary Element Method 99
Figure (C.4) shows the running time for the simplifiedTreecodemethod  Treecode-I. As
we can see, Treecode-I is almost as fast as FKmethod. In this simplified implementation,
N0, the default maximum number of particles N0 that each leaf contains is set to 1, thus,
the tree radius is totally determined by Rc. Due to the coefficients are computed using
direct method, the two major variables in Treecode-I are  and Rc.
C.5 Summary
We have implemented the Treecode-BEMmethod to compute the demagnetizing field.
The memory usage of Treecode method scale with N log N where N is the number
of boundary vertices. A simplified version (Treecode-I) is implemented as well. The
simplified version is as fast as FK method.
Bibliography
[1] W. Wang, M. Dvornik, M.-a. Bisotti, D. Chernyshenko, M. Beg, M. Albert,
A. Vansteenkiste, B. V. Waeyenberge, A. N. Kuchko, V. V. Kruglyak, and H. Fan-
gohr, Physical Review B 92, 054430 (2015).
[2] W. Wang, M. Albert, M. Beg, M.-A. Bisotti, D. Chernyshenko, D. Corts-Ortuo,
I. Hawke, and H. Fangohr, Phys. Rev. Lett. 114, 087203 (2015).
[3] W. Wang, M. Beg, B. Zhang, W. Kuch, and H. Fangohr, Phys. Rev. B 92, 020403
(2015).
[4] J. B. Carlson, Science 189, 753 (1975).
[5] R. L. Stamps, S. Breitkreutz, J.  kerman, A. V. Chumak, Y. Otani, G. E. W. Bauer,
J.-U. Thiele, M. Bowen, S. a. Majetich, M. Klui, I. L. Prejbeanu, B. Dieny, N. M.
Dempsey, and B. Hillebrands, J. Phys. D. Appl. Phys. 47, 333001 (2014).
[6] J. Lenz and A. S. Edelstein, IEEE Sens. J. 6, 631 (2006).
[7] M. Niemier, Nat. Nanotechnol. 9, 14 (2014).
[8] T. Gilbert, IEEE Trans. Magn. 40, 3443 (2004).
[9] B. Skubic, J. Hellsvik, L. Nordstrm, and O. Eriksson, J. Phys. Condens. Matter
20, 315203 (2008).
[10] V. V. Kruglyak and A. N. Kuchko, Phys. B Condens. Matter 339, 130 (2003).
[11] V. V. Kruglyak, S. O. Demokritov, and D. Grundler, J. Phys. D. Appl. Phys. 43,
264001 (2010).
[12] S. Neusser and D. Grundler, Adv. Mater. 21, 2927 (2009).
[13] J. Podbielski, F. Giesen, and D. Grundler, Phys. Rev. Lett. 96, 167207 (2006).
[14] C. Regg, A. Furrer, D. Sheptyakov, T. Strssle, K. W. Krmer, H. U. Gdel, and
L. Mlsi, Phys. Rev. Lett. 93, 257201 (2004).
[15] S. O. Demokritov, V. E. Demidov, O. Dzyapko, G. A. Melkov, A. A. Serga,
B. Hillebrands, and A. N. Slavin, Nature 443, 430 (2006).
http://dx.doi.org/10.1103/PhysRevB.92.054430
http://dx.doi.org/10.1103/PhysRevLett.114.087203
http://dx.doi.org/10.1103/PhysRevB.92.020403
http://dx.doi.org/10.1103/PhysRevB.92.020403
http://dx.doi.org/10.1126/science.189.4205.753
http://dx.doi.org/10.1088/0022-3727/47/33/333001
http://dx.doi.org/10.1109/JSEN.2006.874493
http://dx.doi.org/10.1038/nnano.2013.296
http://dx.doi.org/10.1109/TMAG.2004.836740
http://dx.doi.org/10.1088/0953-8984/20/31/315203
http://dx.doi.org/10.1088/0953-8984/20/31/315203
http://dx.doi.org/10.1016/j.physb.2003.08.124
http://dx.doi.org/10.1088/0022-3727/43/26/264001
http://dx.doi.org/10.1088/0022-3727/43/26/264001
http://dx.doi.org/10.1002/adma.200900809
http://dx.doi.org/10.1103/PhysRevLett.96.167207
http://dx.doi.org/10.1103/PhysRevLett.93.257201
http://dx.doi.org/10.1038/nature05117
102 BIBLIOGRAPHY
[16] V. E. Demidov, O. Dzyapko, S. O. Demokritov, G. A. Melkov, and A. N. Slavin,
Phys. Rev. Lett. 100, 047205 (2008).
[17] I. S. Tupitsyn, P. C. E. Stamp, and A. L. Burin, Phys. Rev. Lett. 100, 257202 (2008).
[18] S.-K. Kim, J. Phys. D. Appl. Phys. 43, 264004 (2010).
[19] M. Kostylev, A. Stashkevich, and N. Sergeeva, Phys. Rev. B 69, 064408 (2004).
[20] J. Topp, J. Podbielski, D. Heitmann, and D. Grundler, Phys. Rev. B 78, 024431
(2008).
[21] M. Kostylev, P. Schrader, R. L. Stamps, G. Gubbiotti, G. Carlotti, A. O. Adeyeye,
S. Goolaup, and N. Singh, Appl. Phys. Lett. 92, 132504 (2008).
[22] K. S. Lee, D. S. Han, and S. K. Kim, Phys. Rev. Lett. 102, 127202 (2009).
[23] A. V. Chumak, V. I. Vasyuchka, A. A. Serga, M. P. Kostylev, V. S. Tiberkevich, and
B. Hillebrands, Phys. Rev. Lett. 108, 257207 (2012).
[24] M. Donahue and D. Porter, OOMMF Users Guide, Version 1.0, (1999),
http://math.nist.gov/oommf/.
[25] W. Scholz, J. Fidler, T. Schrefl, D. Suess, R. Dittrich, H. Forster, and V. Tsiantos,
Comput. Mater. Sci. 28, 366 (2003).
[26] T. Fischbacher, M. Franchin, G. Bordignon, and H. Fangohr, IEEE Trans. Magn.
43, 2896 (2007).
[27] R. Chang, M. a. Escobar, S. Li, M. V. Lubarda, and V. Lomakin, J. Appl. Phys. 111,
07D129 (2012).
[28] S. Zhang and Z. Li, Phys. Rev. Lett. 93, 127204 (2004).
[29] S. R. Boona, R. C. Myers, and J. P. Heremans, Energy Environ. Sci. 7, 885 (2014).
[30] D. Hinzke and U. Nowak, Phys. Rev. Lett. 107, 027205 (2011).
[31] J.-i. Ohe, H. Adachi, S. Takahashi, and S. Maekawa, Phys. Rev. B 83, 1 (2011).
[32] K. Everschor, M. Garst, B. Binz, F. Jonietz, S. Mhlbauer, C. Pfleiderer, and
A. Rosch, Phys. Rev. B 86, 054432 (2012).
[33] L. Kong and J. Zang, Phys. Rev. Lett. 111, 067203 (2013).
[34] W. Jiang, P. Upadhyaya, Y. Fan, J. Zhao, M. Wang, L. T. Chang, M. Lang, K. L.
Wong, M. Lewis, Y. T. Lin, J. Tang, S. Cherepov, X. Zhou, Y. Tserkovnyak, R. N.
Schwartz, and K. L. Wang, Phys. Rev. Lett. 110, 1 (2013).
[35] S. Borlenghi, W. Wang, H. Fangohr, L. Bergqvist, and A. Delin, Phys. Rev. Lett.
112, 047203 (2014).
http://dx.doi.org/10.1103/PhysRevLett.100.047205
http://dx.doi.org/10.1103/PhysRevLett.100.257202
http://dx.doi.org/10.1088/0022-3727/43/26/264004
http://dx.doi.org/10.1103/PhysRevB.69.064408
http://dx.doi.org/10.1103/PhysRevB.78.024431
http://dx.doi.org/10.1103/PhysRevB.78.024431
http://dx.doi.org/10.1063/1.2904697
http://dx.doi.org/10.1103/PhysRevLett.102.127202
http://dx.doi.org/10.1103/PhysRevLett.108.257207
http://math.nist.gov/oommf/
http://dx.doi.org/10.1016/S0927-0256(03)00119-8
http://dx.doi.org/10.1109/TMAG.2007.893843
http://dx.doi.org/10.1109/TMAG.2007.893843
http://dx.doi.org/10.1063/1.3679457
http://dx.doi.org/10.1063/1.3679457
http://dx.doi.org/10.1103/PhysRevLett.93.127204
http://dx.doi.org/10.1039/c3ee43299h
http://dx.doi.org/10.1103/PhysRevLett.107.027205
http://dx.doi.org/10.1103/PhysRevB.83.115118
http://dx.doi.org/10.1103/PhysRevB.86.054432
http://dx.doi.org/10.1103/PhysRevLett.111.067203
http://dx.doi.org/10.1103/PhysRevLett.110.177202
http://dx.doi.org/10.1103/PhysRevLett.112.047203
http://dx.doi.org/10.1103/PhysRevLett.112.047203
BIBLIOGRAPHY 103
[36] X.-G. Wang, G.-H. Guo, Y.-Z. Nie, G.-F. Zhang, and Z.-X. Li, Phys. Rev. B 86,
054445 (2012).
[37] V. Baryakhtar, B. Ivanov, A. Sukstanskii, and E. Melikhov, Physical Review B 56,
619 (1997).
[38] R. Urban, G. Woltersdorf, and B. Heinrich, Physical Review Letters 87, 217204
(2001).
[39] V. L. Safonov, Journal of Applied Physics 91, 8653 (2002).
[40] L. DeAngeli, D. Steiauf, R. Singer, I. Kberle, F. Dietermann, andM. Fhnle, Phys.
Rev. B 79, 052406 (2009).
[41] H. T. Nembach, J. M. Shaw, C. T. Boone, and T. J. Silva, Phys. Rev. Lett. 110, 117201
(2013).
[42] Y. Tserkovnyak, A. Brataas, and G. Bauer, Physical Review Letters 88, 117601
(2002).
[43] I. Dzyaloshinskii, J. Phys. Chem. Solids 4, 241 (1958).
[44] T. Moriya, Phys. Rev. 120, 91 (1960).
[45] A. Thiaville, S. Rohart, E. Ju, V. Cros, and A. Fert, Europhys. Lett. 100, 57002
(2012).
[46] O. A. Tretiakov and A. Abanov, Phys. Rev. Lett. 105, 157201 (2010).
[47] N. Nagaosa and Y. Tokura, Nat. Nanotechnol. 8, 899 (2013).
[48] S.-Z. Lin, C. Reichhardt, C. D. Batista, and A. Saxena, Phys. Rev. Lett. 110, 207202
(2013).
[49] J. Iwasaki, M. Mochizuki, and N. Nagaosa, Nat. Commun. 4, 1463 (2013).
[50] Y.-H. Liu, Y.-Q. Li, and J. H. Han, Phys. Rev. B 87, 100402 (2013).
[51] J. Iwasaki, A. J. Beekman, and N. Nagaosa, Phys. Rev. B 89, 064412 (2014).
[52] H. Kronmller, in Handbook of Magnetism and Advanced Magnetic Materials (John
Wiley & Sons, Ltd, 2007).
[53] D. Wei, in Micromagnetics and Recording Materials (Springer Berlin Heidelberg,
2012).
[54] S. Blundell, Magnetism in Condensed Matter, Oxford Master Series in Condensed
Matter Physics (OUP Oxford, 2001).
[55] R. F. L. Evans, W. J. Fan, P. Chureemart, T. A. Ostler, M. O. A. Ellis, and R. W.
Chantrell, J. Phys. Condens. Matter 26, 103202 (2014).
http://dx.doi.org/10.1103/PhysRevB.86.054445
http://dx.doi.org/10.1103/PhysRevB.86.054445
http://dx.doi.org/10.1103/PhysRevB.56.619
http://dx.doi.org/10.1103/PhysRevB.56.619
http://dx.doi.org/10.1103/PhysRevLett.87.217204
http://dx.doi.org/10.1103/PhysRevLett.87.217204
http://dx.doi.org/10.1063/1.1448794
http://dx.doi.org/10.1103/PhysRevB.79.052406
http://dx.doi.org/10.1103/PhysRevB.79.052406
http://dx.doi.org/10.1103/PhysRevLett.110.117201
http://dx.doi.org/10.1103/PhysRevLett.110.117201
http://dx.doi.org/10.1103/PhysRevLett.88.117601
http://dx.doi.org/10.1103/PhysRevLett.88.117601
http://journals.aps.org/pr/abstract/10.1103/PhysRev.120.91
http://dx.doi.org/10.1209/0295-5075/100/57002
http://dx.doi.org/10.1209/0295-5075/100/57002
http://dx.doi.org/10.1103/PhysRevLett.105.157201
http://dx.doi.org/10.1038/nnano.2013.243
http://dx.doi.org/10.1103/PhysRevLett.110.207202
http://dx.doi.org/10.1103/PhysRevLett.110.207202
http://dx.doi.org/10.1038/ncomms2442
http://dx.doi.org/10.1103/PhysRevB.87.100402
http://dx.doi.org/10.1103/PhysRevB.89.064412
http://dx.doi.org/10.1002/9780470022184.hmm201
http://dx.doi.org/10.1007/978-3-642-28577-6
http://dx.doi.org/10.1088/0953-8984/26/10/103202
104 BIBLIOGRAPHY
[56] U. Nowak, inHandbook of Magnetism and Advanced Magnetic Materials (JohnWiley
& Sons, Ltd, 2007).
[57] G. Tatara, H. Kohno, and J. Shibata, Phys. Rep. 468, 213 (2008).
[58] C. P. Slichter, Principles of Magnetic Resonance, Springer Series in Solid-State Sci-
ences (Springer, 1990).
[59] R. Wieser, Eur. Phys. J. B 88, 77 (2015).
[60] J. Sthr andH. C. Siegmann,Magnetism: From Fundamentals to Nanoscale Dynamics,
Springer Series in Solid-State Sciences (Springer Berlin Heidelberg, 2006).
[61] A. Fert, V. Cros, and J. Sampaio, Nat. Nanotechnol. 8, 152 (2013).
[62] S. Rohart and A. Thiaville, Phys. Rev. B 88, 184422 (2013).
[63] S. Mhlbauer, B. Binz, F. Jonietz, C. Pfleiderer, A. Rosch, A. Neubauer, R. Georgii,
and P. Bni, Science 323, 915 (2009).
[64] S. X. Huang and C. L. Chien, Phys. Rev. Lett. 108, 267201 (2012).
[65] J. L. Garca-Palacios and F. J. Lzaro, Phys. Rev. B 58, 14937 (1998).
[66] L. D. Landau and E. Lifshitz, Phys. Z. Sowjetunion 8, 101 (1935).
[67] L. Berger, Phys. Rev. B 54, 9353 (1996).
[68] J. Slonczewski, J. Magn. Magn. Mater. 159, L1 (1996).
[69] A. Thiaville, Y. Nakatani, J. Miltat, and Y. Suzuki, Europhys. Lett. 69, 990 (2005).
[70] D. Claudio-Gonzalez, A. Thiaville, and J. Miltat, Phys. Rev. Lett. 108, 227208
(2012).
[71] A. Logg and G. N. Wells, ACM Trans. Math. Softw. 37, 2 (2010).
[72] J. E. Miltat and M. J. Donahue, in Handbook of Magnetism and Advanced Magnetic
Materials (John Wiley & Sons, Ltd, 2007).
[73] A. J. Newell, W. Williams, and D. J. Dunlop, J. Geophys. Res. 98, 9551 (1993).
[74] T. Okubo, S. Chung, and H. Kawamura, Phys. Rev. Lett. 108, 017206 (2012).
[75] J. Struck, M. Weinberg, C. lschlger, P. Windpassinger, J. Simonet, K. Sengstock,
R. Hppner, P. Hauke, A. Eckardt, M. Lewenstein, and L. Mathey, Nat. Phys. 9,
738 (2013).
[76] M. dAquino, C. Serpico, G. Miano, and C. Forestiere, J. Comput. Phys. 228, 6130
(2009).
[77] S.-Z. Lin, C. D. Batista, and A. Saxena, Phys. Rev. B 89, 024415 (2014).
http://dx.doi.org/10.1002/9780470022184.hmm205
http://dx.doi.org/10.1016/j.physrep.2008.07.003
http://dx.doi.org/10.1140/epjb/e2015-50832-0
http://dx.doi.org/10.1007/978-3-540-30283-4
http://dx.doi.org/10.1038/nnano.2013.29
http://dx.doi.org/10.1103/PhysRevB.88.184422
http://dx.doi.org/10.1126/science.1166767
http://dx.doi.org/10.1103/PhysRevLett.108.267201
http://dx.doi.org/10.1103/PhysRevB.58.14937
http://dx.doi.org/10.1103/PhysRevB.54.9353
http://dx.doi.org/10.1016/0304-8853(96)00062-5
http://dx.doi.org/10.1209/epl/i2004-10452-6
http://dx.doi.org/10.1103/PhysRevLett.108.227208
http://dx.doi.org/10.1103/PhysRevLett.108.227208
http://dx.doi.org/10.1145/1731022.1731030
http://dx.doi.org/10.1002/9780470022184.hmm202
http://dx.doi.org/10.1002/9780470022184.hmm202
http://dx.doi.org/10.1029/93JB00694
http://dx.doi.org/10.1103/PhysRevLett.108.017206
http://dx.doi.org/10.1038/nphys2750
http://dx.doi.org/10.1038/nphys2750
http://dx.doi.org/http://dx.doi.org/10.1016/j.jcp.2009.05.026
http://dx.doi.org/http://dx.doi.org/10.1016/j.jcp.2009.05.026
http://dx.doi.org/10.1103/PhysRevB.89.024415
BIBLIOGRAPHY 105
[78] N. L. Schryer and L. R. Walker, J. Appl. Phys. 45, 5406 (1974).
[79] A. Goussev, J. Robbins, and V. Slastikov, Phys. Rev. Lett. 104, 147202 (2010).
[80] K. Y. Guslienko, IEEE Magn. Lett. 6, 4000104 (2015).
[81] C. Schtte and M. Garst, Phys. Rev. B 90, 094423 (2014).
[82] A. A. Belavin and A. M. Polyakov, JETP Lett. 22, 245 (1975).
[83] E. Martinez, L. Lopez-Diaz, L. Torres, C. Tristan, and O. Alejos, Phys. Rev. B 75,
174409 (2007).
[84] D. V. Berkov, in Handbook of Magnetism and Advanced Magnetic Materials (John
Wiley & Sons, Ltd, 2007).
[85] A. R. Soheili and M. Namjoo, World J. Model. Simulat. 4, 83 (2008).
[86] N. Kasdin, J. Guid. Control. Dyn. 18, 114 (1995).
[87] A. Tocino and R. Ardanuy, J. Comput. Appl. Math. 138, 219 (2002).
[88] F. Costabile and A. Napoli, Appl. Numer. Math. 61, 160 (2011).
[89] K. Burrage and P. Burrage, Appl. Numer. Math. 22, 81 (1996).
[90] R. Mannella, Int. J. Mod. Phys. C 13, 1177 (2002).
[91] M. dAquino, C. Serpico, G. Coppola, I. D. Mayergoyz, and G. Bertotti, J. Appl.
Phys. 99, 08B905 (2006).
[92] J. H. Mentink, M. V. Tretyakov, A. Fasolino, M. I. Katsnelson, and T. Rasing, J.
Phys. Condens. Matter 22, 176001 (2010).
[93] M. Khodabin, K. Maleknejad, M. Rostami, and M. Nouri, Math. Comput. Model.
53, 1910 (2011).
[94] W. Scholz, T. Schrefl, and J. Fidler, J. Magn. Magn. Mater. 233, 296 (2001).
[95] F. Rom, L. F. Cugliandolo, and G. S. Lozano, Phys. Rev. E 90, 023203 (2014).
[96] D. V. Berkov and N. L. Gorn, J. Phys. D. Appl. Phys. 41, 164013 (2008).
[97] A. Vansteenkiste, J. Leliaert, M. Dvornik, F. Garcia-Sanchez, and B. Van Waeyen-
berge, AIP Adv. 4, 107133 (2014).
[98] Y. Shu, M. Lin, and K. Wu, Mech. Mater. 36, 975 (2004).
[99] N. Vukadinovic, J. Ben Youssef, H. Le Gall, and J. Ostorero, Phys. Rev. B 62, 9021
(2000).
[100] S.-M. Seo, K.-J. Lee, H. Yang, and T. Ono, Phys. Rev. Lett. 102, 147202 (2009).
http://dx.doi.org/10.1063/1.1663252
http://dx.doi.org/10.1103/PhysRevLett.104.147202
http://dx.doi.org/10.1109/LMAG.2015.2413758
http://dx.doi.org/10.1103/PhysRevB.90.094423
http://dx.doi.org/10.1103/PhysRevB.75.174409
http://dx.doi.org/10.1103/PhysRevB.75.174409
http://dx.doi.org/ 10.1002/9780470022184.hmm204
http://profdoc.um.ac.ir/paper-abstract-1016053.html
http://dx.doi.org/10.2514/3.56665
http://dx.doi.org/10.1016/S0377-0427(01)00380-6
http://dx.doi.org/10.1016/j.apnum.2010.09.001
http://dx.doi.org/10.1016/S0168-9274(96)00027-X
http://dx.doi.org/10.1142/S0129183102004042
http://dx.doi.org/10.1063/1.2169472
http://dx.doi.org/10.1063/1.2169472
http://dx.doi.org/10.1088/0953-8984/22/17/176001
http://dx.doi.org/10.1088/0953-8984/22/17/176001
http://dx.doi.org/10.1016/j.mcm.2011.01.018
http://dx.doi.org/10.1016/j.mcm.2011.01.018
http://dx.doi.org/10.1016/S0304-8853(01)00032-4
http://dx.doi.org/10.1103/PhysRevE.90.023203
http://dx.doi.org/10.1088/0022-3727/41/16/164013
http://dx.doi.org/10.1063/1.4899186
http://dx.doi.org/10.1016/j.mechmat.2003.04.004
http://dx.doi.org/10.1103/PhysRevB.62.9021
http://dx.doi.org/10.1103/PhysRevB.62.9021
http://dx.doi.org/10.1103/PhysRevLett.102.147202
106 BIBLIOGRAPHY
[101] M. Mruczkiewicz, M. Krawczyk, R. V. Mikhaylovskiy, and V. V. Kruglyak,
Physical Review B 86, 024425 (2012).
[102] M. C. Hickey and J. S. Moodera, Phys. Rev. Lett. 102, 137601 (2009).
[103] E. M. Hankiewicz, G. Vignale, and Y. Tserkovnyak, Phys. Rev. B 78, 020404 (2008).
[104] M. Fhnle and S. Zhang, J. Magn. Magn. Mater. 326, 232 (2013).
[105] Y. Tserkovnyak, E. M. Hankiewicz, and G. Vignale, Phys. Rev. B 79, 094415 (2009).
[106] S. Zhang and S. S.-L. Zhang, Phys. Rev. Lett. 102, 086601 (2009).
[107] A. I. Akhiezer, V. G. Baryakhtar, and S. V. Peletminskii, Spin Waves (North-
Holland, Amsterdam, 1968).
[108] V. Baryakhtar, in Frontiers in Magnetism of Reduced Dimension Systems, NATO ASI
Series, Vol. 49, edited by V. Baryakthar, P. Wigen, and N. Lesnik (Springer
Netherlands, 1998) pp. 6394.
[109] V. G. Baryakhtar, B. A. Ivanov, T. K. Soboleva, and A. L. Sukstanskii, Zh. Eksp.
Teor. Fiz 64, 857 (1986).
[110] V. G. Baryakhtar and A. G. Danilevich, Low Temp. Phys. 39, 993 (2013).
[111] B. Hillebrands and A. Thiaville, Spin Dynamics in Confined Magnetic Structures III
(Springer, New York, 2006).
[112] T. Weindler, H. G. Bauer, R. Islinger, B. Boehm, J.-Y. Chauleau, and C. H. Back,
Phys. Rev. Lett. 113, 237204 (2014).
[113] M. Dvornik, A. Vansteenkiste, and B. Van Waeyenberge, Phys. Rev. B 88, 054427
(2013).
[114] U. Atxitia and O. Chubykalo-Fesenko, Phys. Rev. B 84, 144414 (2011).
[115] D.-S. Han, S.-K. Kim, J.-Y. Lee, S. J. Hermsdoerfer, H. Schultheiss, B. Leven, and
B. Hillebrands, Appl. Phys. Lett. 94, 112502 (2009).
[116] V. G. Baryakhtar, Low Temp. Phys. 40, 626 (2014).
[117] Y. Nakatani, A. Thiaville, and J. Miltat, J. Magn. Magn. Mater. 290, 750 (2005).
[118] L. OBrien, E. R. Lewis, A. Fernndez-Pacheco, D. Petit, R. P. Cowburn, J. Sampaio,
and D. Read, Phys. Rev. Lett. 108, 187202 (2012).
[119] V. L. Sobolev, S. C. Chen, and H. L. Huang, J. Magn. Magn. Mater. 172, 83 (1997).
[120] J. Shibata, G. Tatara, and H. Kohno, J. Phys. D. Appl. Phys. 44, 384004 (2011).
http://dx.doi.org/10.1103/PhysRevB.86.024425
http://dx.doi.org/10.1103/PhysRevLett.102.137601
http://dx.doi.org/10.1103/PhysRevB.78.020404
http://dx.doi.org/10.1016/j.jmmm.2012.09.024
http://dx.doi.org/10.1103/PhysRevB.79.094415
http://dx.doi.org/10.1103/PhysRevLett.102.086601
http://dx.doi.org/10.1007/978-94-011-5004-0_3
http://www.jetp.ac.ru/cgi-bin/dn/e_064_04_0857.pdf
http://www.jetp.ac.ru/cgi-bin/dn/e_064_04_0857.pdf
http://dx.doi.org/10.1063/1.4843275
http://dx.doi.org/10.1103/PhysRevLett.113.237204
http://dx.doi.org/10.1103/PhysRevB.88.054427
http://dx.doi.org/10.1103/PhysRevB.88.054427
http://dx.doi.org/10.1103/PhysRevB.84.144414
http://dx.doi.org/10.1063/1.3098409
http://dx.doi.org/10.1063/1.4890991
http://dx.doi.org/10.1016/j.jmmm.2004.11.355
http://dx.doi.org/10.1103/PhysRevLett.108.187202
http://dx.doi.org/10.1016/S0304-8853(97)00106-6
http://dx.doi.org/10.1088/0022-3727/44/38/384004
BIBLIOGRAPHY 107
[121] D. A. Allwood, G. Xiong, C. C. Faulkner, D. Atkinson, D. Petit, and R. P. Cowburn,
Science 309, 1688 (2005).
[122] R. Hertel, W. Wulfhekel, and J. Kirschner, Phys. Rev. Lett. 93, 257202 (2004).
[123] R. Wieser, U. Nowak, and K. Usadel, Phys. Rev. B 69, 064401 (2004).
[124] S. S. P. Parkin, M. Hayashi, and L. Thomas, Science 320, 190 (2008).
[125] B. Hu and X. R. Wang, Phys. Rev. Lett. 111, 027205 (2013).
[126] P. Yan and X. R. Wang, Phys. Rev. B 80, 214426 (2009).
[127] P. Yan and X. Wang, Phys. Rev. Lett. 107, 177207 (2011).
[128] X. S. Wang, P. Yan, Y. H. Shen, G. E. W. Bauer, and X. R. Wang, Phys. Rev. Lett.
109, 167209 (2012).
[129] J.-S. Kim, M. Strk, M. Klui, J. Yoon, C.-Y. You, L. Lopez-Diaz, and E. Martinez,
Phys. Rev. B 85, 174428 (2012).
[130] P. Yan, A. Kamra, Y. Cao, and G. E. W. Bauer, Phys. Rev. B 88, 144413 (2013).
[131] A. Janutka, IEEE Magn. Lett. 4, 4000104 (2013).
[132] J. Zang, M. Mostovoy, J. H. Han, and N. Nagaosa, Phys. Rev. Lett. 107, 136804
(2011).
[133] J.-H. Moon, S.-M. Seo, K.-J. Lee, K.-W. Kim, J. Ryu, H.-W. Lee, R. McMichael, and
M. Stiles, Phys. Rev. B 88, 184404 (2013).
[134] N. A. Porter, J. C. Gartside, and C. H. Marrows, Phys. Rev. B 90, 024403 (2014).
[135] H.-B. Braun, Phys. Rev. B 50, 16 485 (1994).
[136] J. Lekner, Am. J. Phys. 75, 1151 (2007).
[137] E. G. Tveten, A. Qaiumzadeh, and A. Brataas, Phys. Rev. Lett. 112, 147204 (2014).
[138] P. Yan and G. Bauer, Phys. Rev. Lett. 109, 087202 (2012).
[139] K. Zakeri, Y. Zhang, J. Prokop, T.-H. Chuang, N. Sakr,W. X. Tang, and J. Kirschner,
Phys. Rev. Lett. 104, 137203 (2010).
[140] A. Kosevich, B. Ivanov, and A. Kovalev, Phys. Rep. 194, 117 (1990).
[141] T. H. R. Skyrme, Nucl. Phys. 31, 556 (1962).
[142] X. Z. Yu, Y. Onose, N. Kanazawa, J. H. Park, J. H. Han, Y. Matsui, N. Nagaosa, and
Y. Tokura, Nature 465, 901 (2010).
http://dx.doi.org/10.1126/science.1108813
http://link.aps.org/doi/10.1103/PhysRevLett.93.257202
http://dx.doi.org/10.1103/PhysRevB.69.064401
http://dx.doi.org/10.1126/science.1145799
http://dx.doi.org/10.1103/PhysRevLett.111.027205
http://dx.doi.org/10.1103/PhysRevB.80.214426
http://dx.doi.org/10.1103/PhysRevLett.107.177207
http://dx.doi.org/10.1103/PhysRevLett.109.167209
http://dx.doi.org/10.1103/PhysRevLett.109.167209
http://dx.doi.org/10.1103/PhysRevB.85.174428
http://dx.doi.org/10.1103/PhysRevB.88.144413
http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=6519419
http://dx.doi.org/10.1103/PhysRevLett.107.136804
http://dx.doi.org/10.1103/PhysRevLett.107.136804
http://dx.doi.org/10.1103/PhysRevB.88.184404
http://dx.doi.org/10.1103/PhysRevB.90.024403
http://link.aps.org/doi/10.1103/PhysRevB.50.16485
http://dx.doi.org/10.1119/1.2787015
http://dx.doi.org/10.1103/PhysRevLett.112.147204
http://dx.doi.org/10.1103/PhysRevLett.109.087202
http://dx.doi.org/10.1103/PhysRevLett.104.137203
http://dx.doi.org/10.1016/0370-1573(90)90130-T
http://dx.doi.org/10.1016/0029-5582(62)90775-7
http://dx.doi.org/10.1038/nature09124
108 BIBLIOGRAPHY
[143] S. Heinze, K. von Bergmann, M. Menzel, J. Brede, A. Kubetzka, R. Wiesendanger,
G. Bihlmayer, and S. Blgel, Nat. Phys. 7, 713 (2011).
[144] N. Romming, C. Hanneken, M. Menzel, J. E. Bickel, B. Wolter, K. von Bergmann,
A. Kubetzka, and R. Wiesendanger, Science 341, 636 (2013).
[145] N. Romming, A. Kubetzka, C. Hanneken, K. von Bergmann, and R. Wiesendan-
ger, Phys. Rev. Lett. 114, 177203 (2015).
[146] U. K. Rssler, A. N. Bogdanov, and C. Pfleiderer, Nature 442, 797 (2006).
[147] J. Iwasaki, M. Mochizuki, and N. Nagaosa, Nat. Nanotechnol. 8, 742 (2013).
[148] S.-Z. Lin, C. D. Batista, C. Reichhardt, and A. Saxena, Phys. Rev. Lett. 112, 187203
(2014).
[149] M.Mochizuki, X. Z. Yu, S. Seki, N. Kanazawa, W. Koshibae, J. Zang, M.Mostovoy,
Y. Tokura, and N. Nagaosa, Nat. Mater. 13, 241 (2014).
[150] Y.-T. Oh, H. Lee, J.-H. Park, and J. H. Han, Phys. Rev. B 91, 104435 (2015).
[151] M. Mochizuki, Phys. Rev. Lett. 108, 017601 (2012).
[152] Y. Onose, Y. Okamura, S. Seki, S. Ishiwata, and Y. Tokura, Phys. Rev. Lett. 109,
037603 (2012).
[153] Y. Okamura, F. Kagawa, M. Mochizuki, M. Kubota, S. Seki, S. Ishiwata,
M. Kawasaki, Y. Onose, and Y. Tokura, Nat. Commun. 4, 2391 (2013).
[154] T. Schwarze, J. Waizner, M. Garst, A. Bauer, I. Stasinopoulos, H. Berger, C. Pflei-
derer, and D. Grundler, Nat. Mater. 14, 478 (2015).
[155] A. Neubauer, C. Pfleiderer, B. Binz, A. Rosch, R. Ritz, P. G. Niklowitz, and P. Bni,
Phys. Rev. Lett. 102, 186602 (2009).
[156] Y. Zhou and M. Ezawa, Nat. Commun. 5, 4652 (2014).
[157] S. D. Yi, S. Onoda, N. Nagaosa, and J. H. Han, Phys. Rev. B 80, 054416 (2009).
[158] B. Zhang, W. Wang, M. Beg, H. Fangohr, and W. Kuch, Appl. Phys. Lett. 106,
102401 (2015).
[159] R. P. Cowburn, D. K. Koltsov, A. O. Adeyeye, M. E. Welland, and D. M. Tricker,
Phys. Rev. Lett. 83, 1042 (1999).
[160] R. Liu, J. Wang, Q. Liu, H. Wang, and C. Jiang, J. Appl. Phys. 103, 013910 (2008).
[161] J.-V. Kim, F. Garcia-Sanchez, J. Sampaio, C.Moreau-Luchaire, V. Cros, andA. Fert,
Phys. Rev. B 90, 064410 (2014).
[162] N. Papanicolaou and T. Tomaras, Nucl. Phys. B 360, 425 (1991).
http://dx.doi.org/10.1038/nphys2045
http://dx.doi.org/10.1126/science.1240573
http://dx.doi.org/10.1103/PhysRevLett.114.177203
http://dx.doi.org/10.1038/nature05056
http://dx.doi.org/10.1038/nnano.2013.176
http://dx.doi.org/10.1103/PhysRevLett.112.187203
http://dx.doi.org/10.1103/PhysRevLett.112.187203
http://dx.doi.org/10.1038/NMAT3862
http://dx.doi.org/10.1103/PhysRevB.91.104435
http://dx.doi.org/10.1103/PhysRevLett.108.017601
http://dx.doi.org/10.1103/PhysRevLett.109.037603
http://dx.doi.org/10.1103/PhysRevLett.109.037603
http://dx.doi.org/10.1038/ncomms3391
http://dx.doi.org/10.1038/NMAT4223
http://dx.doi.org/10.1103/PhysRevLett.102.186602
http://dx.doi.org/10.1038/ncomms5652
http://dx.doi.org/10.1103/PhysRevB.80.054416
http://dx.doi.org/10.1063/1.4914496
http://dx.doi.org/10.1063/1.4914496
http://dx.doi.org/10.1103/PhysRevLett.83.1042
http://dx.doi.org/10.1063/1.2829817
http://dx.doi.org/10.1103/PhysRevB.90.064410
http://dx.doi.org/10.1016/0550-3213(91)90410-Y
BIBLIOGRAPHY 109
[163] A. A. Kovalev, Phys. Rev. B 89, 241101 (2014).
[164] A. A. Thiele, Phys. Rev. Lett. 30, 230 (1973).
[165] P. Reimann, Phys. Rep. 361, 57 (2002).
[166] P. Hnggi and F. Marchesoni, Rev. Mod. Phys. 81, 387 (2009).
[167] N. R. Quintero, J. A. Cuesta, and R. Alvarez-Nodarse, Phys. Rev. E 81, 030102
(2010).
[168] E. Beaurepaire, J.-C. Merle, A. Daunois, and J.-Y. Bigot, Phys. Rev. Lett. 76, 4250
(1996).
[169] C. Jarzynski, Phys. Rev. Lett. 78, 2690 (1997).
[170] G. E. Crooks, Phys. Rev. E 60, 2721 (1999).
[171] M. Rognes, R. Kirby, and A. Logg, SIAM J. Sci. Comput. 31, 4130 (2009).
[172] M. F. Wheeler and I. Yotov, SIAM J. Numer. Anal. 44, 2082 (2006).
[173] J. Barnes and P. Hut, Nature 324, 446 (1986).
[174] P. Li, H. Johnston, and R. Krasny, J. Comput. Phys. 228, 3858 (2009).
[175] B. Shanker and H. Huang, J. Comput. Phys. 226, 732 (2007).
http://dx.doi.org/10.1103/PhysRevB.89.241101
http://scholar.google.com/scholar?hl=en&btnG=Search&q=intitle:No+Title#0 http://journals.aps.org/prl/abstract/10.1103/PhysRevLett.30.230
http://dx.doi.org/10.1016/S0370-1573(01)00081-3
http://dx.doi.org/10.1103/RevModPhys.81.387
http://dx.doi.org/10.1103/PhysRevE.81.030102
http://dx.doi.org/10.1103/PhysRevE.81.030102
http://dx.doi.org/10.1103/PhysRevLett.76.4250
http://dx.doi.org/10.1103/PhysRevLett.76.4250
http://dx.doi.org/10.1103/PhysRevLett.78.2690
http://dx.doi.org/10.1103/PhysRevE.60.2721
http://epubs.siam.org/doi/abs/10.1137/08073901X
http://dx.doi.org/10.1137/050638473
http://dx.doi.org/10.1038/324446a0
http://dx.doi.org/10.1016/j.jcp.2009.02.022
http://dx.doi.org/10.1016/j.jcp.2007.04.033
